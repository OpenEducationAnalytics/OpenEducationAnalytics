{
	"$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
	"contentVersion": "1.0.0.0",
	"parameters": {
		"workspaceName": {
			"type": "string",
			"metadata": "Workspace name",
			"defaultValue": "syn-oea-cisdag1"
		},
		"LS_Azure_SQL_DB_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'LS_Azure_SQL_DB'"
		},
		"LS_SQL_Serverless_OEA_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'LS_SQL_Serverless_OEA'"
		},
		"LS_datalake_accountKey": {
			"type": "secureString",
			"metadata": "Secure string for 'accountKey' of 'LS_datalake'"
		},
		"syn-oea-cisdag1-WorkspaceDefaultSqlServer_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'syn-oea-cisdag1-WorkspaceDefaultSqlServer'"
		},
		"LS_ADLS_OEA_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "https://stoeacisdag2.dfs.core.windows.net"
		},
		"LS_HTTP_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "@{linkedService().baseURL}"
		},
		"LS_KeyVault_OEA_properties_typeProperties_baseUrl": {
			"type": "string",
			"defaultValue": "https://kv-oea-cisdag1.vault.azure.net/"
		},
		"LS_REST_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "@{linkedService().BaseURL}"
		},
		"LS_REST_properties_typeProperties_userName": {
			"type": "string",
			"defaultValue": "@{linkedService().ClientId}"
		},
		"LS_datalake_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "https://stoeacisdedfi1.dfs.core.windows.net/"
		},
		"syn-oea-cisdag1-WorkspaceDefaultStorage_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "https://stoeacisdag1.dfs.core.windows.net"
		}
	},
	"variables": {
		"workspaceId": "[concat('Microsoft.Synapse/workspaces/', parameters('workspaceName'))]"
	},
	"resources": [
		{
			"name": "[concat(parameters('workspaceName'), '/Copy Data from REST API to ADLS')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "Get Total count of Records",
						"type": "WebActivity",
						"dependsOn": [
							{
								"activity": "Set-AccessToken",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"url": {
								"value": "@pipeline().parameters.TotalCountURL",
								"type": "Expression"
							},
							"connectVia": {
								"referenceName": "AutoResolveIntegrationRuntime",
								"type": "IntegrationRuntimeReference"
							},
							"method": "GET",
							"headers": {
								"Authorization": {
									"value": "@variables('AccessToken')",
									"type": "Expression"
								},
								"Accept": "application/json"
							}
						}
					},
					{
						"name": "Store Total Count",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Get Total count of Records",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "TotalCount",
							"value": {
								"value": "@activity('Get Total count of Records').output.ADFWebActivityResponseHeaders['Total-Count']",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Copy Page to ADLS",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Store Total Count",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:01:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET",
								"additionalHeaders": {
									"Authorization": {
										"value": "@variables('AccessToken')",
										"type": "Expression"
									}
								},
								"paginationRules": {
									"QueryParameters.start": {
										"value": "Range:0:@{variables('TotalCount')}:500",
										"type": "Expression"
									}
								}
							},
							"sink": {
								"type": "JsonSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "JsonWriteSettings",
									"filePattern": "setOfObjects"
								}
							},
							"enableStaging": false
						},
						"inputs": [
							{
								"referenceName": "DS_REST",
								"type": "DatasetReference",
								"parameters": {
									"RelativeURL": {
										"value": "@{pipeline().parameters.RelativeURL}&limit=@{pipeline().parameters.Limit}&offset=start",
										"type": "Expression"
									},
									"ClientId": {
										"value": "@pipeline().parameters.ClientId",
										"type": "Expression"
									},
									"SecretName": {
										"value": "@pipeline().parameters.SecretName",
										"type": "Expression"
									},
									"BaseURL": {
										"value": "@pipeline().parameters.BaseURL",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_JSON",
								"type": "DatasetReference",
								"parameters": {
									"stage": "1",
									"path": {
										"value": "@pipeline().parameters.SinkPath",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Get-AccessToken",
						"type": "WebActivity",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"url": {
								"value": "@pipeline().parameters.AuthURL",
								"type": "Expression"
							},
							"connectVia": {
								"referenceName": "AutoResolveIntegrationRuntime",
								"type": "IntegrationRuntimeReference"
							},
							"method": "POST",
							"headers": {},
							"body": {
								"grant_type": "client_credentials"
							},
							"authentication": {
								"type": "Basic",
								"username": {
									"value": "@pipeline().parameters.ClientID",
									"type": "Expression"
								},
								"password": {
									"type": "AzureKeyVaultSecret",
									"store": {
										"referenceName": "LS_KeyVault_OEA",
										"type": "LinkedServiceReference"
									},
									"secretName": {
										"value": "@pipeline().parameters.SecretName",
										"type": "Expression"
									}
								}
							}
						}
					},
					{
						"name": "Set-AccessToken",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Get-AccessToken",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "AccessToken",
							"value": {
								"value": "Bearer @{activity('Get-AccessToken').output.access_token}",
								"type": "Expression"
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"Limit": {
						"type": "int",
						"defaultValue": 500
					},
					"BaseURL": {
						"type": "string",
						"defaultValue": "https://api.edgraph.dev"
					},
					"TotalCountURL": {
						"type": "String"
					},
					"RelativeURL": {
						"type": "String"
					},
					"ClientId": {
						"type": "String"
					},
					"SecretName": {
						"type": "String"
					},
					"SinkPath": {
						"type": "String"
					},
					"AuthURL": {
						"type": "String"
					}
				},
				"variables": {
					"TotalCount": {
						"type": "String"
					},
					"PageArray": {
						"type": "Array"
					},
					"test": {
						"type": "String"
					},
					"AccessToken": {
						"type": "String"
					}
				},
				"folder": {
					"name": "OEA_Framework/Extracts"
				},
				"annotations": []
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]",
				"[concat(variables('workspaceId'), '/datasets/DS_REST')]",
				"[concat(variables('workspaceId'), '/datasets/DS_JSON')]",
				"[concat(variables('workspaceId'), '/linkedServices/LS_KeyVault_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Copy_all_from_Azure_SQL_DB')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "Get list of tables",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "select schema_name(t.schema_id) as schema_name, t.name as table_name\nfrom sys.tables t",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "DS_Azure_SQL_DB",
								"type": "DatasetReference",
								"parameters": {
									"dbServer": {
										"value": "@pipeline().parameters.dbServer",
										"type": "Expression"
									},
									"dbName": {
										"value": "@pipeline().parameters.dbName",
										"type": "Expression"
									},
									"userName": {
										"value": "@pipeline().parameters.userName",
										"type": "Expression"
									},
									"keyVaultSecretName": {
										"value": "@pipeline().parameters.keyVaultSecretName",
										"type": "Expression"
									}
								}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "Set currentDateTime",
						"type": "SetVariable",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"variableName": "currentDateTime",
							"value": {
								"value": "@{formatDateTime(convertTimeZone(utcnow(), 'UTC', pipeline().parameters.timezone), 'yyyy-MM-ddTHHmm_ss')}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "ForEach1",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Get list of tables",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "Set currentDateTime",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Get list of tables').output.value",
								"type": "Expression"
							},
							"isSequential": false,
							"activities": [
								{
									"name": "Copy_from_Azure_SQL_DB",
									"type": "ExecutePipeline",
									"dependsOn": [],
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "Copy_from_Azure_SQL_DB",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"dbServer": {
												"value": "@pipeline().parameters.dbServer",
												"type": "Expression"
											},
											"dbName": {
												"value": "@pipeline().parameters.dbName",
												"type": "Expression"
											},
											"userName": {
												"value": "@pipeline().parameters.userName",
												"type": "Expression"
											},
											"keyVaultSecretName": {
												"value": "@pipeline().parameters.keyVaultSecretName",
												"type": "Expression"
											},
											"query": {
												"value": "select * from @{item().schema_name}.@{item().table_name}",
												"type": "Expression"
											},
											"sinkFilesystem": {
												"value": "@pipeline().parameters.sinkFilesystem",
												"type": "Expression"
											},
											"sinkDirectory": {
												"value": "@{pipeline().parameters.sinkDirectory}/@{variables('currentDateTime')}/@{item().table_name}",
												"type": "Expression"
											}
										}
									}
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"dbServer": {
						"type": "string",
						"defaultValue": "contosoisd3a.database.windows.net"
					},
					"dbName": {
						"type": "string",
						"defaultValue": "contoso_sis"
					},
					"userName": {
						"type": "string",
						"defaultValue": "sqladmin"
					},
					"keyVaultSecretName": {
						"type": "string",
						"defaultValue": "sqladmin-password"
					},
					"sinkFilesystem": {
						"type": "string",
						"defaultValue": "stage1np"
					},
					"sinkDirectory": {
						"type": "string",
						"defaultValue": "contoso_sis_db"
					},
					"timezone": {
						"type": "string",
						"defaultValue": "Eastern Standard Time"
					}
				},
				"variables": {
					"currentDateTime": {
						"type": "String"
					}
				},
				"folder": {
					"name": "OEA_Framework/Extracts"
				},
				"annotations": [],
				"lastPublishTime": "2021-10-29T22:15:07Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/datasets/DS_Azure_SQL_DB')]",
				"[concat(variables('workspaceId'), '/pipelines/Copy_from_Azure_SQL_DB')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Copy_from_Azure_SQL_DB')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "Copy from Azure SQL DB",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "@pipeline().parameters.query",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "ParquetSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "ParquetWriteSettings"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DS_Azure_SQL_DB",
								"type": "DatasetReference",
								"parameters": {
									"dbServer": {
										"value": "@pipeline().parameters.dbServer",
										"type": "Expression"
									},
									"dbName": {
										"value": "@pipeline().parameters.dbName",
										"type": "Expression"
									},
									"userName": {
										"value": "@pipeline().parameters.userName",
										"type": "Expression"
									},
									"keyVaultSecretName": {
										"value": "@pipeline().parameters.keyVaultSecretName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_ADLS_parquet",
								"type": "DatasetReference",
								"parameters": {
									"filesystem": {
										"value": "@pipeline().parameters.sinkFilesystem",
										"type": "Expression"
									},
									"directory": {
										"value": "@pipeline().parameters.sinkDirectory",
										"type": "Expression"
									}
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"dbServer": {
						"type": "string",
						"defaultValue": "contosoisd3a.database.windows.net"
					},
					"dbName": {
						"type": "string",
						"defaultValue": "contoso_sis"
					},
					"userName": {
						"type": "string",
						"defaultValue": "sqladmin"
					},
					"keyVaultSecretName": {
						"type": "string",
						"defaultValue": "sqladmin-password"
					},
					"query": {
						"type": "string",
						"defaultValue": "select * from person"
					},
					"sinkFilesystem": {
						"type": "string",
						"defaultValue": "stage1np"
					},
					"sinkDirectory": {
						"type": "string",
						"defaultValue": "contoso_sis_db/person"
					}
				},
				"folder": {
					"name": "OEA_Framework/Extracts"
				},
				"annotations": [],
				"lastPublishTime": "2021-10-29T22:15:03Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/datasets/DS_Azure_SQL_DB')]",
				"[concat(variables('workspaceId'), '/datasets/DS_ADLS_parquet')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Copy_from_URL')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"description": "Copies data from the specified URL and lands it in the specified location in the data lake.",
				"activities": [
					{
						"name": "copy from URL",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "URL",
								"value": "@pipeline().parameters.URL"
							},
							{
								"name": "sinkFilesystem",
								"value": "@pipeline().parameters.sinkFilesystem"
							},
							{
								"name": "sinkFilename",
								"value": "@pipeline().parameters.sinkFilename"
							}
						],
						"typeProperties": {
							"source": {
								"type": "BinarySource",
								"storeSettings": {
									"type": "HttpReadSettings",
									"requestMethod": "GET"
								},
								"formatSettings": {
									"type": "BinaryReadSettings"
								}
							},
							"sink": {
								"type": "BinarySink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								}
							},
							"enableStaging": false
						},
						"inputs": [
							{
								"referenceName": "DS_HTTP_binary",
								"type": "DatasetReference",
								"parameters": {
									"URL": {
										"value": "@pipeline().parameters.URL",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_ADLS_binary_file",
								"type": "DatasetReference",
								"parameters": {
									"filesystem": {
										"value": "@pipeline().parameters.sinkFilesystem",
										"type": "Expression"
									},
									"filename": {
										"value": "@pipeline().parameters.sinkFilename",
										"type": "Expression"
									}
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"URL": {
						"type": "string",
						"defaultValue": "https://raw.githubusercontent.com/microsoft/OpenEduAnalytics/main/modules/Contoso_SIS/test_data/studentattendance.csv"
					},
					"sinkFilesystem": {
						"type": "string",
						"defaultValue": "stage1np"
					},
					"sinkFilename": {
						"type": "string",
						"defaultValue": "contoso_sis/example1/studentattendance.csv"
					}
				},
				"folder": {
					"name": "OEA_Framework/Extracts"
				},
				"annotations": [],
				"lastPublishTime": "2022-01-03T19:18:12Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/datasets/DS_HTTP_binary')]",
				"[concat(variables('workspaceId'), '/datasets/DS_ADLS_binary_file')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Copy_from_each_URL')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"description": "Retrieves data from multiple HTTP endpoints as specified in the 'endpoints' parameter.\nThe data is landed in the data lake within a folder named with the current datetime (in the timezone specified).\n\nFor a list of timezones, see: https://docs.microsoft.com/en-us/azure/data-factory/control-flow-expression-language-functions#convertfromutc",
				"activities": [
					{
						"name": "get data for each endpoint",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Set currentDateTime",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@pipeline().parameters.endpoints",
								"type": "Expression"
							},
							"isSequential": false,
							"batchCount": 3,
							"activities": [
								{
									"name": "Copy_from_URL",
									"type": "ExecutePipeline",
									"dependsOn": [],
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "Copy_from_URL",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"URL": {
												"value": "@item().URL",
												"type": "Expression"
											},
											"sinkFilesystem": {
												"value": "@pipeline().parameters.sinkFilesystem",
												"type": "Expression"
											},
											"sinkFilename": {
												"value": "@{item().sinkDirectory}/@{variables('currentDateTime')}/@{item().sinkFilename}",
												"type": "Expression"
											}
										}
									}
								}
							]
						}
					},
					{
						"name": "Set currentDateTime",
						"type": "SetVariable",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"variableName": "currentDateTime",
							"value": {
								"value": "@{formatDateTime(convertTimeZone(utcnow(), 'UTC', pipeline().parameters.timezone), 'yyyy-MM-ddTHHmm_ss')}",
								"type": "Expression"
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"endpoints": {
						"type": "array",
						"defaultValue": [
							{
								"URL": "https://raw.githubusercontent.com/microsoft/OpenEduAnalytics/main/modules/Contoso_SIS/test_data/studentattendance.csv",
								"sinkDirectory": "contoso_sis",
								"sinkFilename": "studentattendance/studentattendance.csv"
							},
							{
								"URL": "https://raw.githubusercontent.com/microsoft/OpenEduAnalytics/main/modules/Contoso_SIS/test_data/studentdemographics.csv",
								"sinkDirectory": "contoso_sis",
								"sinkFilename": "studentdemographics/studentdemographics.csv"
							},
							{
								"URL": "https://raw.githubusercontent.com/microsoft/OpenEduAnalytics/main/modules/Contoso_SIS/test_data/studentsectionmark.csv",
								"sinkDirectory": "contoso_sis",
								"sinkFilename": "studentsectionmark/studentsectionmark.csv"
							}
						]
					},
					"sinkFilesystem": {
						"type": "string",
						"defaultValue": "stage1np"
					},
					"timezone": {
						"type": "string",
						"defaultValue": "Eastern Standard Time"
					}
				},
				"variables": {
					"currentDateTime": {
						"type": "String"
					}
				},
				"folder": {
					"name": "OEA_Framework/Extracts"
				},
				"annotations": [],
				"lastPublishTime": "2021-10-28T13:57:35Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/pipelines/Copy_from_URL')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Incremental_query_ingest_to_Stage1np')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"description": "Ingest new or updated rows only from database using external watermark table\n\nParameters Description:\nData_Source_Table_Name : Table Name\nData_Source_WaterMarkColumn : Column of the table used to determine watermark (For Ex. : LastModifiedDate)\nData_Destination_Directory : Directory of the storage account where stage1np is stored.\n",
				"activities": [
					{
						"name": "LookupCurrentWaterMark",
						"description": "Retrieve the current maximum value in watermark column of source data store",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "@concat('select MAX(',pipeline().parameters.Data_Source_WaterMarkColumn, ') as NewWatermarkValue from ',pipeline().parameters.Data_Source_Table_Name)",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "DS_Azure_SQL_DB",
								"type": "DatasetReference",
								"parameters": {
									"dbServer": {
										"value": "@pipeline().parameters.DbServer",
										"type": "Expression"
									},
									"dbName": {
										"value": "@pipeline().parameters.DbName",
										"type": "Expression"
									},
									"userName": {
										"value": "@pipeline().parameters.Username",
										"type": "Expression"
									},
									"keyVaultSecretName": {
										"value": "@pipeline().parameters.KeyVaultSecretValue",
										"type": "Expression"
									}
								}
							}
						}
					},
					{
						"name": "DeltaCopyfromDB",
						"description": "Copy activity to use query to filter the delta data by > last high-watermark and <= current high-watermark from source database, and then only copy the changes to the destination store.",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "LookupCurrentWaterMark",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "GetLastWatermark",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "select * from @{pipeline().parameters.Data_Source_Table_Name} where @{pipeline().parameters.Data_Source_WaterMarkColumn} > '@{activity('GetLastWatermark').output.status.Output.result.exitValue}' and @{pipeline().parameters.Data_Source_WaterMarkColumn} <= '@{activity('LookupCurrentWaterMark').output.firstRow.NewWatermarkValue}'",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "ParquetSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "ParquetWriteSettings"
								}
							},
							"enableStaging": false,
							"dataIntegrationUnits": 0
						},
						"inputs": [
							{
								"referenceName": "DS_Azure_SQL_DB",
								"type": "DatasetReference",
								"parameters": {
									"dbServer": {
										"value": "@pipeline().parameters.DbServer",
										"type": "Expression"
									},
									"dbName": {
										"value": "@pipeline().parameters.DbName",
										"type": "Expression"
									},
									"userName": {
										"value": "@pipeline().parameters.Username",
										"type": "Expression"
									},
									"keyVaultSecretName": {
										"value": "@pipeline().parameters.KeyVaultSecretValue",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_ADLS_parquet",
								"type": "DatasetReference",
								"parameters": {
									"filesystem": "stage1np",
									"directory": {
										"value": "@pipeline().parameters.Data_Destination_Directory",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "GetLastWatermark",
						"description": "Gets the last watermark value available in the external control table.",
						"type": "SynapseNotebook",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"notebook": {
								"referenceName": "OEA_connector",
								"type": "NotebookReference"
							},
							"parameters": {
								"object_name": {
									"value": "oea",
									"type": "string"
								},
								"method_name": {
									"value": "get_last_watermark",
									"type": "string"
								},
								"kwargs": {
									"value": {
										"value": "{'source':\"@{pipeline().parameters.Data_Source}\",'entity':\"@{pipeline().parameters.Entity}\"}",
										"type": "Expression"
									},
									"type": "string"
								}
							},
							"snapshot": true,
							"conf": {
								"spark.dynamicAllocation.enabled": null,
								"spark.dynamicAllocation.minExecutors": null,
								"spark.dynamicAllocation.maxExecutors": null
							},
							"numExecutors": null
						}
					},
					{
						"name": "UpdateLastWatermark",
						"description": "Updates the latest watermark value to the external control table.",
						"type": "SynapseNotebook",
						"dependsOn": [
							{
								"activity": "DeltaCopyfromDB",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"notebook": {
								"referenceName": "OEA_connector",
								"type": "NotebookReference"
							},
							"parameters": {
								"object_name": {
									"value": "oea",
									"type": "string"
								},
								"method_name": {
									"value": "insert_watermark",
									"type": "string"
								},
								"kwargs": {
									"value": {
										"value": "{'source':\"@{pipeline().parameters.Data_Source}\",'entity':\"@{pipeline().parameters.Entity}\",'watermark_datetime':\"@{activity('LookupCurrentWaterMark').output.firstRow.NewWatermarkValue}\"}",
										"type": "Expression"
									},
									"type": "string"
								}
							},
							"snapshot": true,
							"conf": {
								"spark.dynamicAllocation.enabled": null,
								"spark.dynamicAllocation.minExecutors": null,
								"spark.dynamicAllocation.maxExecutors": null
							},
							"numExecutors": null
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"Data_Source_Table_Name": {
						"type": "String",
						"defaultValue": "edfi.Student"
					},
					"Data_Source_WaterMarkColumn": {
						"type": "String",
						"defaultValue": "LastModifiedDate"
					},
					"Data_Destination_Container": {
						"type": "String",
						"defaultValue": "stage1np"
					},
					"Data_Destination_Directory": {
						"type": "String",
						"defaultValue": "contoso_sis_db/person"
					},
					"Data_Source": {
						"type": "string",
						"defaultValue": "edfi"
					},
					"Entity": {
						"type": "string",
						"defaultValue": "Student"
					},
					"DbName": {
						"type": "string",
						"defaultValue": "contoso_sis"
					},
					"DbServer": {
						"type": "string",
						"defaultValue": "contosoisd3a.database.windows.net"
					},
					"Username": {
						"type": "string",
						"defaultValue": "sqladmin"
					},
					"KeyVaultSecretValue": {
						"type": "string",
						"defaultValue": "sqladmin-password"
					}
				},
				"annotations": [],
				"lastPublishTime": "2021-11-29T13:02:15Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/datasets/DS_Azure_SQL_DB')]",
				"[concat(variables('workspaceId'), '/datasets/DS_ADLS_parquet')]",
				"[concat(variables('workspaceId'), '/notebooks/OEA_connector')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Setup Database from New Stages')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "Iterate over folders",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Get Tables",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "Create Required Schemas",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Get Tables').output.childItems",
								"type": "Expression"
							},
							"isSequential": false,
							"activities": [
								{
									"name": "Create View for Entity",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[dbo].[sp_executesql]",
										"storedProcedureParameters": {
											"command": {
												"value": {
													"value": "CREATE OR ALTER VIEW edfi.@{item().name} AS\nSELECT * FROM OPENROWSET(\n    BULK 'https://@{pipeline().parameters.StorageAccount}.dfs.core.windows.net/stage@{pipeline().parameters.StageNum}/@{pipeline().parameters.FileSystem}/@{item().name}',\n    FORMAT='DELTA'\n    ) AS [r]",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "LS_SQL_Serverless_OEA",
										"type": "LinkedServiceReference",
										"parameters": {
											"dbName": {
												"value": "@pipeline().parameters.DbName",
												"type": "Expression"
											}
										}
									}
								}
							]
						}
					},
					{
						"name": "Create Serverless Db",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[dbo].[sp_executesql]",
							"storedProcedureParameters": {
								"command": {
									"value": {
										"value": "IF NOT EXISTS (SELECT * FROM sys.databases WHERE name = '@{pipeline().parameters.DbName}') \nBEGIN\n  CREATE DATABASE [@{pipeline().parameters.DbName}]; \nEND\n\n",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_Serverless_OEA",
							"type": "LinkedServiceReference",
							"parameters": {
								"dbName": {
									"value": "master",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Get Tables",
						"type": "GetMetadata",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "DS_JSON",
								"type": "DatasetReference",
								"parameters": {
									"stage": {
										"value": "@pipeline().parameters.StageNum",
										"type": "Expression"
									},
									"path": {
										"value": "@pipeline().parameters.FileSystem",
										"type": "Expression"
									}
								}
							},
							"fieldList": [
								"childItems"
							],
							"storeSettings": {
								"type": "AzureBlobFSReadSettings",
								"recursive": true,
								"enablePartitionDiscovery": false
							},
							"formatSettings": {
								"type": "JsonReadSettings"
							}
						}
					},
					{
						"name": "Create Required Schemas",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Create Serverless Db",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@pipeline().parameters.Schemas",
								"type": "Expression"
							},
							"isSequential": true,
							"activities": [
								{
									"name": "Create Schema object",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[dbo].[sp_executesql]",
										"storedProcedureParameters": {
											"command": {
												"value": {
													"value": "IF NOT EXISTS ( SELECT  * FROM    sys.schemas WHERE   name = N'@{item()}' )\nBEGIN\n    EXECUTE sp_executesql N'CREATE SCHEMA @{item()}'\nEND",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "LS_SQL_Serverless_OEA",
										"type": "LinkedServiceReference",
										"parameters": {
											"dbName": {
												"value": "@pipeline().parameters.DbName",
												"type": "Expression"
											}
										}
									}
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"StorageAccount": {
						"type": "string",
						"defaultValue": "stoeacisdedfi1"
					},
					"BaseURL": {
						"type": "string",
						"defaultValue": "https://api.edgraph.dev"
					},
					"DbName": {
						"type": "string"
					},
					"FileSystem": {
						"type": "string"
					},
					"Schemas": {
						"type": "array"
					},
					"StageNum": {
						"type": "string"
					}
				},
				"variables": {
					"DescriptorList": {
						"type": "Array"
					},
					"AccessToken": {
						"type": "String"
					}
				},
				"folder": {
					"name": "OEA_Framework/Ingest"
				},
				"annotations": []
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_SQL_Serverless_OEA')]",
				"[concat(variables('workspaceId'), '/datasets/DS_JSON')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Trigger Pipeline and wait on Completion')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "Create Pipeline Run",
						"type": "WebActivity",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"url": {
								"value": "https://@{pipeline().parameters.WorkspaceName}.dev.azuresynapse.net/pipelines/@{pipeline().parameters.PipelineName}/createRun?api-version=2020-12-01",
								"type": "Expression"
							},
							"connectVia": {
								"referenceName": "AutoResolveIntegrationRuntime",
								"type": "IntegrationRuntimeReference"
							},
							"method": "POST",
							"headers": {},
							"body": {
								"value": "@pipeline().parameters.PipelineParameters",
								"type": "Expression"
							},
							"authentication": {
								"type": "MSI",
								"resource": "https://dev.azuresynapse.net"
							}
						}
					},
					{
						"name": "Until Pipeline Finish",
						"type": "Until",
						"dependsOn": [
							{
								"activity": "Create Pipeline Run",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@or(equals(variables('isFailed'), true), equals(variables('isFinished'), true))",
								"type": "Expression"
							},
							"activities": [
								{
									"name": "Get Pipeline Run",
									"type": "WebActivity",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"url": {
											"value": "https://@{pipeline().parameters.WorkspaceName}.dev.azuresynapse.net/pipelineruns/@{activity('Create Pipeline Run').output.runId}?api-version=2020-12-01",
											"type": "Expression"
										},
										"connectVia": {
											"referenceName": "AutoResolveIntegrationRuntime",
											"type": "IntegrationRuntimeReference"
										},
										"method": "GET",
										"headers": {},
										"authentication": {
											"type": "MSI",
											"resource": "https://dev.azuresynapse.net"
										}
									}
								},
								{
									"name": "Check Success",
									"type": "IfCondition",
									"dependsOn": [
										{
											"activity": "Get Pipeline Run",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"expression": {
											"value": "@equals(activity('Get Pipeline Run').output.status, 'Succeeded')",
											"type": "Expression"
										},
										"ifTrueActivities": [
											{
												"name": "Set Finished",
												"type": "SetVariable",
												"dependsOn": [],
												"userProperties": [],
												"typeProperties": {
													"variableName": "isFinished",
													"value": {
														"value": "@bool(1)",
														"type": "Expression"
													}
												}
											}
										]
									}
								},
								{
									"name": "Check Failure",
									"type": "IfCondition",
									"dependsOn": [
										{
											"activity": "Get Pipeline Run",
											"dependencyConditions": [
												"Failed",
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"expression": {
											"value": "@or(contains(activity('Get Pipeline Run').output, 'error'), equals(activity('Get Pipeline Run').output.status, 'Failed'))",
											"type": "Expression"
										},
										"ifTrueActivities": [
											{
												"name": "Set isFailed",
												"type": "SetVariable",
												"dependsOn": [],
												"userProperties": [],
												"typeProperties": {
													"variableName": "isFailed",
													"value": {
														"value": "@bool(1)",
														"type": "Expression"
													}
												}
											}
										]
									}
								}
							],
							"timeout": "7.00:00:00"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"PipelineName": {
						"type": "string",
						"defaultValue": "Ingest_schools"
					},
					"PipelineParameters": {
						"type": "string"
					},
					"WorkspaceName": {
						"type": "string",
						"defaultValue": "syn-oea-cisdag1"
					}
				},
				"variables": {
					"isFinished": {
						"type": "Boolean",
						"defaultValue": false
					},
					"AccessToken": {
						"type": "String"
					},
					"isFailed": {
						"type": "Boolean",
						"defaultValue": false
					}
				},
				"folder": {
					"name": "OEA_Framework/Ingest"
				},
				"annotations": []
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Trigger_all_increamental_query_to_Stage1np')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"description": "Can trigger incremental ingestion for multiple entities simultaneously.\n\nParameter Description:\nEntities_To_Ingest : Json array with the following as endpoints.\n\nEntity,\nTableName,\nDirectory,\nSource,\nWatermarkColumnName",
				"activities": [
					{
						"name": "Trigger pipeline for individual entity",
						"description": "For each loop for every entry in the JSON Array parameter",
						"type": "ForEach",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@pipeline().parameters.Entities_To_Ingest",
								"type": "Expression"
							},
							"isSequential": false,
							"activities": [
								{
									"name": "ExecuteEntityQuery",
									"type": "ExecutePipeline",
									"dependsOn": [],
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "Incremental_query_ingest_to_Stage1np",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"Data_Source_Table_Name": {
												"value": "@item().TableName",
												"type": "Expression"
											},
											"Data_Source_WaterMarkColumn": {
												"value": "@item().WatermarkColumnName",
												"type": "Expression"
											},
											"Data_Destination_Container": "stage1np",
											"Data_Destination_Directory": {
												"value": "@item().Directory",
												"type": "Expression"
											},
											"Data_Source": {
												"value": "@item().Source",
												"type": "Expression"
											},
											"Entity": {
												"value": "@item().Entity",
												"type": "Expression"
											},
											"DbName": "contoso_sis",
											"DbServer": "contosoisd3a.database.windows.net",
											"Username": "sqladmin",
											"KeyVaultSecretValue": "sqladmin-password"
										}
									}
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"Entities_To_Ingest": {
						"type": "array",
						"defaultValue": [
							{
								"Entity": "Student",
								"WatermarkColumnName": "LastModifiedDate",
								"Source": "contoso_sis",
								"TableName": "contoso_sis.Student",
								"Directory": "contoso_sis"
							},
							{
								"Entity": "School",
								"WatermarkColumnName": "LastModifiedDate",
								"Source": "contoso_sis",
								"TableName": "contoso_sis.School",
								"Directory": "contoso_sis"
							}
						]
					}
				},
				"annotations": [],
				"lastPublishTime": "2021-11-29T13:08:04Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/pipelines/Incremental_query_ingest_to_Stage1np')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/create_lake_db')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "create_lake_db",
						"type": "SynapseNotebook",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "kwargs",
								"value": "{'stage_num':@{pipeline().parameters.stageNum},'source_dir':@{pipeline().parameters.sourceDirectory}"
							}
						],
						"typeProperties": {
							"notebook": {
								"referenceName": "OEA_connector",
								"type": "NotebookReference"
							},
							"parameters": {
								"object_name": {
									"value": "oea",
									"type": "string"
								},
								"method_name": {
									"value": "create_lake_db",
									"type": "string"
								},
								"kwargs": {
									"value": {
										"value": "{'stage_num':@{pipeline().parameters.stageNum},'source_dir':'@{pipeline().parameters.sourceDirectory}'}",
										"type": "Expression"
									},
									"type": "string"
								}
							},
							"sparkPool": {
								"referenceName": "spark3p1sm",
								"type": "BigDataPoolReference"
							},
							"conf": {
								"spark.dynamicAllocation.enabled": null,
								"spark.dynamicAllocation.minExecutors": null,
								"spark.dynamicAllocation.maxExecutors": null
							},
							"numExecutors": null
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"stageNum": {
						"type": "string",
						"defaultValue": "2"
					},
					"sourceDirectory": {
						"type": "string",
						"defaultValue": "contoso_sis"
					}
				},
				"folder": {
					"name": "OEA_Framework/Ingest"
				},
				"annotations": [],
				"lastPublishTime": "2022-01-15T22:36:53Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/notebooks/OEA_connector')]",
				"[concat(variables('workspaceId'), '/bigDataPools/spark3p1sm')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/create_sql_db')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "set sqlDBName",
						"type": "SetVariable",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"variableName": "sqlDBName",
							"value": {
								"value": "sqls@{pipeline().parameters.stage}_@{pipeline().parameters.sourceDirectory}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Stored procedure1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "set sqlDBName",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[dbo].[sp_executesql]",
							"storedProcedureParameters": {
								"command": {
									"value": {
										"value": "IF NOT EXISTS (SELECT * FROM sys.databases WHERE name = '@{variables('sqlDBName')}') \nBEGIN\n  CREATE DATABASE @{variables('sqlDBName')}; \nEND;",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "LS_SQL_Serverless_OEA",
							"type": "LinkedServiceReference",
							"parameters": {
								"dbName": "master"
							}
						}
					},
					{
						"name": "get folders in stageXp",
						"type": "GetMetadata",
						"dependsOn": [
							{
								"activity": "Stored procedure1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "DS_ADLS_binary_folder",
								"type": "DatasetReference",
								"parameters": {
									"filesystem": {
										"value": "stage@{pipeline().parameters.stage}p",
										"type": "Expression"
									},
									"directory": {
										"value": "@pipeline().parameters.sourceDirectory",
										"type": "Expression"
									}
								}
							},
							"fieldList": [
								"childItems"
							],
							"storeSettings": {
								"type": "AzureBlobFSReadSettings",
								"recursive": true,
								"enablePartitionDiscovery": false
							},
							"formatSettings": {
								"type": "BinaryReadSettings"
							}
						}
					},
					{
						"name": "ForEach1",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "get folders in stageXp",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('get folders in stageXp').output.childItems",
								"type": "Expression"
							},
							"activities": [
								{
									"name": "create or alter view for pseduonymized tables",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [
										{
											"name": "command",
											"value": "CREATE OR ALTER VIEW @{item().name} AS SELECT * FROM OPENROWSET( BULK 'https://@{pipeline().parameters.storageAccount}.dfs.core.windows.net/stage@{pipeline().parameters.stage}p/@{pipeline().parameters.sourceDirectory}/@{item().name}', FORMAT='DELTA' ) AS [r]"
										}
									],
									"typeProperties": {
										"storedProcedureName": "[dbo].[sp_executesql]",
										"storedProcedureParameters": {
											"command": {
												"value": {
													"value": "CREATE OR ALTER VIEW @{item().name} AS\nSELECT * FROM OPENROWSET(\nBULK 'https://@{pipeline().parameters.storageAccount}.dfs.core.windows.net/stage@{pipeline().parameters.stage}p/@{pipeline().parameters.sourceDirectory}/@{item().name}',\nFORMAT='DELTA'\n) AS [r]",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "LS_SQL_Serverless_OEA",
										"type": "LinkedServiceReference",
										"parameters": {
											"dbName": {
												"value": "@variables('sqlDBName')",
												"type": "Expression"
											}
										}
									}
								}
							]
						}
					},
					{
						"name": "get folders in stageXnp",
						"type": "GetMetadata",
						"dependsOn": [
							{
								"activity": "Stored procedure1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "DS_ADLS_binary_folder",
								"type": "DatasetReference",
								"parameters": {
									"filesystem": {
										"value": "stage@{pipeline().parameters.stage}np",
										"type": "Expression"
									},
									"directory": {
										"value": "@pipeline().parameters.sourceDirectory",
										"type": "Expression"
									}
								}
							},
							"fieldList": [
								"childItems"
							],
							"storeSettings": {
								"type": "AzureBlobFSReadSettings",
								"recursive": true,
								"enablePartitionDiscovery": false
							},
							"formatSettings": {
								"type": "BinaryReadSettings"
							}
						}
					},
					{
						"name": "ForEach2",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "get folders in stageXnp",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('get folders in stageXnp').output.childItems",
								"type": "Expression"
							},
							"activities": [
								{
									"name": "create or alter view for lookup tables",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [
										{
											"name": "command",
											"value": "CREATE OR ALTER VIEW @{item().name} AS SELECT * FROM OPENROWSET( BULK 'https://@{pipeline().parameters.storageAccount}.dfs.core.windows.net/stage@{pipeline().parameters.stage}p/@{pipeline().parameters.sourceDirectory}/@{item().name}', FORMAT='DELTA' ) AS [r]"
										}
									],
									"typeProperties": {
										"storedProcedureName": "[dbo].[sp_executesql]",
										"storedProcedureParameters": {
											"command": {
												"value": {
													"value": "CREATE OR ALTER VIEW @{item().name} AS\nSELECT * FROM OPENROWSET(\nBULK 'https://@{pipeline().parameters.storageAccount}.dfs.core.windows.net/stage@{pipeline().parameters.stage}np/@{pipeline().parameters.sourceDirectory}/@{item().name}',\nFORMAT='DELTA'\n) AS [r]",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "LS_SQL_Serverless_OEA",
										"type": "LinkedServiceReference",
										"parameters": {
											"dbName": {
												"value": "@variables('sqlDBName')",
												"type": "Expression"
											}
										}
									}
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"storageAccount": {
						"type": "string",
						"defaultValue": "stoeacisd3gg1"
					},
					"sourceDirectory": {
						"type": "string",
						"defaultValue": "contoso_sis"
					},
					"stage": {
						"type": "string",
						"defaultValue": "2"
					}
				},
				"variables": {
					"sqlDBName": {
						"type": "String",
						"defaultValue": "sqls2_mydb"
					}
				},
				"folder": {
					"name": "OEA_Framework/Ingest"
				},
				"annotations": [],
				"lastPublishTime": "2021-11-17T16:18:07Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_SQL_Serverless_OEA')]",
				"[concat(variables('workspaceId'), '/datasets/DS_ADLS_binary_folder')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/example_main_pipeline')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"description": "Example pipeline demonstrating typical orchestration of data extraction, landing, ingestion, and creation of lake and sql db's.",
				"activities": [
					{
						"name": "Extract from source - land in stage1np",
						"type": "ExecutePipeline",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "Copy_from_each_URL",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"endpoints": {
									"value": "@json('[{\"URL\": \"https://raw.githubusercontent.com/microsoft/OpenEduAnalytics/main/modules/Student_and_School_Data_Systems/test_data/batch1/studentattendance.csv\",\"sinkDirectory\": \"contoso_sis/studentattendance\",\"sinkFilename\": \"part1.csv\"}, {\"URL\": \"https://raw.githubusercontent.com/microsoft/OpenEduAnalytics/main/modules/Student_and_School_Data_Systems/test_data/batch1/studentdemographics.csv\",\"sinkDirectory\": \"contoso_sis/studentdemographics\",\"sinkFilename\": \"part1.csv\"}, {\"URL\": \"https://raw.githubusercontent.com/microsoft/OpenEduAnalytics/main/modules/Student_and_School_Data_Systems/test_data/batch1/studentsectionmark.csv\",\"sinkDirectory\": \"contoso_sis/studentsectionmark\",\"sinkFilename\": \"part1.csv\"}]')",
									"type": "Expression"
								},
								"sinkFilesystem": "stage1np",
								"timezone": "Eastern Standard Time"
							}
						}
					},
					{
						"name": "ingest into stage2p and 2np",
						"type": "SynapseNotebook",
						"dependsOn": [
							{
								"activity": "Extract from source - land in stage1np",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"notebook": {
								"referenceName": "OEA_connector",
								"type": "NotebookReference"
							},
							"parameters": {
								"object_name": {
									"value": "contoso_sis",
									"type": "string"
								},
								"method_name": {
									"value": "ingest",
									"type": "string"
								}
							},
							"sparkPool": {
								"referenceName": "spark3p1sm",
								"type": "BigDataPoolReference"
							},
							"conf": {
								"spark.dynamicAllocation.enabled": null,
								"spark.dynamicAllocation.minExecutors": null,
								"spark.dynamicAllocation.maxExecutors": null
							},
							"numExecutors": null
						}
					},
					{
						"name": "If create_sql_db",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "ingest into stage2p and 2np",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@pipeline().parameters.create_sql_db",
								"type": "Expression"
							},
							"ifTrueActivities": [
								{
									"name": "create_sql_db",
									"type": "ExecutePipeline",
									"dependsOn": [],
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "create_sql_db",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"storageAccount": {
												"value": "@pipeline().parameters.storageAccount",
												"type": "Expression"
											},
											"sourceDirectory": {
												"value": "@pipeline().parameters.sourceDirectory",
												"type": "Expression"
											},
											"stage": "2"
										}
									}
								}
							]
						}
					},
					{
						"name": "If create_lake_db",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "ingest into stage2p and 2np",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@pipeline().parameters.create_lake_db",
								"type": "Expression"
							},
							"ifTrueActivities": [
								{
									"name": "create_lake_db",
									"type": "ExecutePipeline",
									"dependsOn": [],
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "create_lake_db",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"stageNum": "2",
											"sourceDirectory": {
												"value": "@pipeline().parameters.sourceDirectory",
												"type": "Expression"
											}
										}
									}
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"storageAccount": {
						"type": "string",
						"defaultValue": "stoeacisd3v06rc2"
					},
					"sourceDirectory": {
						"type": "string",
						"defaultValue": "contoso_sis"
					},
					"create_sql_db": {
						"type": "bool",
						"defaultValue": true
					},
					"create_lake_db": {
						"type": "bool",
						"defaultValue": true
					}
				},
				"folder": {
					"name": "OEA_Framework"
				},
				"annotations": [],
				"lastPublishTime": "2022-01-15T22:37:17Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/pipelines/Copy_from_each_URL')]",
				"[concat(variables('workspaceId'), '/notebooks/OEA_connector')]",
				"[concat(variables('workspaceId'), '/bigDataPools/spark3p1sm')]",
				"[concat(variables('workspaceId'), '/pipelines/create_sql_db')]",
				"[concat(variables('workspaceId'), '/pipelines/create_lake_db')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/reset_all_for_source')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"description": "Deletes the ingestion for the specified system and table - in order to start over when testing during implementation.",
				"activities": [
					{
						"name": "delete source system dir from stage1np",
						"type": "Delete",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "DS_ADLS_binary_folder",
								"type": "DatasetReference",
								"parameters": {
									"filesystem": "stage1np",
									"directory": {
										"value": "@pipeline().parameters.sourceSystem",
										"type": "Expression"
									}
								}
							},
							"enableLogging": false,
							"storeSettings": {
								"type": "AzureBlobFSReadSettings",
								"recursive": true,
								"enablePartitionDiscovery": false
							}
						}
					},
					{
						"name": "delete from stage2np",
						"type": "Delete",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "DS_ADLS_binary_folder",
								"type": "DatasetReference",
								"parameters": {
									"filesystem": "stage2np",
									"directory": {
										"value": "@pipeline().parameters.sourceSystem",
										"type": "Expression"
									}
								}
							},
							"enableLogging": false,
							"storeSettings": {
								"type": "AzureBlobFSReadSettings",
								"recursive": true,
								"enablePartitionDiscovery": false
							}
						}
					},
					{
						"name": "delete from stage2p",
						"type": "Delete",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "DS_ADLS_binary_folder",
								"type": "DatasetReference",
								"parameters": {
									"filesystem": "stage2p",
									"directory": {
										"value": "@pipeline().parameters.sourceSystem",
										"type": "Expression"
									}
								}
							},
							"enableLogging": false,
							"storeSettings": {
								"type": "AzureBlobFSReadSettings",
								"recursive": true,
								"enablePartitionDiscovery": false
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"sourceSystem": {
						"type": "string",
						"defaultValue": "contoso_sis"
					}
				},
				"folder": {
					"name": "OEA_Framework/Reset"
				},
				"annotations": []
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/datasets/DS_ADLS_binary_folder')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/reset_ingestion_of_table')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"description": "Deletes the ingestion for the specified system and table - in order to start over when testing during implementation.",
				"activities": [
					{
						"name": "delete _checkpoints_p",
						"type": "Delete",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "DS_ADLS_binary_folder",
								"type": "DatasetReference",
								"parameters": {
									"filesystem": "stage1np",
									"directory": {
										"value": "@{pipeline().parameters.sourceSystem}/@{pipeline().parameters.tablename}/_checkpoints_p",
										"type": "Expression"
									}
								}
							},
							"enableLogging": false,
							"storeSettings": {
								"type": "AzureBlobFSReadSettings",
								"recursive": true,
								"enablePartitionDiscovery": false
							}
						}
					},
					{
						"name": "delete _checkpoints_np",
						"type": "Delete",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "DS_ADLS_binary_folder",
								"type": "DatasetReference",
								"parameters": {
									"filesystem": "stage1np",
									"directory": {
										"value": "@{pipeline().parameters.sourceSystem}/@{pipeline().parameters.tablename}/_checkpoints_np",
										"type": "Expression"
									}
								}
							},
							"enableLogging": false,
							"storeSettings": {
								"type": "AzureBlobFSReadSettings",
								"recursive": true,
								"enablePartitionDiscovery": false
							}
						}
					},
					{
						"name": "delete from stage2np",
						"type": "Delete",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "DS_ADLS_binary_folder",
								"type": "DatasetReference",
								"parameters": {
									"filesystem": "stage2np",
									"directory": {
										"value": "@{pipeline().parameters.sourceSystem}/@{pipeline().parameters.tablename}",
										"type": "Expression"
									}
								}
							},
							"enableLogging": false,
							"storeSettings": {
								"type": "AzureBlobFSReadSettings",
								"recursive": true,
								"enablePartitionDiscovery": false
							}
						}
					},
					{
						"name": "delete from stage2p",
						"type": "Delete",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "DS_ADLS_binary_folder",
								"type": "DatasetReference",
								"parameters": {
									"filesystem": "stage2p",
									"directory": {
										"value": "@{pipeline().parameters.sourceSystem}/@{pipeline().parameters.tablename}",
										"type": "Expression"
									}
								}
							},
							"enableLogging": false,
							"storeSettings": {
								"type": "AzureBlobFSReadSettings",
								"recursive": true,
								"enablePartitionDiscovery": false
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"sourceSystem": {
						"type": "string",
						"defaultValue": "contoso_sis"
					},
					"tablename": {
						"type": "string",
						"defaultValue": "studentattendance"
					}
				},
				"folder": {
					"name": "OEA_Framework/Reset"
				},
				"annotations": []
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/datasets/DS_ADLS_binary_folder')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/DS_ADLS_binary_file')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"description": "Used for landing data in the data lake.\nDefaults to landing data in stage1np.\nNote that you can specify a full path in the filename param (eg, to land a file in a specific folder filename param can be 'contoso_sis/students/students.csv').\n",
				"linkedServiceName": {
					"referenceName": "LS_ADLS_OEA",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"filesystem": {
						"type": "string",
						"defaultValue": "stage1np"
					},
					"filename": {
						"type": "string"
					}
				},
				"folder": {
					"name": "OEA_Framework"
				},
				"annotations": [],
				"type": "Binary",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": {
							"value": "@dataset().filename",
							"type": "Expression"
						},
						"fileSystem": {
							"value": "@dataset().filesystem",
							"type": "Expression"
						}
					}
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/DS_ADLS_binary_folder')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "LS_ADLS_OEA",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"filesystem": {
						"type": "string"
					},
					"directory": {
						"type": "string"
					}
				},
				"folder": {
					"name": "OEA_Framework"
				},
				"annotations": [],
				"type": "Binary",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"folderPath": {
							"value": "@dataset().directory",
							"type": "Expression"
						},
						"fileSystem": {
							"value": "@dataset().filesystem",
							"type": "Expression"
						}
					}
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/DS_ADLS_parquet')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"description": "Used for landing data in the data lake as in parquet format.\nDefaults to landing data in stage1np.\nNote that you cannot specify a filename because with parquet the filename should be auto-generated.\n",
				"linkedServiceName": {
					"referenceName": "LS_ADLS_OEA",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"filesystem": {
						"type": "string",
						"defaultValue": "stage1np"
					},
					"directory": {
						"type": "string"
					}
				},
				"folder": {
					"name": "OEA_Framework"
				},
				"annotations": [],
				"type": "Parquet",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"folderPath": {
							"value": "@dataset().directory",
							"type": "Expression"
						},
						"fileSystem": {
							"value": "@dataset().filesystem",
							"type": "Expression"
						}
					},
					"compressionCodec": "snappy"
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/DS_Azure_SQL_DB')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "LS_Azure_SQL_DB",
					"type": "LinkedServiceReference",
					"parameters": {
						"dbServer": {
							"value": "@dataset().dbServer",
							"type": "Expression"
						},
						"dbName": {
							"value": "@dataset().dbName",
							"type": "Expression"
						},
						"userName": {
							"value": "@dataset().userName",
							"type": "Expression"
						},
						"keyVaultSecretName": {
							"value": "@dataset().keyVaultSecretName",
							"type": "Expression"
						}
					}
				},
				"parameters": {
					"dbServer": {
						"type": "string",
						"defaultValue": "myserver.database.windows.net"
					},
					"dbName": {
						"type": "string",
						"defaultValue": "testdb"
					},
					"userName": {
						"type": "string",
						"defaultValue": "sqlAdmin"
					},
					"keyVaultSecretName": {
						"type": "string",
						"defaultValue": "sqlAdminPwd"
					}
				},
				"folder": {
					"name": "OEA_Framework"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_Azure_SQL_DB')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/DS_HTTP_binary')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"description": "Retrieves data from an http endpoint.\nThe data can be in any format - the binary dataset allows us to pull any payload without affecting it.",
				"linkedServiceName": {
					"referenceName": "LS_HTTP",
					"type": "LinkedServiceReference",
					"parameters": {
						"baseURL": {
							"value": "@dataset().URL",
							"type": "Expression"
						}
					}
				},
				"parameters": {
					"URL": {
						"type": "string"
					}
				},
				"folder": {
					"name": "OEA_Framework"
				},
				"annotations": [],
				"type": "Binary",
				"typeProperties": {
					"location": {
						"type": "HttpServerLocation"
					}
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_HTTP')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/DS_JSON')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "LS_ADLS_OEA",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"stage": {
						"type": "string",
						"defaultValue": "1"
					},
					"path": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "Json",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"folderPath": {
							"value": "@dataset().path",
							"type": "Expression"
						},
						"fileSystem": {
							"value": "stage@{dataset().stage}",
							"type": "Expression"
						}
					}
				},
				"schema": {}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/DS_JSON_File')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "LS_ADLS_OEA",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"stage": {
						"type": "string",
						"defaultValue": "1"
					},
					"path": {
						"type": "string"
					},
					"fileName": {
						"type": "string",
						"defaultValue": "data.json"
					}
				},
				"annotations": [],
				"type": "Json",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": {
							"value": "@dataset().fileName",
							"type": "Expression"
						},
						"folderPath": {
							"value": "@dataset().path",
							"type": "Expression"
						},
						"fileSystem": {
							"value": "stage@{dataset().stage}",
							"type": "Expression"
						}
					}
				},
				"schema": {}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/DS_REST')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "LS_REST",
					"type": "LinkedServiceReference",
					"parameters": {
						"ClientId": {
							"value": "@dataset().ClientId",
							"type": "Expression"
						},
						"SecretName": {
							"value": "@dataset().SecretName",
							"type": "Expression"
						},
						"BaseURL": {
							"value": "@dataset().BaseURL",
							"type": "Expression"
						}
					}
				},
				"parameters": {
					"RelativeURL": {
						"type": "string"
					},
					"ClientId": {
						"type": "string"
					},
					"SecretName": {
						"type": "string"
					},
					"BaseURL": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "RestResource",
				"typeProperties": {
					"relativeUrl": {
						"value": "@dataset().RelativeURL",
						"type": "Expression"
					}
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_REST')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/LS_ADLS_OEA')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"description": "Connection to the OEA data lake",
				"annotations": [],
				"type": "AzureBlobFS",
				"typeProperties": {
					"url": "[parameters('LS_ADLS_OEA_properties_typeProperties_url')]"
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/LS_Azure_SQL_DB')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"description": "Allows for connecting to an Azure SQL database using SQL authentication and retrieving the user password from the key vault.",
				"parameters": {
					"dbServer": {
						"type": "string",
						"defaultValue": "myserver.database.windows.net"
					},
					"dbName": {
						"type": "string",
						"defaultValue": "testdb"
					},
					"userName": {
						"type": "string",
						"defaultValue": "sqlAdmin"
					},
					"keyVaultSecretName": {
						"type": "string",
						"defaultValue": "sqlAdminPwd"
					}
				},
				"annotations": [],
				"type": "AzureSqlDatabase",
				"typeProperties": {
					"connectionString": "[parameters('LS_Azure_SQL_DB_connectionString')]",
					"password": {
						"type": "AzureKeyVaultSecret",
						"store": {
							"referenceName": "LS_KeyVault_OEA",
							"type": "LinkedServiceReference"
						},
						"secretName": {
							"value": "@linkedService().keyVaultSecretName",
							"type": "Expression"
						}
					}
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]",
				"[concat(variables('workspaceId'), '/linkedServices/LS_KeyVault_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/LS_HTTP')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"description": "Connection to an HTTP endpoint.\nThe baseURL parameter must be passed in from the dataset that utilizes this linked service.",
				"parameters": {
					"baseURL": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "HttpServer",
				"typeProperties": {
					"url": "[parameters('LS_HTTP_properties_typeProperties_url')]",
					"enableServerCertificateValidation": true,
					"authenticationType": "Anonymous"
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/LS_KeyVault_OEA')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "AzureKeyVault",
				"typeProperties": {
					"baseUrl": "[parameters('LS_KeyVault_OEA_properties_typeProperties_baseUrl')]"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/LS_REST')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"parameters": {
					"ClientId": {
						"type": "string"
					},
					"SecretName": {
						"type": "string"
					},
					"BaseURL": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "RestService",
				"typeProperties": {
					"url": "[parameters('LS_REST_properties_typeProperties_url')]",
					"enableServerCertificateValidation": true,
					"authenticationType": "Basic",
					"userName": "[parameters('LS_REST_properties_typeProperties_userName')]",
					"password": {
						"type": "AzureKeyVaultSecret",
						"store": {
							"referenceName": "LS_KeyVault_OEA",
							"type": "LinkedServiceReference"
						},
						"secretName": {
							"value": "@linkedService().SecretName",
							"type": "Expression"
						}
					}
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]",
				"[concat(variables('workspaceId'), '/linkedServices/LS_KeyVault_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/LS_SQL_Serverless_OEA')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"parameters": {
					"dbName": {
						"type": "string",
						"defaultValue": "master"
					}
				},
				"annotations": [],
				"type": "AzureSqlDatabase",
				"typeProperties": {
					"connectionString": "[parameters('LS_SQL_Serverless_OEA_connectionString')]"
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/LS_datalake')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "AzureBlobFS",
				"typeProperties": {
					"url": "[parameters('LS_datalake_properties_typeProperties_url')]",
					"accountKey": {
						"type": "SecureString",
						"value": "[parameters('LS_datalake_accountKey')]"
					}
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/syn-oea-cisdag1-WorkspaceDefaultSqlServer')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"parameters": {
					"DBName": {
						"type": "String"
					}
				},
				"annotations": [],
				"type": "AzureSqlDW",
				"typeProperties": {
					"connectionString": "[parameters('syn-oea-cisdag1-WorkspaceDefaultSqlServer_connectionString')]"
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/syn-oea-cisdag1-WorkspaceDefaultStorage')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "AzureBlobFS",
				"typeProperties": {
					"url": "[parameters('syn-oea-cisdag1-WorkspaceDefaultStorage_properties_typeProperties_url')]"
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/AutoResolveIntegrationRuntime')]",
			"type": "Microsoft.Synapse/workspaces/integrationRuntimes",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"type": "Managed",
				"typeProperties": {
					"computeProperties": {
						"location": "AutoResolve",
						"dataFlowProperties": {
							"computeType": "General",
							"coreCount": 8,
							"timeToLive": 0
						}
					}
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Process deletes')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "s2deltaSource"
						},
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "s1deletes"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_datalake",
								"type": "LinkedServiceReference"
							},
							"name": "sink2"
						}
					],
					"transformations": [
						{
							"name": "AlterRow2"
						},
						{
							"name": "exists1"
						}
					],
					"scriptLines": [
						"parameters{",
						"     SourceTable as string ('schools'),",
						"     directory as string ('Testing'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901'),",
						"     entity as string ('schools')",
						"}",
						"source(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     ignoreNoFilesFound: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$SourceTable}\")) ~> s2deltaSource",
						"source(useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Deletes/\"),",
						"     documentForm: 'documentPerLine') ~> s1deletes",
						"exists1 alterRow(deleteIf(true())) ~> AlterRow2",
						"s2deltaSource, s1deletes exists(toString(byName('id')) == toString(byName('Id')),",
						"     negate:false,",
						"     broadcast: 'auto')~> exists1",
						"AlterRow2 sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$SourceTable}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: false,",
						"     vacuum: 0,",
						"     deletable:true,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:false,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> sink2"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]",
				"[concat(variables('workspaceId'), '/linkedServices/LS_datalake')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_Descriptors')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_datalake",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterRow"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('schools'),",
						"     directory as string ('EdFi'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901'),",
						"     descriptorId as string",
						"}",
						"source(useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterRow",
						"DerivedColumn select(mapColumn(",
						"          each(match(name!='DerivedColumn'&&name!=$descriptorId)),",
						"          each(match(name=='DerivedColumn'),",
						"               $descriptorId = $$)",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(DerivedColumn = toShort(byName($descriptorId)),",
						"          LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterRow sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]",
				"[concat(variables('workspaceId'), '/linkedServices/LS_datalake')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_academicWeeks')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('academicWeeks'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          weekIdentifier as string,",
						"          schoolReference as (schoolId as integer, link as (rel as string, href as string)),",
						"          beginDate as date,",
						"          endDate as date,",
						"          totalInstructionalDays as integer,",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          weekIdentifier,",
						"          schoolId = schoolReference.schoolId,",
						"          beginDate,",
						"          endDate,",
						"          totalInstructionalDays,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_accountCodes')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('accountCodes'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          accountClassificationDescriptor as string,",
						"          accountCodeNumber as string,",
						"          fiscalYear as integer,",
						"          educationOrganizationReference as (educationOrganizationId as integer, link as (rel as string, href as string)),",
						"          accountCodeDescription as string,",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          accountClassificationDescriptor,",
						"          accountCodeNumber,",
						"          fiscalYear,",
						"          educationOrganizationId = educationOrganizationReference.educationOrganizationId,",
						"          accountCodeDescription,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_accountabilityRatings')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('accountabilityRatings'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          ratingTitle as string,",
						"          educationOrganizationReference as (educationOrganizationId as integer, link as (rel as string, href as string)),",
						"          schoolYearTypeReference as (schoolYear as integer, link as (rel as string, href as string)),",
						"          rating as string,",
						"          ratingDate as date,",
						"          ratingOrganization as string,",
						"          ratingProgram as string,",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          ratingTitle,",
						"          educationOrganizationId = educationOrganizationReference.educationOrganizationId,",
						"          schoolYear = schoolYearTypeReference.schoolYear,",
						"          rating,",
						"          ratingDate,",
						"          ratingOrganization,",
						"          ratingProgram,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_accounts')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('accounts'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          accountCodes as (accountCodeReference as (accountClassificationDescriptor as string, accountCodeNumber as string, educationOrganizationId as integer, fiscalYear as integer, link as (rel as string, href as string)))[],",
						"          accountIdentifier as string,",
						"          fiscalYear as integer,",
						"          educationOrganizationReference as (educationOrganizationId as integer, link as (rel as string, href as string)),",
						"          accountName as string,",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          accountCodes,",
						"          accountIdentifier,",
						"          fiscalYear,",
						"          educationOrganizationId = educationOrganizationReference.educationOrganizationId,",
						"          accountName,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_actuals')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('actuals'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          asOfDate as date,",
						"          accountReference as (accountIdentifier as string, educationOrganizationId as integer, fiscalYear as integer, link as (rel as string, href as string)),",
						"          amountToDate as float,",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          asOfDate,",
						"          educationOrganizationId = accountReference.educationOrganizationId,",
						"          accountIdentifier = accountReference.accountIdentifier,",
						"          fiscalYear = accountReference.fiscalYear,",
						"          amountToDate,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_assessmentItems')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('assessmentItems'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          identificationCode as string,",
						"          assessmentReference as (assessmentIdentifier as string, namespace as string, link as (rel as string, href as string)),",
						"          assessmentItemCategoryDescriptor as string,",
						"          assessmentItemURI as string,",
						"          correctResponse as string,",
						"          expectedTimeAssessed as string,",
						"          itemText as string,",
						"          learningStandards as (learningStandardReference as (learningStandardId as string, link as (rel as string, href as string)))[],",
						"          maxRawScore as float,",
						"          nomenclature as string,",
						"          possibleResponses as (responseValue as string, correctResponse as boolean, responseDescription as string)[],",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          identificationCode,",
						"          assessmentIdentifier = assessmentReference.assessmentIdentifier,",
						"          namespace = assessmentReference.namespace,",
						"          assessmentItemCategoryDescriptor,",
						"          assessmentItemURI,",
						"          correctResponse,",
						"          expectedTimeAssessed,",
						"          itemText,",
						"          learningStandards,",
						"          maxRawScore,",
						"          nomenclature,",
						"          possibleResponses,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_assessmentScoreRangeLearningStandards')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('assessmentScoreRangeLearningStandards'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          learningStandards as (learningStandardReference as (learningStandardId as string, link as (rel as string, href as string)))[],",
						"          scoreRangeId as string,",
						"          assessmentReference as (assessmentIdentifier as string, namespace as string, link as (rel as string, href as string)),",
						"          objectiveAssessmentReference as (assessmentIdentifier as string, identificationCode as string, namespace as string, link as (rel as string, href as string)),",
						"          assessmentReportingMethodDescriptor as string,",
						"          maximumScore as string,",
						"          minimumScore as string,",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          learningStandards,",
						"          scoreRangeId,",
						"          assessmentIdentifier = assessmentReference.assessmentIdentifier,",
						"          namespace = assessmentReference.namespace,",
						"          objectiveAssessmentReference,",
						"          assessmentReportingMethodDescriptor,",
						"          maximumScore,",
						"          minimumScore,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_assessments')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('assessments'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          academicSubjects as (academicSubjectDescriptor as string)[],",
						"          assessmentIdentifier as string,",
						"          namespace as string,",
						"          educationOrganizationReference as (educationOrganizationId as integer, link as (rel as string, href as string)),",
						"          adaptiveAssessment as boolean,",
						"          assessedGradeLevels as (gradeLevelDescriptor as string)[],",
						"          assessmentCategoryDescriptor as string,",
						"          assessmentFamily as string,",
						"          assessmentForm as string,",
						"          assessmentTitle as string,",
						"          assessmentVersion as integer,",
						"          contentStandard as (publicationStatusDescriptor as string, beginDate as date, endDate as date, publicationDate as date, publicationYear as integer, title as string, uri as string, version as string, mandatingEducationOrganizationReference as (educationOrganizationId as integer, link as (rel as string, href as string)), authors as (author as string)[]),",
						"          identificationCodes as (assessmentIdentificationSystemDescriptor as string, assigningOrganizationIdentificationCode as string, identificationCode as string)[],",
						"          languages as (languageDescriptor as string)[],",
						"          maxRawScore as float,",
						"          nomenclature as string,",
						"          performanceLevels as (assessmentReportingMethodDescriptor as string, performanceLevelDescriptor as string, resultDatatypeTypeDescriptor as string, maximumScore as string, minimumScore as string)[],",
						"          period as (assessmentPeriodDescriptor as string, beginDate as date, endDate as date),",
						"          platformTypes as (platformTypeDescriptor as string)[],",
						"          programs as (programReference as (educationOrganizationId as integer, programName as string, programTypeDescriptor as string, link as (rel as string, href as string)))[],",
						"          revisionDate as date,",
						"          scores as (assessmentReportingMethodDescriptor as string, resultDatatypeTypeDescriptor as string, maximumScore as string, minimumScore as string)[],",
						"          sections as (sectionReference as (localCourseCode as string, schoolId as integer, schoolYear as integer, sectionIdentifier as string, sessionName as string, link as (rel as string, href as string)))[],",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          academicSubjects,",
						"          assessmentIdentifier,",
						"          namespace,",
						"          educationOrganizationId = educationOrganizationReference.educationOrganizationId,",
						"          adaptiveAssessment,",
						"          assessedGradeLevels,",
						"          assessmentCategoryDescriptor,",
						"          assessmentFamily,",
						"          assessmentForm,",
						"          assessmentTitle,",
						"          assessmentVersion,",
						"          contentStandard,",
						"          identificationCodes,",
						"          languages,",
						"          maxRawScore,",
						"          nomenclature,",
						"          performanceLevels,",
						"          period,",
						"          platformTypes,",
						"          programs,",
						"          revisionDate,",
						"          scores,",
						"          sections,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_bellSchedules')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('bellSchedules'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          bellScheduleName as string,",
						"          classPeriods as (classPeriodReference as (classPeriodName as string, schoolId as integer, link as (rel as string, href as string)))[],",
						"          schoolReference as (schoolId as integer, link as (rel as string, href as string)),",
						"          alternateDayName as string,",
						"          dates as (date as date)[],",
						"          endTime as string,",
						"          gradeLevels as (gradeLevelDescriptor as string)[],",
						"          startTime as string,",
						"          totalInstructionalTime as integer,",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          bellScheduleName,",
						"          classPeriods,",
						"          schoolId = schoolReference.schoolId,",
						"          alternateDayName,",
						"          dates,",
						"          endTime,",
						"          gradeLevels,",
						"          startTime,",
						"          totalInstructionalTime,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_budgets')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('budgets'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          asOfDate as date,",
						"          accountReference as (accountIdentifier as string, educationOrganizationId as integer, fiscalYear as integer, link as (rel as string, href as string)),",
						"          amount as float,",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          asOfDate,",
						"          accountReference,",
						"          amount,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_calendarDates')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('calendarDates'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          calendarEvents as (calendarEventDescriptor as string)[],",
						"          date as date,",
						"          calendarReference as (calendarCode as string, schoolId as integer, schoolYear as integer, link as (rel as string, href as string)),",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          calendarEvents,",
						"          date,",
						"          calendarCode = calendarReference.calendarCode,",
						"          schoolId = calendarReference.schoolId,",
						"          schoolYear = calendarReference.schoolYear,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_calendars')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('calendars'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          calendarCode as string,",
						"          schoolReference as (schoolId as integer, link as (rel as string, href as string)),",
						"          schoolYearTypeReference as (schoolYear as integer, link as (rel as string, href as string)),",
						"          calendarTypeDescriptor as string,",
						"          gradeLevels as (gradeLevelDescriptor as string)[],",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          calendarCode,",
						"          schoolReference,",
						"          schoolYear = schoolYearTypeReference.schoolYear,",
						"          calendarTypeDescriptor,",
						"          gradeLevels,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_candidateEducatorPreparationProgramAssociations')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('candidateEducatorPreparationProgramAssociations'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          beginDate as date,",
						"          candidateReference as (candidateIdentifier as string, link as (rel as string, href as string)),",
						"          educatorPreparationProgramReference as (educationOrganizationId as integer, programName as string, programTypeDescriptor as string, link as (rel as string, href as string)),",
						"          cohortYears as (cohortYearTypeDescriptor as string, termDescriptor as string, schoolYearTypeReference as (schoolYear as integer, link as (rel as string, href as string)))[],",
						"          degreeSpecializations as (majorSpecialization as string, endDate as date, minorSpecialization as string)[],",
						"          endDate as date,",
						"          eppProgramPathwayDescriptor as string,",
						"          reasonExitedDescriptor as string,",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          beginDate,",
						"          candidateReference,",
						"          educatorPreparationProgramReference,",
						"          cohortYears,",
						"          degreeSpecializations,",
						"          endDate,",
						"          eppProgramPathwayDescriptor,",
						"          reasonExitedDescriptor,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_candidates')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('candidates'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          candidateIdentifier as string,",
						"          personReference as (personId as string, sourceSystemDescriptor as string, link as (rel as string, href as string)),",
						"          addresses as (addressTypeDescriptor as string, stateAbbreviationDescriptor as string, city as string, postalCode as string, streetNumberName as string, localeDescriptor as string, apartmentRoomSuiteNumber as string, buildingSiteNumber as string, congressionalDistrict as string, countyFIPSCode as string, doNotPublishIndicator as boolean, latitude as string, longitude as string, nameOfCounty as string, periods as (beginDate as date, endDate as date)[])[],",
						"          birthCity as string,",
						"          birthCountryDescriptor as string,",
						"          birthDate as date,",
						"          birthInternationalProvince as string,",
						"          birthSexDescriptor as string,",
						"          birthStateAbbreviationDescriptor as string,",
						"          dateEnteredUS as date,",
						"          disabilities as (disabilityDescriptor as string, disabilityDeterminationSourceTypeDescriptor as string, disabilityDiagnosis as string, orderOfDisability as integer, designations as (disabilityDesignationDescriptor as string)[])[],",
						"          displacementStatus as string,",
						"          economicDisadvantaged as boolean,",
						"          electronicMails as (electronicMailTypeDescriptor as string, electronicMailAddress as string, doNotPublishIndicator as boolean, primaryEmailAddressIndicator as boolean)[],",
						"          englishLanguageExamDescriptor as string,",
						"          firstGenerationStudent as boolean,",
						"          firstName as string,",
						"          genderDescriptor as string,",
						"          generationCodeSuffix as string,",
						"          hispanicLatinoEthnicity as boolean,",
						"          languages as (languageDescriptor as string, uses as (languageUseDescriptor as string)[])[],",
						"          lastSurname as string,",
						"          limitedEnglishProficiencyDescriptor as string,",
						"          maidenName as string,",
						"          middleName as string,",
						"          multipleBirthStatus as boolean,",
						"          otherNames as (otherNameTypeDescriptor as string, firstName as string, generationCodeSuffix as string, lastSurname as string, middleName as string, personalTitlePrefix as string)[],",
						"          personalIdentificationDocuments as (identificationDocumentUseDescriptor as string, personalInformationVerificationDescriptor as string, issuerCountryDescriptor as string, documentExpirationDate as date, documentTitle as string, issuerDocumentIdentificationCode as string, issuerName as string)[],",
						"          personalTitlePrefix as string,",
						"          races as (raceDescriptor as string)[],",
						"          sexDescriptor as string,",
						"          telephones as (telephoneNumberTypeDescriptor as string, telephoneNumber as string, doNotPublishIndicator as boolean, orderOfPriority as integer, textMessageCapabilityIndicator as boolean)[],",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          candidateIdentifier,",
						"          personReference,",
						"          addresses,",
						"          birthCity,",
						"          birthCountryDescriptor,",
						"          birthDate,",
						"          birthInternationalProvince,",
						"          birthSexDescriptor,",
						"          birthStateAbbreviationDescriptor,",
						"          dateEnteredUS,",
						"          disabilities,",
						"          displacementStatus,",
						"          economicDisadvantaged,",
						"          electronicMails,",
						"          englishLanguageExamDescriptor,",
						"          firstGenerationStudent,",
						"          firstName,",
						"          genderDescriptor,",
						"          generationCodeSuffix,",
						"          hispanicLatinoEthnicity,",
						"          languages,",
						"          lastSurname,",
						"          limitedEnglishProficiencyDescriptor,",
						"          maidenName,",
						"          middleName,",
						"          multipleBirthStatus,",
						"          otherNames,",
						"          personalIdentificationDocuments,",
						"          personalTitlePrefix,",
						"          races,",
						"          sexDescriptor,",
						"          telephones,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_classPeriods')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('classPeriods'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          classPeriodName as string,",
						"          schoolReference as (schoolId as integer, link as (rel as string, href as string)),",
						"          meetingTimes as (endTime as string, startTime as string)[],",
						"          officialAttendancePeriod as boolean,",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          classPeriodName,",
						"          schoolId = schoolReference.schoolId,",
						"          meetingTimes,",
						"          officialAttendancePeriod,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_cohorts')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('cohorts'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          cohortIdentifier as string,",
						"          educationOrganizationReference as (educationOrganizationId as integer, link as (rel as string, href as string)),",
						"          academicSubjectDescriptor as string,",
						"          cohortDescription as string,",
						"          cohortScopeDescriptor as string,",
						"          cohortTypeDescriptor as string,",
						"          programs as (programReference as (educationOrganizationId as integer, programName as string, programTypeDescriptor as string, link as (rel as string, href as string)))[],",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          cohortIdentifier,",
						"          educationOrganizationId = educationOrganizationReference.educationOrganizationId,",
						"          academicSubjectDescriptor,",
						"          cohortDescription,",
						"          cohortScopeDescriptor,",
						"          cohortTypeDescriptor,",
						"          programs,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_communityOrganizations')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('communityOrganizations'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          categories as (educationOrganizationCategoryDescriptor as string)[],",
						"          communityOrganizationId as integer,",
						"          addresses as (addressTypeDescriptor as string, stateAbbreviationDescriptor as string, city as string, postalCode as string, streetNumberName as string, localeDescriptor as string, apartmentRoomSuiteNumber as string, buildingSiteNumber as string, congressionalDistrict as string, countyFIPSCode as string, doNotPublishIndicator as boolean, latitude as string, longitude as string, nameOfCounty as string, periods as (beginDate as date, endDate as date)[])[],",
						"          identificationCodes as (educationOrganizationIdentificationSystemDescriptor as string, identificationCode as string)[],",
						"          indicators as (indicatorDescriptor as string, indicatorGroupDescriptor as string, indicatorLevelDescriptor as string, designatedBy as string, indicatorValue as string, periods as (beginDate as date, endDate as date)[])[],",
						"          institutionTelephones as (institutionTelephoneNumberTypeDescriptor as string, telephoneNumber as string)[],",
						"          internationalAddresses as (addressTypeDescriptor as string, countryDescriptor as string, addressLine1 as string, addressLine2 as string, addressLine3 as string, addressLine4 as string, beginDate as date, endDate as date, latitude as string, longitude as string)[],",
						"          nameOfInstitution as string,",
						"          operationalStatusDescriptor as string,",
						"          shortNameOfInstitution as string,",
						"          webSite as string,",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          categories,",
						"          communityOrganizationId,",
						"          addresses,",
						"          identificationCodes,",
						"          indicators,",
						"          institutionTelephones,",
						"          internationalAddresses,",
						"          nameOfInstitution,",
						"          operationalStatusDescriptor,",
						"          shortNameOfInstitution,",
						"          webSite,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_communityProviderLicenses')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('communityProviderLicenses'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          licenseIdentifier as string,",
						"          licensingOrganization as string,",
						"          communityProviderReference as (communityProviderId as integer, link as (rel as string, href as string)),",
						"          authorizedFacilityCapacity as integer,",
						"          licenseEffectiveDate as date,",
						"          licenseExpirationDate as date,",
						"          licenseIssueDate as date,",
						"          licenseStatusDescriptor as string,",
						"          licenseTypeDescriptor as string,",
						"          oldestAgeAuthorizedToServe as integer,",
						"          youngestAgeAuthorizedToServe as integer,",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          licenseIdentifier,",
						"          licensingOrganization,",
						"          communityProviderId = communityProviderReference.communityProviderId,",
						"          authorizedFacilityCapacity,",
						"          licenseEffectiveDate,",
						"          licenseExpirationDate,",
						"          licenseIssueDate,",
						"          licenseStatusDescriptor,",
						"          licenseTypeDescriptor,",
						"          oldestAgeAuthorizedToServe,",
						"          youngestAgeAuthorizedToServe,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_communityProviders')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('communityProviders'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          categories as (educationOrganizationCategoryDescriptor as string)[],",
						"          communityProviderId as integer,",
						"          communityOrganizationReference as (communityOrganizationId as integer, link as (rel as string, href as string)),",
						"          addresses as (addressTypeDescriptor as string, stateAbbreviationDescriptor as string, city as string, postalCode as string, streetNumberName as string, localeDescriptor as string, apartmentRoomSuiteNumber as string, buildingSiteNumber as string, congressionalDistrict as string, countyFIPSCode as string, doNotPublishIndicator as boolean, latitude as string, longitude as string, nameOfCounty as string, periods as (beginDate as date, endDate as date)[])[],",
						"          identificationCodes as (educationOrganizationIdentificationSystemDescriptor as string, identificationCode as string)[],",
						"          indicators as (indicatorDescriptor as string, indicatorGroupDescriptor as string, indicatorLevelDescriptor as string, designatedBy as string, indicatorValue as string, periods as (beginDate as date, endDate as date)[])[],",
						"          institutionTelephones as (institutionTelephoneNumberTypeDescriptor as string, telephoneNumber as string)[],",
						"          internationalAddresses as (addressTypeDescriptor as string, countryDescriptor as string, addressLine1 as string, addressLine2 as string, addressLine3 as string, addressLine4 as string, beginDate as date, endDate as date, latitude as string, longitude as string)[],",
						"          licenseExemptIndicator as boolean,",
						"          nameOfInstitution as string,",
						"          operationalStatusDescriptor as string,",
						"          providerCategoryDescriptor as string,",
						"          providerProfitabilityDescriptor as string,",
						"          providerStatusDescriptor as string,",
						"          schoolIndicator as boolean,",
						"          shortNameOfInstitution as string,",
						"          webSite as string,",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          categories,",
						"          communityProviderId,",
						"          communityOrganizationId = communityOrganizationReference.communityOrganizationId,",
						"          addresses,",
						"          identificationCodes,",
						"          indicators,",
						"          institutionTelephones,",
						"          internationalAddresses,",
						"          licenseExemptIndicator,",
						"          nameOfInstitution,",
						"          operationalStatusDescriptor,",
						"          providerCategoryDescriptor,",
						"          providerProfitabilityDescriptor,",
						"          providerStatusDescriptor,",
						"          schoolIndicator,",
						"          shortNameOfInstitution,",
						"          webSite,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_competencyObjectives')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('competencyObjectives'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          objective as string,",
						"          objectiveGradeLevelDescriptor as string,",
						"          educationOrganizationReference as (educationOrganizationId as integer, link as (rel as string, href as string)),",
						"          competencyObjectiveId as string,",
						"          description as string,",
						"          successCriteria as string,",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          objective,",
						"          objectiveGradeLevelDescriptor,",
						"          educationOrganizationId = educationOrganizationReference.educationOrganizationId,",
						"          competencyObjectiveId,",
						"          description,",
						"          successCriteria,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_contractedStaffs')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('contractedStaffs'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          asOfDate as date,",
						"          accountReference as (accountIdentifier as string, educationOrganizationId as integer, fiscalYear as integer, link as (rel as string, href as string)),",
						"          staffReference as (staffUniqueId as string, link as (rel as string, href as string)),",
						"          amountToDate as float,",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          asOfDate,",
						"          educationOrganizationId = accountReference.educationOrganizationId,",
						"          accountIdentifier = accountReference.accountIdentifier,",
						"          fiscalYear = accountReference.fiscalYear,",
						"          staffUniqueId = staffReference.staffUniqueId,",
						"          amountToDate,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_courseOfferings')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('courseOfferings'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          localCourseCode as string,",
						"          courseReference as (courseCode as string, educationOrganizationId as integer, link as (rel as string, href as string)),",
						"          schoolReference as (schoolId as integer, link as (rel as string, href as string)),",
						"          sessionReference as (schoolId as integer, schoolYear as integer, sessionName as string, link as (rel as string, href as string)),",
						"          courseLevelCharacteristics as (courseLevelCharacteristicDescriptor as string)[],",
						"          curriculumUseds as (curriculumUsedDescriptor as string)[],",
						"          instructionalTimePlanned as integer,",
						"          localCourseTitle as string,",
						"          offeredGradeLevels as (gradeLevelDescriptor as string)[],",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          localCourseCode,",
						"          educationOrganizationId = courseReference.educationOrganizationId,",
						"          courseCode = courseReference.courseCode,",
						"          schoolId = schoolReference.schoolId,",
						"          sessionName = sessionReference.sessionName,",
						"          schoolYear = sessionReference.schoolYear,",
						"          schoolId = sessionReference.schoolId,",
						"          courseLevelCharacteristics,",
						"          curriculumUseds,",
						"          instructionalTimePlanned,",
						"          localCourseTitle,",
						"          offeredGradeLevels,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_courseTranscripts')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('courseTranscripts'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          courseAttemptResultDescriptor as string,",
						"          courseReference as (courseCode as string, educationOrganizationId as integer, link as (rel as string, href as string)),",
						"          externalEducationOrganizationReference as (educationOrganizationId as integer, link as (rel as string, href as string)),",
						"          studentAcademicRecordReference as (educationOrganizationId as integer, schoolYear as integer, studentUniqueId as string, termDescriptor as string, link as (rel as string, href as string)),",
						"          academicSubjects as (academicSubjectDescriptor as string)[],",
						"          alternativeCourseCode as string,",
						"          alternativeCourseIdentificationCodes as (courseIdentificationSystemDescriptor as string, assigningOrganizationIdentificationCode as string, courseCatalogURL as string, identificationCode as string)[],",
						"          alternativeCourseTitle as string,",
						"          assigningOrganizationIdentificationCode as string,",
						"          attemptedCreditConversion as float,",
						"          attemptedCredits as float,",
						"          attemptedCreditTypeDescriptor as string,",
						"          courseCatalogURL as string,",
						"          courseRepeatCodeDescriptor as string,",
						"          courseTitle as string,",
						"          creditCategories as (creditCategoryDescriptor as string)[],",
						"          earnedAdditionalCredits as (additionalCreditTypeDescriptor as string, credits as float)[],",
						"          earnedCreditConversion as float,",
						"          earnedCredits as float,",
						"          earnedCreditTypeDescriptor as string,",
						"          externalEducationOrganizationNameOfInstitution as string,",
						"          finalLetterGradeEarned as string,",
						"          finalNumericGradeEarned as float,",
						"          methodCreditEarnedDescriptor as string,",
						"          partialCourseTranscriptAwards as (awardDate as date, methodCreditEarnedDescriptor as string, earnedCredits as float, letterGradeEarned as string, numericGradeEarned as string)[],",
						"          whenTakenGradeLevelDescriptor as string,",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          courseAttemptResultDescriptor,",
						"          educationOrganizationId = courseReference.educationOrganizationId,",
						"          courseCode = courseReference.courseCode,",
						"          externalEducationOrganizationReference,",
						"          studentAcademicRecordReference,",
						"          academicSubjects,",
						"          alternativeCourseCode,",
						"          alternativeCourseIdentificationCodes,",
						"          alternativeCourseTitle,",
						"          assigningOrganizationIdentificationCode,",
						"          attemptedCreditConversion,",
						"          attemptedCredits,",
						"          attemptedCreditTypeDescriptor,",
						"          courseCatalogURL,",
						"          courseRepeatCodeDescriptor,",
						"          courseTitle,",
						"          creditCategories,",
						"          earnedAdditionalCredits,",
						"          earnedCreditConversion,",
						"          earnedCredits,",
						"          earnedCreditTypeDescriptor,",
						"          externalEducationOrganizationNameOfInstitution,",
						"          finalLetterGradeEarned,",
						"          finalNumericGradeEarned,",
						"          methodCreditEarnedDescriptor,",
						"          partialCourseTranscriptAwards,",
						"          whenTakenGradeLevelDescriptor,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_courses')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('courses'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          courseCode as string,",
						"          identificationCodes as (courseIdentificationSystemDescriptor as string, assigningOrganizationIdentificationCode as string, courseCatalogURL as string, identificationCode as string)[],",
						"          educationOrganizationReference as (educationOrganizationId as integer, link as (rel as string, href as string)),",
						"          academicSubjectDescriptor as string,",
						"          careerPathwayDescriptor as string,",
						"          competencyLevels as (competencyLevelDescriptor as string)[],",
						"          courseDefinedByDescriptor as string,",
						"          courseDescription as string,",
						"          courseGPAApplicabilityDescriptor as string,",
						"          courseTitle as string,",
						"          dateCourseAdopted as date,",
						"          highSchoolCourseRequirement as boolean,",
						"          learningObjectives as (learningObjectiveReference as (learningObjectiveId as string, namespace as string, link as (rel as string, href as string)))[],",
						"          learningStandards as (learningStandardReference as (learningStandardId as string, link as (rel as string, href as string)))[],",
						"          levelCharacteristics as (courseLevelCharacteristicDescriptor as string)[],",
						"          maxCompletionsForCredit as integer,",
						"          maximumAvailableCreditConversion as float,",
						"          maximumAvailableCredits as float,",
						"          maximumAvailableCreditTypeDescriptor as string,",
						"          minimumAvailableCreditConversion as float,",
						"          minimumAvailableCredits as float,",
						"          minimumAvailableCreditTypeDescriptor as string,",
						"          numberOfParts as integer,",
						"          offeredGradeLevels as (gradeLevelDescriptor as string)[],",
						"          timeRequiredForCompletion as integer,",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          courseCode,",
						"          identificationCodes,",
						"          educationOrganizationId = educationOrganizationReference.educationOrganizationId,",
						"          academicSubjectDescriptor,",
						"          careerPathwayDescriptor,",
						"          competencyLevels,",
						"          courseDefinedByDescriptor,",
						"          courseDescription,",
						"          courseGPAApplicabilityDescriptor,",
						"          courseTitle,",
						"          dateCourseAdopted,",
						"          highSchoolCourseRequirement,",
						"          learningObjectives,",
						"          learningStandards,",
						"          levelCharacteristics,",
						"          maxCompletionsForCredit,",
						"          maximumAvailableCreditConversion,",
						"          maximumAvailableCredits,",
						"          maximumAvailableCreditTypeDescriptor,",
						"          minimumAvailableCreditConversion,",
						"          minimumAvailableCredits,",
						"          minimumAvailableCreditTypeDescriptor,",
						"          numberOfParts,",
						"          offeredGradeLevels,",
						"          timeRequiredForCompletion,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_credentials')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('credentials'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          credentialIdentifier as string,",
						"          stateOfIssueStateAbbreviationDescriptor as string,",
						"          academicSubjects as (academicSubjectDescriptor as string)[],",
						"          credentialFieldDescriptor as string,",
						"          credentialTypeDescriptor as string,",
						"          effectiveDate as date,",
						"          endorsements as (credentialEndorsement as string)[],",
						"          expirationDate as date,",
						"          gradeLevels as (gradeLevelDescriptor as string)[],",
						"          issuanceDate as date,",
						"          namespace as string,",
						"          teachingCredentialBasisDescriptor as string,",
						"          teachingCredentialDescriptor as string,",
						"          etag as string,",
						"          ext as (TPDM as (certificationRouteDescriptor as string, credentialStatusDescriptor as string, educatorRoleDescriptor as string, boardCertificationIndicator as boolean, certificationTitle as string, credentialStatusDate as date, personReference as (personId as string, sourceSystemDescriptor as string, link as (rel as string, href as string)), studentAcademicRecords as (studentAcademicRecordReference as (educationOrganizationId as integer, schoolYear as integer, studentUniqueId as string, termDescriptor as string, link as (rel as string, href as string)))[]))",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          credentialIdentifier,",
						"          stateOfIssueStateAbbreviationDescriptor,",
						"          academicSubjects,",
						"          credentialFieldDescriptor,",
						"          credentialTypeDescriptor,",
						"          effectiveDate,",
						"          endorsements,",
						"          expirationDate,",
						"          gradeLevels,",
						"          issuanceDate,",
						"          namespace,",
						"          teachingCredentialBasisDescriptor,",
						"          teachingCredentialDescriptor,",
						"          etag,",
						"          ext,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_disciplineActions')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('disciplineActions'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          disciplineActionIdentifier as string,",
						"          disciplineDate as date,",
						"          disciplines as (disciplineDescriptor as string)[],",
						"          studentDisciplineIncidentAssociations as (studentDisciplineIncidentAssociationReference as (incidentIdentifier as string, schoolId as integer, studentUniqueId as string, link as (rel as string, href as string)))[],",
						"          assignmentSchoolReference as (schoolId as integer, link as (rel as string, href as string)),",
						"          responsibilitySchoolReference as (schoolId as integer, link as (rel as string, href as string)),",
						"          studentReference as (studentUniqueId as string, link as (rel as string, href as string)),",
						"          actualDisciplineActionLength as float,",
						"          disciplineActionLength as float,",
						"          disciplineActionLengthDifferenceReasonDescriptor as string,",
						"          iepPlacementMeetingIndicator as boolean,",
						"          receivedEducationServicesDuringExpulsion as boolean,",
						"          relatedToZeroTolerancePolicy as boolean,",
						"          staffs as (staffReference as (staffUniqueId as string, link as (rel as string, href as string)))[],",
						"          studentDisciplineIncidentBehaviorAssociations as (studentDisciplineIncidentBehaviorAssociationReference as (behaviorDescriptor as string, incidentIdentifier as string, schoolId as integer, studentUniqueId as string, link as (rel as string, href as string)))[],",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          disciplineActionIdentifier,",
						"          disciplineDate,",
						"          disciplines,",
						"          studentDisciplineIncidentAssociations,",
						"          assignmentSchoolReference,",
						"          responsibilitySchoolReference,",
						"          studentUniqueId = studentReference.studentUniqueId,",
						"          actualDisciplineActionLength,",
						"          disciplineActionLength,",
						"          disciplineActionLengthDifferenceReasonDescriptor,",
						"          iepPlacementMeetingIndicator,",
						"          receivedEducationServicesDuringExpulsion,",
						"          relatedToZeroTolerancePolicy,",
						"          staffs,",
						"          studentDisciplineIncidentBehaviorAssociations,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_disciplineIncidents')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('disciplineIncidents'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          incidentIdentifier as string,",
						"          schoolReference as (schoolId as integer, link as (rel as string, href as string)),",
						"          staffReference as (staffUniqueId as string, link as (rel as string, href as string)),",
						"          behaviors as (behaviorDescriptor as string, behaviorDetailedDescription as string)[],",
						"          caseNumber as string,",
						"          externalParticipants as (disciplineIncidentParticipationCodeDescriptor as string, firstName as string, lastSurname as string)[],",
						"          incidentCost as float,",
						"          incidentDate as date,",
						"          incidentDescription as string,",
						"          incidentLocationDescriptor as string,",
						"          incidentTime as string,",
						"          reportedToLawEnforcement as boolean,",
						"          reporterDescriptionDescriptor as string,",
						"          reporterName as string,",
						"          weapons as (weaponDescriptor as string)[],",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          incidentIdentifier,",
						"          schoolId = schoolReference.schoolId,",
						"          staffUniqueId = staffReference.staffUniqueId,",
						"          behaviors,",
						"          caseNumber,",
						"          externalParticipants,",
						"          incidentCost,",
						"          incidentDate,",
						"          incidentDescription,",
						"          incidentLocationDescriptor,",
						"          incidentTime,",
						"          reportedToLawEnforcement,",
						"          reporterDescriptionDescriptor,",
						"          reporterName,",
						"          weapons,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_educationContents')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('educationContents'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          contentIdentifier as string,",
						"          learningStandardReference as (learningStandardId as string, link as (rel as string, href as string)),",
						"          additionalAuthorsIndicator as boolean,",
						"          appropriateGradeLevels as (gradeLevelDescriptor as string)[],",
						"          appropriateSexes as (sexDescriptor as string)[],",
						"          authors as (author as string)[],",
						"          contentClassDescriptor as string,",
						"          cost as float,",
						"          costRateDescriptor as string,",
						"          derivativeSourceEducationContents as (derivativeSourceEducationContentReference as (contentIdentifier as string, link as (rel as string, href as string)))[],",
						"          derivativeSourceLearningResourceMetadataURIs as (derivativeSourceLearningResourceMetadataURI as string)[],",
						"          derivativeSourceURIs as (derivativeSourceURI as string)[],",
						"          description as string,",
						"          interactivityStyleDescriptor as string,",
						"          languages as (languageDescriptor as string)[],",
						"          learningResourceMetadataURI as string,",
						"          namespace as string,",
						"          publicationDate as date,",
						"          publicationYear as integer,",
						"          publisher as string,",
						"          shortDescription as string,",
						"          timeRequired as string,",
						"          useRightsURL as string,",
						"          version as string,",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          contentIdentifier,",
						"          learningStandardId = learningStandardReference.learningStandardId,",
						"          additionalAuthorsIndicator,",
						"          appropriateGradeLevels,",
						"          appropriateSexes,",
						"          authors,",
						"          contentClassDescriptor,",
						"          cost,",
						"          costRateDescriptor,",
						"          derivativeSourceEducationContents,",
						"          derivativeSourceLearningResourceMetadataURIs,",
						"          derivativeSourceURIs,",
						"          description,",
						"          interactivityStyleDescriptor,",
						"          languages,",
						"          learningResourceMetadataURI,",
						"          namespace,",
						"          publicationDate,",
						"          publicationYear,",
						"          publisher,",
						"          shortDescription,",
						"          timeRequired,",
						"          useRightsURL,",
						"          version,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_educationOrganizationInterventionPrescriptionAssociations')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('educationOrganizationInterventionPrescriptionAssociations'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          educationOrganizationReference as (educationOrganizationId as integer, link as (rel as string, href as string)),",
						"          interventionPrescriptionReference as (educationOrganizationId as integer, interventionPrescriptionIdentificationCode as string, link as (rel as string, href as string)),",
						"          beginDate as date,",
						"          endDate as date,",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          educationOrganizationId = educationOrganizationReference.educationOrganizationId,",
						"          interventionPrescriptionIdentificationCode = interventionPrescriptionReference.interventionPrescriptionIdentificationCode,",
						"          beginDate,",
						"          endDate,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_educationOrganizationNetworkAssociations')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('educationOrganizationNetworkAssociations'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          educationOrganizationNetworkReference as (educationOrganizationNetworkId as integer, link as (rel as string, href as string)),",
						"          memberEducationOrganizationReference as (educationOrganizationId as integer, link as (rel as string, href as string)),",
						"          beginDate as date,",
						"          endDate as date,",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          educationOrganizationNetworkId = educationOrganizationNetworkReference.educationOrganizationNetworkId,",
						"          educationOrganizationId = memberEducationOrganizationReference.educationOrganizationId,",
						"          beginDate,",
						"          endDate,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_educationOrganizationNetworks')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('educationOrganizationNetworks'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          categories as (educationOrganizationCategoryDescriptor as string)[],",
						"          educationOrganizationNetworkId as integer,",
						"          addresses as (addressTypeDescriptor as string, stateAbbreviationDescriptor as string, city as string, postalCode as string, streetNumberName as string, localeDescriptor as string, apartmentRoomSuiteNumber as string, buildingSiteNumber as string, congressionalDistrict as string, countyFIPSCode as string, doNotPublishIndicator as boolean, latitude as string, longitude as string, nameOfCounty as string, periods as (beginDate as date, endDate as date)[])[],",
						"          identificationCodes as (educationOrganizationIdentificationSystemDescriptor as string, identificationCode as string)[],",
						"          indicators as (indicatorDescriptor as string, indicatorGroupDescriptor as string, indicatorLevelDescriptor as string, designatedBy as string, indicatorValue as string, periods as (beginDate as date, endDate as date)[])[],",
						"          institutionTelephones as (institutionTelephoneNumberTypeDescriptor as string, telephoneNumber as string)[],",
						"          internationalAddresses as (addressTypeDescriptor as string, countryDescriptor as string, addressLine1 as string, addressLine2 as string, addressLine3 as string, addressLine4 as string, beginDate as date, endDate as date, latitude as string, longitude as string)[],",
						"          nameOfInstitution as string,",
						"          networkPurposeDescriptor as string,",
						"          operationalStatusDescriptor as string,",
						"          shortNameOfInstitution as string,",
						"          webSite as string,",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          categories,",
						"          educationOrganizationNetworkId,",
						"          addresses,",
						"          identificationCodes,",
						"          indicators,",
						"          institutionTelephones,",
						"          internationalAddresses,",
						"          nameOfInstitution,",
						"          networkPurposeDescriptor,",
						"          operationalStatusDescriptor,",
						"          shortNameOfInstitution,",
						"          webSite,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_educationOrganizationPeerAssociations')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('educationOrganizationPeerAssociations'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          educationOrganizationReference as (educationOrganizationId as integer, link as (rel as string, href as string)),",
						"          peerEducationOrganizationReference as (educationOrganizationId as integer, link as (rel as string, href as string)),",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          educationOrganizationReference,",
						"          peerEducationOrganizationReference,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_educationServiceCenters')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('educationServiceCenters'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          categories as (educationOrganizationCategoryDescriptor as string)[],",
						"          educationServiceCenterId as integer,",
						"          stateEducationAgencyReference as (stateEducationAgencyId as integer, link as (rel as string, href as string)),",
						"          addresses as (addressTypeDescriptor as string, stateAbbreviationDescriptor as string, city as string, postalCode as string, streetNumberName as string, localeDescriptor as string, apartmentRoomSuiteNumber as string, buildingSiteNumber as string, congressionalDistrict as string, countyFIPSCode as string, doNotPublishIndicator as boolean, latitude as string, longitude as string, nameOfCounty as string, periods as (beginDate as date, endDate as date)[])[],",
						"          identificationCodes as (educationOrganizationIdentificationSystemDescriptor as string, identificationCode as string)[],",
						"          indicators as (indicatorDescriptor as string, indicatorGroupDescriptor as string, indicatorLevelDescriptor as string, designatedBy as string, indicatorValue as string, periods as (beginDate as date, endDate as date)[])[],",
						"          institutionTelephones as (institutionTelephoneNumberTypeDescriptor as string, telephoneNumber as string)[],",
						"          internationalAddresses as (addressTypeDescriptor as string, countryDescriptor as string, addressLine1 as string, addressLine2 as string, addressLine3 as string, addressLine4 as string, beginDate as date, endDate as date, latitude as string, longitude as string)[],",
						"          nameOfInstitution as string,",
						"          operationalStatusDescriptor as string,",
						"          shortNameOfInstitution as string,",
						"          webSite as string,",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          categories,",
						"          educationServiceCenterId,",
						"          stateEducationAgencyId = stateEducationAgencyReference.stateEducationAgencyId,",
						"          addresses,",
						"          identificationCodes,",
						"          indicators,",
						"          institutionTelephones,",
						"          internationalAddresses,",
						"          nameOfInstitution,",
						"          operationalStatusDescriptor,",
						"          shortNameOfInstitution,",
						"          webSite,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_educatorPreparationPrograms')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('educatorPreparationPrograms'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          programName as string,",
						"          programTypeDescriptor as string,",
						"          educationOrganizationReference as (educationOrganizationId as integer, link as (rel as string, href as string)),",
						"          accreditationStatusDescriptor as string,",
						"          gradeLevels as (gradeLevelDescriptor as string)[],",
						"          programId as string,",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          programName,",
						"          programTypeDescriptor,",
						"          educationOrganizationReference,",
						"          accreditationStatusDescriptor,",
						"          gradeLevels,",
						"          programId,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_evaluationElementRatings')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('evaluationElementRatings'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          evaluationElementReference as (educationOrganizationId as integer, evaluationElementTitle as string, evaluationObjectiveTitle as string, evaluationPeriodDescriptor as string, evaluationTitle as string, performanceEvaluationTitle as string, performanceEvaluationTypeDescriptor as string, schoolYear as integer, termDescriptor as string, link as (rel as string, href as string)),",
						"          evaluationObjectiveRatingReference as (educationOrganizationId as integer, evaluationDate as timestamp, evaluationObjectiveTitle as string, evaluationPeriodDescriptor as string, evaluationTitle as string, performanceEvaluationTitle as string, performanceEvaluationTypeDescriptor as string, personId as string, schoolYear as integer, sourceSystemDescriptor as string, termDescriptor as string, link as (rel as string, href as string)),",
						"          areaOfRefinement as string,",
						"          areaOfReinforcement as string,",
						"          comments as string,",
						"          evaluationElementRatingLevelDescriptor as string,",
						"          feedback as string,",
						"          results as (rating as float, ratingResultTitle as string, resultDatatypeTypeDescriptor as string)[],",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          evaluationElementReference,",
						"          evaluationObjectiveRatingReference,",
						"          areaOfRefinement,",
						"          areaOfReinforcement,",
						"          comments,",
						"          evaluationElementRatingLevelDescriptor,",
						"          feedback,",
						"          results,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_evaluationElements')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('evaluationElements'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          evaluationElementTitle as string,",
						"          evaluationObjectiveReference as (educationOrganizationId as integer, evaluationObjectiveTitle as string, evaluationPeriodDescriptor as string, evaluationTitle as string, performanceEvaluationTitle as string, performanceEvaluationTypeDescriptor as string, schoolYear as integer, termDescriptor as string, link as (rel as string, href as string)),",
						"          evaluationTypeDescriptor as string,",
						"          maxRating as float,",
						"          minRating as float,",
						"          ratingLevels as (evaluationRatingLevelDescriptor as string, maxRating as float, minRating as float)[],",
						"          sortOrder as integer,",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          evaluationElementTitle,",
						"          evaluationObjectiveReference,",
						"          evaluationTypeDescriptor,",
						"          maxRating,",
						"          minRating,",
						"          ratingLevels,",
						"          sortOrder,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_evaluationObjectiveRatings')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('evaluationObjectiveRatings'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          evaluationObjectiveReference as (educationOrganizationId as integer, evaluationObjectiveTitle as string, evaluationPeriodDescriptor as string, evaluationTitle as string, performanceEvaluationTitle as string, performanceEvaluationTypeDescriptor as string, schoolYear as integer, termDescriptor as string, link as (rel as string, href as string)),",
						"          evaluationRatingReference as (educationOrganizationId as integer, evaluationDate as timestamp, evaluationPeriodDescriptor as string, evaluationTitle as string, performanceEvaluationTitle as string, performanceEvaluationTypeDescriptor as string, personId as string, schoolYear as integer, sourceSystemDescriptor as string, termDescriptor as string, link as (rel as string, href as string)),",
						"          comments as string,",
						"          objectiveRatingLevelDescriptor as string,",
						"          results as (rating as float, ratingResultTitle as string, resultDatatypeTypeDescriptor as string)[],",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          evaluationObjectiveReference,",
						"          evaluationRatingReference,",
						"          comments,",
						"          objectiveRatingLevelDescriptor,",
						"          results,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_evaluationObjectives')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('evaluationObjectives'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          evaluationObjectiveTitle as string,",
						"          evaluationReference as (educationOrganizationId as integer, evaluationPeriodDescriptor as string, evaluationTitle as string, performanceEvaluationTitle as string, performanceEvaluationTypeDescriptor as string, schoolYear as integer, termDescriptor as string, link as (rel as string, href as string)),",
						"          evaluationObjectiveDescription as string,",
						"          evaluationTypeDescriptor as string,",
						"          maxRating as float,",
						"          minRating as float,",
						"          ratingLevels as (evaluationRatingLevelDescriptor as string, maxRating as float, minRating as float)[],",
						"          sortOrder as integer,",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          evaluationObjectiveTitle,",
						"          evaluationReference,",
						"          evaluationObjectiveDescription,",
						"          evaluationTypeDescriptor,",
						"          maxRating,",
						"          minRating,",
						"          ratingLevels,",
						"          sortOrder,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_evaluationRatings')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('evaluationRatings'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          evaluationDate as timestamp,",
						"          evaluationReference as (educationOrganizationId as integer, evaluationPeriodDescriptor as string, evaluationTitle as string, performanceEvaluationTitle as string, performanceEvaluationTypeDescriptor as string, schoolYear as integer, termDescriptor as string, link as (rel as string, href as string)),",
						"          performanceEvaluationRatingReference as (educationOrganizationId as integer, evaluationPeriodDescriptor as string, performanceEvaluationTitle as string, performanceEvaluationTypeDescriptor as string, personId as string, schoolYear as integer, sourceSystemDescriptor as string, termDescriptor as string, link as (rel as string, href as string)),",
						"          sectionReference as (localCourseCode as string, schoolId as integer, schoolYear as integer, sectionIdentifier as string, sessionName as string, link as (rel as string, href as string)),",
						"          evaluationRatingLevelDescriptor as string,",
						"          evaluationRatingStatusDescriptor as string,",
						"          results as (rating as float, ratingResultTitle as string, resultDatatypeTypeDescriptor as string)[],",
						"          reviewers as (firstName as string, lastSurname as string, reviewerPersonReference as (personId as string, sourceSystemDescriptor as string, link as (rel as string, href as string)), receivedTraining as (interRaterReliabilityScore as integer, receivedTrainingDate as date))[],",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          evaluationDate,",
						"          evaluationReference,",
						"          performanceEvaluationRatingReference,",
						"          sectionReference,",
						"          evaluationRatingLevelDescriptor,",
						"          evaluationRatingStatusDescriptor,",
						"          results,",
						"          reviewers,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_evaluations')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('evaluations'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          evaluationTitle as string,",
						"          performanceEvaluationReference as (educationOrganizationId as integer, evaluationPeriodDescriptor as string, performanceEvaluationTitle as string, performanceEvaluationTypeDescriptor as string, schoolYear as integer, termDescriptor as string, link as (rel as string, href as string)),",
						"          evaluationDescription as string,",
						"          evaluationTypeDescriptor as string,",
						"          interRaterReliabilityScore as integer,",
						"          maxRating as float,",
						"          minRating as float,",
						"          ratingLevels as (evaluationRatingLevelDescriptor as string, maxRating as float, minRating as float)[],",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          evaluationTitle,",
						"          performanceEvaluationReference,",
						"          evaluationDescription,",
						"          evaluationTypeDescriptor,",
						"          interRaterReliabilityScore,",
						"          maxRating,",
						"          minRating,",
						"          ratingLevels,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_feederSchoolAssociations')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('feederSchoolAssociations'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          beginDate as date,",
						"          feederSchoolReference as (schoolId as integer, link as (rel as string, href as string)),",
						"          schoolReference as (schoolId as integer, link as (rel as string, href as string)),",
						"          endDate as date,",
						"          feederRelationshipDescription as string,",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          beginDate,",
						"          feederSchoolReference,",
						"          schoolReference,",
						"          endDate,",
						"          feederRelationshipDescription,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_financialAids')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('financialAids'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          aidTypeDescriptor as string,",
						"          beginDate as date,",
						"          studentReference as (studentUniqueId as string, link as (rel as string, href as string)),",
						"          aidAmount as float,",
						"          aidConditionDescription as string,",
						"          endDate as date,",
						"          pellGrantRecipient as boolean,",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          aidTypeDescriptor,",
						"          beginDate,",
						"          studentReference,",
						"          aidAmount,",
						"          aidConditionDescription,",
						"          endDate,",
						"          pellGrantRecipient,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_gradebookEntries')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('gradebookEntries'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          dateAssigned as date,",
						"          gradebookEntryTitle as string,",
						"          gradingPeriodReference as (gradingPeriodDescriptor as string, periodSequence as integer, schoolId as integer, schoolYear as integer, link as (rel as string, href as string)),",
						"          sectionReference as (localCourseCode as string, schoolId as integer, schoolYear as integer, sectionIdentifier as string, sessionName as string, link as (rel as string, href as string)),",
						"          description as string,",
						"          dueDate as date,",
						"          gradebookEntryTypeDescriptor as string,",
						"          learningObjectives as (learningObjectiveReference as (learningObjectiveId as string, namespace as string, link as (rel as string, href as string)))[],",
						"          learningStandards as (learningStandardReference as (learningStandardId as string, link as (rel as string, href as string)))[],",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          dateAssigned,",
						"          gradebookEntryTitle,",
						"          gradingPeriodDescriptor = gradingPeriodReference.gradingPeriodDescriptor,",
						"          periodSequence = gradingPeriodReference.periodSequence,",
						"          schoolId = gradingPeriodReference.schoolId,",
						"          schoolYear = gradingPeriodReference.schoolYear,",
						"          sessionName = sectionReference.sessionName,",
						"          sectionIdentifier = sectionReference.sectionIdentifier,",
						"          localCourseCode = sectionReference.localCourseCode,",
						"          description,",
						"          dueDate,",
						"          gradebookEntryTypeDescriptor,",
						"          learningObjectives,",
						"          learningStandards,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_grades')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('grades'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          gradeTypeDescriptor as string,",
						"          gradingPeriodReference as (gradingPeriodDescriptor as string, periodSequence as integer, schoolId as integer, schoolYear as integer, link as (rel as string, href as string)),",
						"          studentSectionAssociationReference as (beginDate as date, localCourseCode as string, schoolId as integer, schoolYear as integer, sectionIdentifier as string, sessionName as string, studentUniqueId as string, link as (rel as string, href as string)),",
						"          diagnosticStatement as string,",
						"          learningStandardGrades as (performanceBaseConversionDescriptor as string, diagnosticStatement as string, letterGradeEarned as string, numericGradeEarned as float, learningStandardReference as (learningStandardId as string, link as (rel as string, href as string)))[],",
						"          letterGradeEarned as string,",
						"          numericGradeEarned as float,",
						"          performanceBaseConversionDescriptor as string,",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          gradeTypeDescriptor,",
						"          gradingPeriodDescriptor = gradingPeriodReference.gradingPeriodDescriptor,",
						"          periodSequence = gradingPeriodReference.periodSequence,",
						"          schoolId = gradingPeriodReference.schoolId,",
						"          schoolYear = gradingPeriodReference.schoolYear,",
						"          studentUniqueId = studentSectionAssociationReference.studentUniqueId,",
						"          sessionName = studentSectionAssociationReference.sessionName,",
						"          sectionIdentifier = studentSectionAssociationReference.sectionIdentifier,",
						"          localCourseCode = studentSectionAssociationReference.localCourseCode,",
						"          beginDate = studentSectionAssociationReference.beginDate,",
						"          diagnosticStatement,",
						"          learningStandardGrades,",
						"          letterGradeEarned,",
						"          numericGradeEarned,",
						"          performanceBaseConversionDescriptor,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_gradingPeriods')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('gradingPeriods'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          gradingPeriodDescriptor as string,",
						"          periodSequence as integer,",
						"          schoolReference as (schoolId as integer, link as (rel as string, href as string)),",
						"          schoolYearTypeReference as (schoolYear as integer, link as (rel as string, href as string)),",
						"          beginDate as date,",
						"          endDate as date,",
						"          totalInstructionalDays as integer,",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          gradingPeriodDescriptor,",
						"          periodSequence,",
						"          schoolId = schoolReference.schoolId,",
						"          SchoolYear = schoolYearTypeReference.SchoolYear,",
						"          beginDate,",
						"          endDate,",
						"          totalInstructionalDays,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_graduationPlans')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('graduationPlans'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          graduationPlanTypeDescriptor as string,",
						"          educationOrganizationReference as (educationOrganizationId as integer, link as (rel as string, href as string)),",
						"          graduationSchoolYearTypeReference as (schoolYear as integer, link as (rel as string, href as string)),",
						"          creditsByCourses as (courseSetName as string, creditTypeDescriptor as string, whenTakenGradeLevelDescriptor as string, creditConversion as float, credits as float, courses as (courseReference as (courseCode as string, educationOrganizationId as integer, link as (rel as string, href as string)))[])[],",
						"          creditsByCreditCategories as (creditCategoryDescriptor as string, creditTypeDescriptor as string, creditConversion as float, credits as float)[],",
						"          creditsBySubjects as (academicSubjectDescriptor as string, creditTypeDescriptor as string, creditConversion as float, credits as float)[],",
						"          individualPlan as boolean,",
						"          requiredAssessments as (assessmentReference as (assessmentIdentifier as string, namespace as string, link as (rel as string, href as string)), scores as (assessmentReportingMethodDescriptor as string, resultDatatypeTypeDescriptor as string, maximumScore as string, minimumScore as string)[], performanceLevel as (assessmentReportingMethodDescriptor as string, performanceLevelDescriptor as string, resultDatatypeTypeDescriptor as string, maximumScore as string, minimumScore as string))[],",
						"          totalRequiredCreditConversion as float,",
						"          totalRequiredCredits as float,",
						"          totalRequiredCreditTypeDescriptor as string,",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          graduationPlanTypeDescriptor,",
						"          educationOrganizationId = educationOrganizationReference.educationOrganizationId,",
						"          schoolYear = graduationSchoolYearTypeReference.schoolYear,",
						"          creditsByCourses,",
						"          creditsByCreditCategories,",
						"          creditsBySubjects,",
						"          individualPlan,",
						"          requiredAssessments,",
						"          totalRequiredCreditConversion,",
						"          totalRequiredCredits,",
						"          totalRequiredCreditTypeDescriptor,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_interventionPrescriptions')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('interventionPrescriptions'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          interventionPrescriptionIdentificationCode as string,",
						"          educationOrganizationReference as (educationOrganizationId as integer, link as (rel as string, href as string)),",
						"          appropriateGradeLevels as (gradeLevelDescriptor as string)[],",
						"          appropriateSexes as (sexDescriptor as string)[],",
						"          deliveryMethodDescriptor as string,",
						"          diagnoses as (diagnosisDescriptor as string)[],",
						"          educationContents as (educationContentReference as (contentIdentifier as string, link as (rel as string, href as string)))[],",
						"          interventionClassDescriptor as string,",
						"          learningResourceMetadataURIs as (learningResourceMetadataURI as string)[],",
						"          maxDosage as integer,",
						"          minDosage as integer,",
						"          populationServeds as (populationServedDescriptor as string)[],",
						"          uris as (uri as string)[],",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          interventionPrescriptionIdentificationCode,",
						"          educationOrganizationId = educationOrganizationReference.educationOrganizationId,",
						"          appropriateGradeLevels,",
						"          appropriateSexes,",
						"          deliveryMethodDescriptor,",
						"          diagnoses,",
						"          educationContents,",
						"          interventionClassDescriptor,",
						"          learningResourceMetadataURIs,",
						"          maxDosage,",
						"          minDosage,",
						"          populationServeds,",
						"          uris,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_interventionStudies')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('interventionStudies'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          interventionStudyIdentificationCode as string,",
						"          educationOrganizationReference as (educationOrganizationId as integer, link as (rel as string, href as string)),",
						"          interventionPrescriptionReference as (educationOrganizationId as integer, interventionPrescriptionIdentificationCode as string, link as (rel as string, href as string)),",
						"          appropriateGradeLevels as (gradeLevelDescriptor as string)[],",
						"          appropriateSexes as (sexDescriptor as string)[],",
						"          deliveryMethodDescriptor as string,",
						"          educationContents as (educationContentReference as (contentIdentifier as string, link as (rel as string, href as string)))[],",
						"          interventionClassDescriptor as string,",
						"          interventionEffectivenesses as (diagnosisDescriptor as string, gradeLevelDescriptor as string, populationServedDescriptor as string, interventionEffectivenessRatingDescriptor as string, improvementIndex as integer)[],",
						"          learningResourceMetadataURIs as (learningResourceMetadataURI as string)[],",
						"          participants as integer,",
						"          populationServeds as (populationServedDescriptor as string)[],",
						"          stateAbbreviations as (stateAbbreviationDescriptor as string)[],",
						"          uris as (uri as string)[],",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          interventionStudyIdentificationCode,",
						"          educationOrganizationId = educationOrganizationReference.educationOrganizationId,",
						"          interventionPrescriptionIdentificationCode = interventionPrescriptionReference.interventionPrescriptionIdentificationCode,",
						"          appropriateGradeLevels,",
						"          appropriateSexes,",
						"          deliveryMethodDescriptor,",
						"          educationContents,",
						"          interventionClassDescriptor,",
						"          interventionEffectivenesses,",
						"          learningResourceMetadataURIs,",
						"          participants,",
						"          populationServeds,",
						"          stateAbbreviations,",
						"          uris,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_interventions')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('interventions'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          interventionIdentificationCode as string,",
						"          educationOrganizationReference as (educationOrganizationId as integer, link as (rel as string, href as string)),",
						"          appropriateGradeLevels as (gradeLevelDescriptor as string)[],",
						"          appropriateSexes as (sexDescriptor as string)[],",
						"          beginDate as date,",
						"          deliveryMethodDescriptor as string,",
						"          diagnoses as (diagnosisDescriptor as string)[],",
						"          educationContents as (educationContentReference as (contentIdentifier as string, link as (rel as string, href as string)))[],",
						"          endDate as date,",
						"          interventionClassDescriptor as string,",
						"          interventionPrescriptions as (interventionPrescriptionReference as (educationOrganizationId as integer, interventionPrescriptionIdentificationCode as string, link as (rel as string, href as string)))[],",
						"          learningResourceMetadataURIs as (learningResourceMetadataURI as string)[],",
						"          maxDosage as integer,",
						"          meetingTimes as (endTime as string, startTime as string)[],",
						"          minDosage as integer,",
						"          populationServeds as (populationServedDescriptor as string)[],",
						"          staffs as (staffReference as (staffUniqueId as string, link as (rel as string, href as string)))[],",
						"          uris as (uri as string)[],",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          interventionIdentificationCode,",
						"          educationOrganizationId = educationOrganizationReference.educationOrganizationId,",
						"          appropriateGradeLevels,",
						"          appropriateSexes,",
						"          beginDate,",
						"          deliveryMethodDescriptor,",
						"          diagnoses,",
						"          educationContents,",
						"          endDate,",
						"          interventionClassDescriptor,",
						"          interventionPrescriptions,",
						"          learningResourceMetadataURIs,",
						"          maxDosage,",
						"          meetingTimes,",
						"          minDosage,",
						"          populationServeds,",
						"          staffs,",
						"          uris,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_learningObjectives')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('learningObjectives'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          academicSubjects as (academicSubjectDescriptor as string)[],",
						"          learningObjectiveId as string,",
						"          namespace as string,",
						"          parentLearningObjectiveReference as (learningObjectiveId as string, namespace as string, link as (rel as string, href as string)),",
						"          contentStandard as (publicationStatusDescriptor as string, beginDate as date, endDate as date, publicationDate as date, publicationYear as integer, title as string, uri as string, version as string, mandatingEducationOrganizationReference as (educationOrganizationId as integer, link as (rel as string, href as string)), authors as (author as string)[]),",
						"          description as string,",
						"          gradeLevels as (gradeLevelDescriptor as string)[],",
						"          learningStandards as (learningStandardReference as (learningStandardId as string, link as (rel as string, href as string)))[],",
						"          nomenclature as string,",
						"          objective as string,",
						"          successCriteria as string,",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          academicSubjects,",
						"          learningObjectiveId,",
						"          namespace,",
						"          parentLearningObjectiveReference,",
						"          contentStandard,",
						"          description,",
						"          gradeLevels,",
						"          learningStandards,",
						"          nomenclature,",
						"          objective,",
						"          successCriteria,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_learningStandardEquivalenceAssociations')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('learningStandardEquivalenceAssociations'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          namespace as string,",
						"          sourceLearningStandardReference as (learningStandardId as string, link as (rel as string, href as string)),",
						"          targetLearningStandardReference as (learningStandardId as string, link as (rel as string, href as string)),",
						"          effectiveDate as date,",
						"          learningStandardEquivalenceStrengthDescription as string,",
						"          learningStandardEquivalenceStrengthDescriptor as string,",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          namespace,",
						"          sourceLearningStandardReference,",
						"          targetLearningStandardReference,",
						"          effectiveDate,",
						"          learningStandardEquivalenceStrengthDescription,",
						"          learningStandardEquivalenceStrengthDescriptor,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_learningStandards')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('learningStandards'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          academicSubjects as (academicSubjectDescriptor as string)[],",
						"          gradeLevels as (gradeLevelDescriptor as string)[],",
						"          learningStandardId as string,",
						"          parentLearningStandardReference as (learningStandardId as string, link as (rel as string, href as string)),",
						"          contentStandard as (publicationStatusDescriptor as string, beginDate as date, endDate as date, publicationDate as date, publicationYear as integer, title as string, uri as string, version as string, mandatingEducationOrganizationReference as (educationOrganizationId as integer, link as (rel as string, href as string)), authors as (author as string)[]),",
						"          courseTitle as string,",
						"          description as string,",
						"          identificationCodes as (contentStandardName as string, identificationCode as string)[],",
						"          learningStandardCategoryDescriptor as string,",
						"          learningStandardItemCode as string,",
						"          learningStandardScopeDescriptor as string,",
						"          namespace as string,",
						"          prerequisiteLearningStandards as (prerequisiteLearningStandardReference as (learningStandardId as string, link as (rel as string, href as string)))[],",
						"          successCriteria as string,",
						"          uri as string,",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          academicSubjects,",
						"          gradeLevels,",
						"          learningStandardId,",
						"          parentLearningStandardReference,",
						"          contentStandard,",
						"          courseTitle,",
						"          description,",
						"          identificationCodes,",
						"          learningStandardCategoryDescriptor,",
						"          learningStandardItemCode,",
						"          learningStandardScopeDescriptor,",
						"          namespace,",
						"          prerequisiteLearningStandards,",
						"          successCriteria,",
						"          uri,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_localEducationAgencies')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('localEducationAgencies'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          categories as (educationOrganizationCategoryDescriptor as string)[],",
						"          localEducationAgencyId as integer,",
						"          educationServiceCenterReference as (educationServiceCenterId as integer, link as (rel as string, href as string)),",
						"          parentLocalEducationAgencyReference as (localEducationAgencyId as integer, link as (rel as string, href as string)),",
						"          stateEducationAgencyReference as (stateEducationAgencyId as integer, link as (rel as string, href as string)),",
						"          accountabilities as (gunFreeSchoolsActReportingStatusDescriptor as string, schoolChoiceImplementStatusDescriptor as string, schoolYearTypeReference as (schoolYear as integer, link as (rel as string, href as string)))[],",
						"          addresses as (addressTypeDescriptor as string, stateAbbreviationDescriptor as string, city as string, postalCode as string, streetNumberName as string, localeDescriptor as string, apartmentRoomSuiteNumber as string, buildingSiteNumber as string, congressionalDistrict as string, countyFIPSCode as string, doNotPublishIndicator as boolean, latitude as string, longitude as string, nameOfCounty as string, periods as (beginDate as date, endDate as date)[])[],",
						"          charterStatusDescriptor as string,",
						"          federalFunds as (fiscalYear as integer, innovativeDollarsSpent as float, innovativeDollarsSpentStrategicPriorities as float, innovativeProgramsFundsReceived as float, schoolImprovementAllocation as float, schoolImprovementReservedFundsPercentage as float, stateAssessmentAdministrationFunding as float, supplementalEducationalServicesFundsSpent as float, supplementalEducationalServicesPerPupilExpenditure as float)[],",
						"          identificationCodes as (educationOrganizationIdentificationSystemDescriptor as string, identificationCode as string)[],",
						"          indicators as (indicatorDescriptor as string, indicatorGroupDescriptor as string, indicatorLevelDescriptor as string, designatedBy as string, indicatorValue as string, periods as (beginDate as date, endDate as date)[])[],",
						"          institutionTelephones as (institutionTelephoneNumberTypeDescriptor as string, telephoneNumber as string)[],",
						"          internationalAddresses as (addressTypeDescriptor as string, countryDescriptor as string, addressLine1 as string, addressLine2 as string, addressLine3 as string, addressLine4 as string, beginDate as date, endDate as date, latitude as string, longitude as string)[],",
						"          localEducationAgencyCategoryDescriptor as string,",
						"          nameOfInstitution as string,",
						"          operationalStatusDescriptor as string,",
						"          shortNameOfInstitution as string,",
						"          webSite as string,",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          categories,",
						"          localEducationAgencyId,",
						"          educationServiceCenterReference,",
						"          parentLocalEducationAgencyReference,",
						"          stateEducationAgencyId = stateEducationAgencyReference.stateEducationAgencyId,",
						"          accountabilities,",
						"          addresses,",
						"          charterStatusDescriptor,",
						"          federalFunds,",
						"          identificationCodes,",
						"          indicators,",
						"          institutionTelephones,",
						"          internationalAddresses,",
						"          localEducationAgencyCategoryDescriptor,",
						"          nameOfInstitution,",
						"          operationalStatusDescriptor,",
						"          shortNameOfInstitution,",
						"          webSite,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_locations')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('locations'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          classroomIdentificationCode as string,",
						"          schoolReference as (schoolId as integer, link as (rel as string, href as string)),",
						"          maximumNumberOfSeats as integer,",
						"          optimalNumberOfSeats as integer,",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          classroomIdentificationCode,",
						"          schoolId = schoolReference.schoolId,",
						"          maximumNumberOfSeats,",
						"          optimalNumberOfSeats,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_objectiveAssessments')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('objectiveAssessments'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          identificationCode as string,",
						"          assessmentReference as (assessmentIdentifier as string, namespace as string, link as (rel as string, href as string)),",
						"          parentObjectiveAssessmentReference as (assessmentIdentifier as string, identificationCode as string, namespace as string, link as (rel as string, href as string)),",
						"          academicSubjectDescriptor as string,",
						"          assessmentItems as (assessmentItemReference as (assessmentIdentifier as string, identificationCode as string, namespace as string, link as (rel as string, href as string)))[],",
						"          description as string,",
						"          learningObjectives as (learningObjectiveReference as (learningObjectiveId as string, namespace as string, link as (rel as string, href as string)))[],",
						"          learningStandards as (learningStandardReference as (learningStandardId as string, link as (rel as string, href as string)))[],",
						"          maxRawScore as float,",
						"          nomenclature as string,",
						"          percentOfAssessment as float,",
						"          performanceLevels as (assessmentReportingMethodDescriptor as string, performanceLevelDescriptor as string, resultDatatypeTypeDescriptor as string, maximumScore as string, minimumScore as string)[],",
						"          scores as (assessmentReportingMethodDescriptor as string, resultDatatypeTypeDescriptor as string, maximumScore as string, minimumScore as string)[],",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          identificationCode,",
						"          assessmentIdentifier = assessmentReference.assessmentIdentifier,",
						"          namespace = assessmentReference.namespace,",
						"          parentObjectiveAssessmentReference,",
						"          academicSubjectDescriptor,",
						"          assessmentItems,",
						"          description,",
						"          learningObjectives,",
						"          learningStandards,",
						"          maxRawScore,",
						"          nomenclature,",
						"          percentOfAssessment,",
						"          performanceLevels,",
						"          scores,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_openStaffPositions')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('openStaffPositions'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          requisitionNumber as string,",
						"          educationOrganizationReference as (educationOrganizationId as integer, link as (rel as string, href as string)),",
						"          academicSubjects as (academicSubjectDescriptor as string)[],",
						"          datePosted as date,",
						"          datePostingRemoved as date,",
						"          employmentStatusDescriptor as string,",
						"          instructionalGradeLevels as (gradeLevelDescriptor as string)[],",
						"          positionTitle as string,",
						"          postingResultDescriptor as string,",
						"          programAssignmentDescriptor as string,",
						"          staffClassificationDescriptor as string,",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          requisitionNumber,",
						"          educationOrganizationId = educationOrganizationReference.educationOrganizationId,",
						"          academicSubjects,",
						"          datePosted,",
						"          datePostingRemoved,",
						"          employmentStatusDescriptor,",
						"          instructionalGradeLevels,",
						"          positionTitle,",
						"          postingResultDescriptor,",
						"          programAssignmentDescriptor,",
						"          staffClassificationDescriptor,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_organizationDepartments')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('organizationDepartments'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          categories as (educationOrganizationCategoryDescriptor as string)[],",
						"          organizationDepartmentId as integer,",
						"          parentEducationOrganizationReference as (educationOrganizationId as integer, link as (rel as string, href as string)),",
						"          academicSubjectDescriptor as string,",
						"          addresses as (addressTypeDescriptor as string, stateAbbreviationDescriptor as string, city as string, postalCode as string, streetNumberName as string, localeDescriptor as string, apartmentRoomSuiteNumber as string, buildingSiteNumber as string, congressionalDistrict as string, countyFIPSCode as string, doNotPublishIndicator as boolean, latitude as string, longitude as string, nameOfCounty as string, periods as (beginDate as date, endDate as date)[])[],",
						"          identificationCodes as (educationOrganizationIdentificationSystemDescriptor as string, identificationCode as string)[],",
						"          indicators as (indicatorDescriptor as string, indicatorGroupDescriptor as string, indicatorLevelDescriptor as string, designatedBy as string, indicatorValue as string, periods as (beginDate as date, endDate as date)[])[],",
						"          institutionTelephones as (institutionTelephoneNumberTypeDescriptor as string, telephoneNumber as string)[],",
						"          internationalAddresses as (addressTypeDescriptor as string, countryDescriptor as string, addressLine1 as string, addressLine2 as string, addressLine3 as string, addressLine4 as string, beginDate as date, endDate as date, latitude as string, longitude as string)[],",
						"          nameOfInstitution as string,",
						"          operationalStatusDescriptor as string,",
						"          shortNameOfInstitution as string,",
						"          webSite as string,",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          categories,",
						"          organizationDepartmentId,",
						"          educationOrganizationId = parentEducationOrganizationReference.educationOrganizationId,",
						"          academicSubjectDescriptor,",
						"          addresses,",
						"          identificationCodes,",
						"          indicators,",
						"          institutionTelephones,",
						"          internationalAddresses,",
						"          nameOfInstitution,",
						"          operationalStatusDescriptor,",
						"          shortNameOfInstitution,",
						"          webSite,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_parents')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('parents'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          parentUniqueId as string,",
						"          personReference as (personId as string, sourceSystemDescriptor as string, link as (rel as string, href as string)),",
						"          addresses as (addressTypeDescriptor as string, stateAbbreviationDescriptor as string, city as string, postalCode as string, streetNumberName as string, localeDescriptor as string, apartmentRoomSuiteNumber as string, buildingSiteNumber as string, congressionalDistrict as string, countyFIPSCode as string, doNotPublishIndicator as boolean, latitude as string, longitude as string, nameOfCounty as string, periods as (beginDate as date, endDate as date)[])[],",
						"          electronicMails as (electronicMailTypeDescriptor as string, electronicMailAddress as string, doNotPublishIndicator as boolean, primaryEmailAddressIndicator as boolean)[],",
						"          firstName as string,",
						"          generationCodeSuffix as string,",
						"          highestCompletedLevelOfEducationDescriptor as string,",
						"          internationalAddresses as (addressTypeDescriptor as string, countryDescriptor as string, addressLine1 as string, addressLine2 as string, addressLine3 as string, addressLine4 as string, beginDate as date, endDate as date, latitude as string, longitude as string)[],",
						"          languages as (languageDescriptor as string, uses as (languageUseDescriptor as string)[])[],",
						"          lastSurname as string,",
						"          loginId as string,",
						"          maidenName as string,",
						"          middleName as string,",
						"          otherNames as (otherNameTypeDescriptor as string, firstName as string, generationCodeSuffix as string, lastSurname as string, middleName as string, personalTitlePrefix as string)[],",
						"          personalIdentificationDocuments as (identificationDocumentUseDescriptor as string, personalInformationVerificationDescriptor as string, issuerCountryDescriptor as string, documentExpirationDate as date, documentTitle as string, issuerDocumentIdentificationCode as string, issuerName as string)[],",
						"          personalTitlePrefix as string,",
						"          sexDescriptor as string,",
						"          telephones as (telephoneNumberTypeDescriptor as string, telephoneNumber as string, doNotPublishIndicator as boolean, orderOfPriority as integer, textMessageCapabilityIndicator as boolean)[],",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          parentUniqueId,",
						"          personId = personReference.personId,",
						"          sourceSystemDescriptor = personReference.sourceSystemDescriptor,",
						"          addresses,",
						"          electronicMails,",
						"          firstName,",
						"          generationCodeSuffix,",
						"          highestCompletedLevelOfEducationDescriptor,",
						"          internationalAddresses,",
						"          languages,",
						"          lastSurname,",
						"          loginId,",
						"          maidenName,",
						"          middleName,",
						"          otherNames,",
						"          personalIdentificationDocuments,",
						"          personalTitlePrefix,",
						"          sexDescriptor,",
						"          telephones,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_payrolls')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('payrolls'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          asOfDate as date,",
						"          accountReference as (accountIdentifier as string, educationOrganizationId as integer, fiscalYear as integer, link as (rel as string, href as string)),",
						"          staffReference as (staffUniqueId as string, link as (rel as string, href as string)),",
						"          amountToDate as float,",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          asOfDate,",
						"          educationOrganizationId = accountReference.educationOrganizationId,",
						"          accountIdentifier = accountReference.accountIdentifier,",
						"          fiscalYear = accountReference.fiscalYear,",
						"          staffUniqueId = staffReference.staffUniqueId,",
						"          amountToDate,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_people')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('people'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          personId as string,",
						"          sourceSystemDescriptor as string,",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          personId,",
						"          sourceSystemDescriptor,",
						"          etag",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_performanceEvaluationRatings')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('performanceEvaluationRatings'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          performanceEvaluationReference as (educationOrganizationId as integer, evaluationPeriodDescriptor as string, performanceEvaluationTitle as string, performanceEvaluationTypeDescriptor as string, schoolYear as integer, termDescriptor as string, link as (rel as string, href as string)),",
						"          personReference as (personId as string, sourceSystemDescriptor as string, link as (rel as string, href as string)),",
						"          actualDate as date,",
						"          actualDuration as integer,",
						"          actualTime as string,",
						"          announced as boolean,",
						"          comments as string,",
						"          coteachingStyleObservedDescriptor as string,",
						"          performanceEvaluationRatingLevelDescriptor as string,",
						"          results as (rating as float, ratingResultTitle as string, resultDatatypeTypeDescriptor as string)[],",
						"          reviewers as (firstName as string, lastSurname as string, reviewerPersonReference as (personId as string, sourceSystemDescriptor as string, link as (rel as string, href as string)), receivedTraining as (interRaterReliabilityScore as integer, receivedTrainingDate as date))[],",
						"          scheduleDate as date,",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          performanceEvaluationReference,",
						"          personReference,",
						"          actualDate,",
						"          actualDuration,",
						"          actualTime,",
						"          announced,",
						"          comments,",
						"          coteachingStyleObservedDescriptor,",
						"          performanceEvaluationRatingLevelDescriptor,",
						"          results,",
						"          reviewers,",
						"          scheduleDate,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_performanceEvaluations')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('performanceEvaluations'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          evaluationPeriodDescriptor as string,",
						"          performanceEvaluationTitle as string,",
						"          performanceEvaluationTypeDescriptor as string,",
						"          termDescriptor as string,",
						"          educationOrganizationReference as (educationOrganizationId as integer, link as (rel as string, href as string)),",
						"          schoolYearTypeReference as (schoolYear as integer, link as (rel as string, href as string)),",
						"          academicSubjectDescriptor as string,",
						"          gradeLevels as (gradeLevelDescriptor as string)[],",
						"          performanceEvaluationDescription as string,",
						"          ratingLevels as (evaluationRatingLevelDescriptor as string, maxRating as float, minRating as float)[],",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          evaluationPeriodDescriptor,",
						"          performanceEvaluationTitle,",
						"          performanceEvaluationTypeDescriptor,",
						"          termDescriptor,",
						"          educationOrganizationReference,",
						"          schoolYearTypeReference,",
						"          academicSubjectDescriptor,",
						"          gradeLevels,",
						"          performanceEvaluationDescription,",
						"          ratingLevels,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_postSecondaryEvents')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('postSecondaryEvents'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          eventDate as date,",
						"          postSecondaryEventCategoryDescriptor as string,",
						"          postSecondaryInstitutionReference as (postSecondaryInstitutionId as integer, link as (rel as string, href as string)),",
						"          studentReference as (studentUniqueId as string, link as (rel as string, href as string)),",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          eventDate,",
						"          postSecondaryEventCategoryDescriptor,",
						"          postSecondaryInstitutionReference,",
						"          studentReference,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_postSecondaryInstitutions')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('postSecondaryInstitutions'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          categories as (educationOrganizationCategoryDescriptor as string)[],",
						"          postSecondaryInstitutionId as integer,",
						"          addresses as (addressTypeDescriptor as string, stateAbbreviationDescriptor as string, city as string, postalCode as string, streetNumberName as string, localeDescriptor as string, apartmentRoomSuiteNumber as string, buildingSiteNumber as string, congressionalDistrict as string, countyFIPSCode as string, doNotPublishIndicator as boolean, latitude as string, longitude as string, nameOfCounty as string, periods as (beginDate as date, endDate as date)[])[],",
						"          administrativeFundingControlDescriptor as string,",
						"          identificationCodes as (educationOrganizationIdentificationSystemDescriptor as string, identificationCode as string)[],",
						"          indicators as (indicatorDescriptor as string, indicatorGroupDescriptor as string, indicatorLevelDescriptor as string, designatedBy as string, indicatorValue as string, periods as (beginDate as date, endDate as date)[])[],",
						"          institutionTelephones as (institutionTelephoneNumberTypeDescriptor as string, telephoneNumber as string)[],",
						"          internationalAddresses as (addressTypeDescriptor as string, countryDescriptor as string, addressLine1 as string, addressLine2 as string, addressLine3 as string, addressLine4 as string, beginDate as date, endDate as date, latitude as string, longitude as string)[],",
						"          mediumOfInstructions as (mediumOfInstructionDescriptor as string)[],",
						"          nameOfInstitution as string,",
						"          operationalStatusDescriptor as string,",
						"          postSecondaryInstitutionLevelDescriptor as string,",
						"          shortNameOfInstitution as string,",
						"          webSite as string,",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          categories,",
						"          postSecondaryInstitutionId,",
						"          addresses,",
						"          administrativeFundingControlDescriptor,",
						"          identificationCodes,",
						"          indicators,",
						"          institutionTelephones,",
						"          internationalAddresses,",
						"          mediumOfInstructions,",
						"          nameOfInstitution,",
						"          operationalStatusDescriptor,",
						"          postSecondaryInstitutionLevelDescriptor,",
						"          shortNameOfInstitution,",
						"          webSite,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_programs')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('programs'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          programName as string,",
						"          programTypeDescriptor as string,",
						"          educationOrganizationReference as (educationOrganizationId as integer, link as (rel as string, href as string)),",
						"          characteristics as (programCharacteristicDescriptor as string)[],",
						"          learningObjectives as (learningObjectiveReference as (learningObjectiveId as string, namespace as string, link as (rel as string, href as string)))[],",
						"          learningStandards as (learningStandardReference as (learningStandardId as string, link as (rel as string, href as string)))[],",
						"          programId as string,",
						"          services as (serviceDescriptor as string)[],",
						"          sponsors as (programSponsorDescriptor as string)[],",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          programName,",
						"          programTypeDescriptor,",
						"          educationOrganizationId = educationOrganizationReference.educationOrganizationId,",
						"          characteristics,",
						"          learningObjectives,",
						"          learningStandards,",
						"          programId,",
						"          services,",
						"          sponsors,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_reportCards')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('reportCards'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          educationOrganizationReference as (educationOrganizationId as integer, link as (rel as string, href as string)),",
						"          gradingPeriodReference as (gradingPeriodDescriptor as string, periodSequence as integer, schoolId as integer, schoolYear as integer, link as (rel as string, href as string)),",
						"          studentReference as (studentUniqueId as string, link as (rel as string, href as string)),",
						"          gpaCumulative as float,",
						"          gpaGivenGradingPeriod as float,",
						"          gradePointAverages as (gradePointAverageTypeDescriptor as string, gradePointAverageValue as float, isCumulative as boolean, maxGradePointAverageValue as float)[],",
						"          grades as (gradeReference as (beginDate as date, gradeTypeDescriptor as string, gradingPeriodDescriptor as string, gradingPeriodSchoolYear as integer, gradingPeriodSequence as integer, localCourseCode as string, schoolId as integer, schoolYear as integer, sectionIdentifier as string, sessionName as string, studentUniqueId as string, link as (rel as string, href as string)))[],",
						"          numberOfDaysAbsent as float,",
						"          numberOfDaysInAttendance as float,",
						"          numberOfDaysTardy as integer,",
						"          studentCompetencyObjectives as (studentCompetencyObjectiveReference as (gradingPeriodDescriptor as string, gradingPeriodSchoolId as integer, gradingPeriodSchoolYear as integer, gradingPeriodSequence as integer, objective as string, objectiveEducationOrganizationId as integer, objectiveGradeLevelDescriptor as string, studentUniqueId as string, link as (rel as string, href as string)))[],",
						"          studentLearningObjectives as (studentLearningObjectiveReference as (gradingPeriodDescriptor as string, gradingPeriodSchoolId as integer, gradingPeriodSchoolYear as integer, gradingPeriodSequence as integer, learningObjectiveId as string, namespace as string, studentUniqueId as string, link as (rel as string, href as string)))[],",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          educationOrganizationId = educationOrganizationReference.educationOrganizationId,",
						"          gradingPeriodReference,",
						"          studentReference,",
						"          gpaCumulative,",
						"          gpaGivenGradingPeriod,",
						"          gradePointAverages,",
						"          grades,",
						"          numberOfDaysAbsent,",
						"          numberOfDaysInAttendance,",
						"          numberOfDaysTardy,",
						"          studentCompetencyObjectives,",
						"          studentLearningObjectives,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_restraintEvents')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('restraintEvents'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          restraintEventIdentifier as string,",
						"          schoolReference as (schoolId as integer, link as (rel as string, href as string)),",
						"          studentReference as (studentUniqueId as string, link as (rel as string, href as string)),",
						"          educationalEnvironmentDescriptor as string,",
						"          eventDate as date,",
						"          programs as (programReference as (educationOrganizationId as integer, programName as string, programTypeDescriptor as string, link as (rel as string, href as string)))[],",
						"          reasons as (restraintEventReasonDescriptor as string)[],",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          restraintEventIdentifier,",
						"          schoolReference,",
						"          studentReference,",
						"          educationalEnvironmentDescriptor,",
						"          eventDate,",
						"          programs,",
						"          reasons,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_rubricDimensions')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('rubricDimensions'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          rubricRating as integer,",
						"          evaluationElementReference as (educationOrganizationId as integer, evaluationElementTitle as string, evaluationObjectiveTitle as string, evaluationPeriodDescriptor as string, evaluationTitle as string, performanceEvaluationTitle as string, performanceEvaluationTypeDescriptor as string, schoolYear as integer, termDescriptor as string, link as (rel as string, href as string)),",
						"          criterionDescription as string,",
						"          dimensionOrder as integer,",
						"          rubricRatingLevelDescriptor as string,",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          rubricRating,",
						"          evaluationElementReference,",
						"          criterionDescription,",
						"          dimensionOrder,",
						"          rubricRatingLevelDescriptor,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_schoolYearTypes')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('schoolYearTypes'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          schoolYear as integer,",
						"          currentSchoolYear as boolean,",
						"          schoolYearDescription as string,",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          schoolYear,",
						"          currentSchoolYear,",
						"          schoolYearDescription,",
						"          etag",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_schools')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('schools'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          educationOrganizationCategories as (educationOrganizationCategoryDescriptor as string)[],",
						"          gradeLevels as (gradeLevelDescriptor as string)[],",
						"          schoolId as integer,",
						"          charterApprovalSchoolYearTypeReference as (schoolYear as integer, link as (rel as string, href as string)),",
						"          localEducationAgencyReference as (localEducationAgencyId as integer, link as (rel as string, href as string)),",
						"          addresses as (addressTypeDescriptor as string, stateAbbreviationDescriptor as string, city as string, postalCode as string, streetNumberName as string, localeDescriptor as string, apartmentRoomSuiteNumber as string, buildingSiteNumber as string, congressionalDistrict as string, countyFIPSCode as string, doNotPublishIndicator as boolean, latitude as string, longitude as string, nameOfCounty as string, periods as (beginDate as date, endDate as date)[])[],",
						"          administrativeFundingControlDescriptor as string,",
						"          charterApprovalAgencyTypeDescriptor as string,",
						"          charterStatusDescriptor as string,",
						"          identificationCodes as (educationOrganizationIdentificationSystemDescriptor as string, identificationCode as string)[],",
						"          indicators as (indicatorDescriptor as string, indicatorGroupDescriptor as string, indicatorLevelDescriptor as string, designatedBy as string, indicatorValue as string, periods as (beginDate as date, endDate as date)[])[],",
						"          institutionTelephones as (institutionTelephoneNumberTypeDescriptor as string, telephoneNumber as string)[],",
						"          internationalAddresses as (addressTypeDescriptor as string, countryDescriptor as string, addressLine1 as string, addressLine2 as string, addressLine3 as string, addressLine4 as string, beginDate as date, endDate as date, latitude as string, longitude as string)[],",
						"          internetAccessDescriptor as string,",
						"          magnetSpecialProgramEmphasisSchoolDescriptor as string,",
						"          nameOfInstitution as string,",
						"          operationalStatusDescriptor as string,",
						"          schoolCategories as (schoolCategoryDescriptor as string)[],",
						"          schoolTypeDescriptor as string,",
						"          shortNameOfInstitution as string,",
						"          titleIPartASchoolDesignationDescriptor as string,",
						"          webSite as string,",
						"          etag as string,",
						"          ext as (TPDM as (postSecondaryInstitutionReference as (postSecondaryInstitutionId as integer, link as (rel as string, href as string))))",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          educationOrganizationCategories,",
						"          gradeLevels,",
						"          schoolId,",
						"          schoolYear = charterApprovalSchoolYearTypeReference.schoolYear,",
						"          localEducationAgencyId = localEducationAgencyReference.localEducationAgencyId,",
						"          addresses,",
						"          administrativeFundingControlDescriptor,",
						"          charterApprovalAgencyTypeDescriptor,",
						"          charterStatusDescriptor,",
						"          identificationCodes,",
						"          indicators,",
						"          institutionTelephones,",
						"          internationalAddresses,",
						"          internetAccessDescriptor,",
						"          magnetSpecialProgramEmphasisSchoolDescriptor,",
						"          nameOfInstitution,",
						"          operationalStatusDescriptor,",
						"          schoolCategories,",
						"          schoolTypeDescriptor,",
						"          shortNameOfInstitution,",
						"          titleIPartASchoolDesignationDescriptor,",
						"          webSite,",
						"          etag,",
						"          ext,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_sectionAttendanceTakenEvents')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('sectionAttendanceTakenEvents'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          calendarDateReference as (calendarCode as string, date as date, schoolId as integer, schoolYear as integer, link as (rel as string, href as string)),",
						"          sectionReference as (localCourseCode as string, schoolId as integer, schoolYear as integer, sectionIdentifier as string, sessionName as string, link as (rel as string, href as string)),",
						"          staffReference as (staffUniqueId as string, link as (rel as string, href as string)),",
						"          eventDate as date,",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          calendarCode = calendarDateReference.calendarCode,",
						"          date = calendarDateReference.date,",
						"          sessionName = sectionReference.sessionName,",
						"          sectionIdentifier = sectionReference.sectionIdentifier,",
						"          schoolYear = sectionReference.schoolYear,",
						"          schoolId = sectionReference.schoolId,",
						"          localCourseCode = sectionReference.localCourseCode,",
						"          schoolId = sectionReference.schoolId,",
						"          schoolYear = sectionReference.schoolYear,",
						"          staffUniqueId = staffReference.staffUniqueId,",
						"          eventDate,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_sections')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('sections'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          sectionIdentifier as string,",
						"          courseOfferingReference as (localCourseCode as string, schoolId as integer, schoolYear as integer, sessionName as string, link as (rel as string, href as string)),",
						"          locationReference as (classroomIdentificationCode as string, schoolId as integer, link as (rel as string, href as string)),",
						"          locationSchoolReference as (schoolId as integer, link as (rel as string, href as string)),",
						"          availableCreditConversion as float,",
						"          availableCredits as float,",
						"          availableCreditTypeDescriptor as string,",
						"          characteristics as (sectionCharacteristicDescriptor as string)[],",
						"          classPeriods as (classPeriodReference as (classPeriodName as string, schoolId as integer, link as (rel as string, href as string)))[],",
						"          courseLevelCharacteristics as (courseLevelCharacteristicDescriptor as string)[],",
						"          educationalEnvironmentDescriptor as string,",
						"          instructionLanguageDescriptor as string,",
						"          mediumOfInstructionDescriptor as string,",
						"          offeredGradeLevels as (gradeLevelDescriptor as string)[],",
						"          officialAttendancePeriod as boolean,",
						"          populationServedDescriptor as string,",
						"          programs as (programReference as (educationOrganizationId as integer, programName as string, programTypeDescriptor as string, link as (rel as string, href as string)))[],",
						"          sectionName as string,",
						"          sequenceOfCourse as integer,",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          sectionIdentifier,",
						"          localCourseCode = courseOfferingReference.localCourseCode,",
						"          schoolId = courseOfferingReference.schoolId,",
						"          schoolYear = courseOfferingReference.schoolYear,",
						"          sessionName = courseOfferingReference.sessionName,",
						"          classroomIdentificationCode = locationReference.classroomIdentificationCode,",
						"          locationSchoolReference,",
						"          availableCreditConversion,",
						"          availableCredits,",
						"          availableCreditTypeDescriptor,",
						"          characteristics,",
						"          classPeriods,",
						"          courseLevelCharacteristics,",
						"          educationalEnvironmentDescriptor,",
						"          instructionLanguageDescriptor,",
						"          mediumOfInstructionDescriptor,",
						"          offeredGradeLevels,",
						"          officialAttendancePeriod,",
						"          populationServedDescriptor,",
						"          programs,",
						"          sectionName,",
						"          sequenceOfCourse,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_sessions')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('sessions'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          sessionName as string,",
						"          schoolReference as (schoolId as integer, link as (rel as string, href as string)),",
						"          schoolYearTypeReference as (schoolYear as integer, link as (rel as string, href as string)),",
						"          academicWeeks as (academicWeekReference as (schoolId as integer, weekIdentifier as string, link as (rel as string, href as string)))[],",
						"          beginDate as date,",
						"          endDate as date,",
						"          gradingPeriods as (gradingPeriodReference as (gradingPeriodDescriptor as string, periodSequence as integer, schoolId as integer, schoolYear as integer, link as (rel as string, href as string)))[],",
						"          termDescriptor as string,",
						"          totalInstructionalDays as integer,",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          sessionName,",
						"          schoolId = schoolReference.schoolId,",
						"          schoolYear = schoolYearTypeReference.schoolYear,",
						"          academicWeeks,",
						"          beginDate,",
						"          endDate,",
						"          gradingPeriods,",
						"          termDescriptor,",
						"          totalInstructionalDays,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_staffAbsenceEvents')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('staffAbsenceEvents'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          absenceEventCategoryDescriptor as string,",
						"          eventDate as date,",
						"          staffReference as (staffUniqueId as string, link as (rel as string, href as string)),",
						"          absenceEventReason as string,",
						"          hoursAbsent as float,",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          absenceEventCategoryDescriptor,",
						"          eventDate,",
						"          staffUniqueId = staffReference.staffUniqueId,",
						"          absenceEventReason,",
						"          hoursAbsent,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_staffCohortAssociations')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('staffCohortAssociations'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          beginDate as date,",
						"          cohortReference as (cohortIdentifier as string, educationOrganizationId as integer, link as (rel as string, href as string)),",
						"          staffReference as (staffUniqueId as string, link as (rel as string, href as string)),",
						"          endDate as date,",
						"          studentRecordAccess as boolean,",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          beginDate,",
						"          cohortReference,",
						"          staffReference,",
						"          endDate,",
						"          studentRecordAccess,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_staffDisciplineIncidentAssociations')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('staffDisciplineIncidentAssociations'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          disciplineIncidentParticipationCodes as (disciplineIncidentParticipationCodeDescriptor as string)[],",
						"          disciplineIncidentReference as (incidentIdentifier as string, schoolId as integer, link as (rel as string, href as string)),",
						"          staffReference as (staffUniqueId as string, link as (rel as string, href as string)),",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          disciplineIncidentParticipationCodes,",
						"          disciplineIncidentReference,",
						"          staffReference,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_staffEducationOrganizationAssignmentAssociations')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('staffEducationOrganizationAssignmentAssociations'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          beginDate as date,",
						"          staffClassificationDescriptor as string,",
						"          credentialReference as (credentialIdentifier as string, stateOfIssueStateAbbreviationDescriptor as string, link as (rel as string, href as string)),",
						"          educationOrganizationReference as (educationOrganizationId as integer, link as (rel as string, href as string)),",
						"          employmentStaffEducationOrganizationEmploymentAssociationReference as (educationOrganizationId as integer, employmentStatusDescriptor as string, hireDate as date, staffUniqueId as string, link as (rel as string, href as string)),",
						"          staffReference as (staffUniqueId as string, link as (rel as string, href as string)),",
						"          endDate as date,",
						"          fullTimeEquivalency as float,",
						"          orderOfAssignment as integer,",
						"          positionTitle as string,",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          beginDate,",
						"          staffClassificationDescriptor,",
						"          credentialReference,",
						"          educationOrganizationReference,",
						"          employmentStaffEducationOrganizationEmploymentAssociationReference,",
						"          staffReference,",
						"          endDate,",
						"          fullTimeEquivalency,",
						"          orderOfAssignment,",
						"          positionTitle,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_staffEducationOrganizationContactAssociations')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('staffEducationOrganizationContactAssociations'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          contactTitle as string,",
						"          educationOrganizationReference as (educationOrganizationId as integer, link as (rel as string, href as string)),",
						"          staffReference as (staffUniqueId as string, link as (rel as string, href as string)),",
						"          address as (addressTypeDescriptor as string, localeDescriptor as string, stateAbbreviationDescriptor as string, apartmentRoomSuiteNumber as string, buildingSiteNumber as string, city as string, congressionalDistrict as string, countyFIPSCode as string, doNotPublishIndicator as boolean, latitude as string, longitude as string, nameOfCounty as string, postalCode as string, streetNumberName as string, periods as (beginDate as date, endDate as date)[]),",
						"          contactTypeDescriptor as string,",
						"          electronicMailAddress as string,",
						"          telephones as (telephoneNumberTypeDescriptor as string, telephoneNumber as string, doNotPublishIndicator as boolean, orderOfPriority as integer, textMessageCapabilityIndicator as boolean)[],",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          contactTitle,",
						"          educationOrganizationReference,",
						"          staffReference,",
						"          address,",
						"          contactTypeDescriptor,",
						"          electronicMailAddress,",
						"          telephones,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_staffEducationOrganizationEmploymentAssociations')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('staffEducationOrganizationEmploymentAssociations'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          employmentStatusDescriptor as string,",
						"          hireDate as date,",
						"          credentialReference as (credentialIdentifier as string, stateOfIssueStateAbbreviationDescriptor as string, link as (rel as string, href as string)),",
						"          educationOrganizationReference as (educationOrganizationId as integer, link as (rel as string, href as string)),",
						"          staffReference as (staffUniqueId as string, link as (rel as string, href as string)),",
						"          department as string,",
						"          endDate as date,",
						"          fullTimeEquivalency as float,",
						"          hourlyWage as float,",
						"          offerDate as date,",
						"          separationDescriptor as string,",
						"          separationReasonDescriptor as string,",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          employmentStatusDescriptor,",
						"          hireDate,",
						"          credentialReference,",
						"          educationOrganizationReference,",
						"          staffReference,",
						"          department,",
						"          endDate,",
						"          fullTimeEquivalency,",
						"          hourlyWage,",
						"          offerDate,",
						"          separationDescriptor,",
						"          separationReasonDescriptor,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_staffLeaves')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('staffLeaves'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          beginDate as date,",
						"          staffLeaveEventCategoryDescriptor as string,",
						"          staffReference as (staffUniqueId as string, link as (rel as string, href as string)),",
						"          endDate as date,",
						"          reason as string,",
						"          substituteAssigned as boolean,",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          beginDate,",
						"          staffLeaveEventCategoryDescriptor,",
						"          staffReference,",
						"          endDate,",
						"          reason,",
						"          substituteAssigned,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_staffProgramAssociations')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('staffProgramAssociations'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          beginDate as date,",
						"          programReference as (educationOrganizationId as integer, programName as string, programTypeDescriptor as string, link as (rel as string, href as string)),",
						"          staffReference as (staffUniqueId as string, link as (rel as string, href as string)),",
						"          endDate as date,",
						"          studentRecordAccess as boolean,",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          beginDate,",
						"          programReference,",
						"          staffReference,",
						"          endDate,",
						"          studentRecordAccess,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_staffSchoolAssociations')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('staffSchoolAssociations'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          programAssignmentDescriptor as string,",
						"          calendarReference as (calendarCode as string, schoolId as integer, schoolYear as integer, link as (rel as string, href as string)),",
						"          schoolReference as (schoolId as integer, link as (rel as string, href as string)),",
						"          schoolYearTypeReference as (schoolYear as integer, link as (rel as string, href as string)),",
						"          staffReference as (staffUniqueId as string, link as (rel as string, href as string)),",
						"          academicSubjects as (academicSubjectDescriptor as string)[],",
						"          gradeLevels as (gradeLevelDescriptor as string)[],",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          programAssignmentDescriptor,",
						"          calendarReference,",
						"          schoolId = schoolReference.schoolId,",
						"          schoolYear = schoolYearTypeReference.schoolYear,",
						"          staffUniqueId = staffReference.staffUniqueId,",
						"          academicSubjects,",
						"          gradeLevels,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_staffSectionAssociations')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('staffSectionAssociations'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          sectionReference as (localCourseCode as string, schoolId as integer, schoolYear as integer, sectionIdentifier as string, sessionName as string, link as (rel as string, href as string)),",
						"          staffReference as (staffUniqueId as string, link as (rel as string, href as string)),",
						"          beginDate as date,",
						"          classroomPositionDescriptor as string,",
						"          endDate as date,",
						"          highlyQualifiedTeacher as boolean,",
						"          percentageContribution as float,",
						"          teacherStudentDataLinkExclusion as boolean,",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          sessionName = sectionReference.sessionName,",
						"          sectionIdentifier = sectionReference.sectionIdentifier,",
						"          schoolYear = sectionReference.schoolYear,",
						"          schoolId = sectionReference.schoolId,",
						"          localCourseCode = sectionReference.localCourseCode,",
						"          staffUniqueId = staffReference.staffUniqueId,",
						"          beginDate,",
						"          classroomPositionDescriptor,",
						"          endDate,",
						"          highlyQualifiedTeacher,",
						"          percentageContribution,",
						"          teacherStudentDataLinkExclusion,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_staffs')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('staffs'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          staffUniqueId as string,",
						"          personReference as (personId as string, sourceSystemDescriptor as string, link as (rel as string, href as string)),",
						"          addresses as (addressTypeDescriptor as string, stateAbbreviationDescriptor as string, city as string, postalCode as string, streetNumberName as string, localeDescriptor as string, apartmentRoomSuiteNumber as string, buildingSiteNumber as string, congressionalDistrict as string, countyFIPSCode as string, doNotPublishIndicator as boolean, latitude as string, longitude as string, nameOfCounty as string, periods as (beginDate as date, endDate as date)[])[],",
						"          ancestryEthnicOrigins as (ancestryEthnicOriginDescriptor as string)[],",
						"          birthDate as date,",
						"          citizenshipStatusDescriptor as string,",
						"          credentials as (credentialReference as (credentialIdentifier as string, stateOfIssueStateAbbreviationDescriptor as string, link as (rel as string, href as string)))[],",
						"          electronicMails as (electronicMailTypeDescriptor as string, electronicMailAddress as string, doNotPublishIndicator as boolean, primaryEmailAddressIndicator as boolean)[],",
						"          firstName as string,",
						"          generationCodeSuffix as string,",
						"          highestCompletedLevelOfEducationDescriptor as string,",
						"          highlyQualifiedTeacher as boolean,",
						"          hispanicLatinoEthnicity as boolean,",
						"          identificationCodes as (staffIdentificationSystemDescriptor as string, assigningOrganizationIdentificationCode as string, identificationCode as string)[],",
						"          identificationDocuments as (identificationDocumentUseDescriptor as string, personalInformationVerificationDescriptor as string, issuerCountryDescriptor as string, documentExpirationDate as date, documentTitle as string, issuerDocumentIdentificationCode as string, issuerName as string)[],",
						"          internationalAddresses as (addressTypeDescriptor as string, countryDescriptor as string, addressLine1 as string, addressLine2 as string, addressLine3 as string, addressLine4 as string, beginDate as date, endDate as date, latitude as string, longitude as string)[],",
						"          languages as (languageDescriptor as string, uses as (languageUseDescriptor as string)[])[],",
						"          lastSurname as string,",
						"          loginId as string,",
						"          maidenName as string,",
						"          middleName as string,",
						"          oldEthnicityDescriptor as string,",
						"          otherNames as (otherNameTypeDescriptor as string, firstName as string, generationCodeSuffix as string, lastSurname as string, middleName as string, personalTitlePrefix as string)[],",
						"          personalIdentificationDocuments as (identificationDocumentUseDescriptor as string, personalInformationVerificationDescriptor as string, issuerCountryDescriptor as string, documentExpirationDate as date, documentTitle as string, issuerDocumentIdentificationCode as string, issuerName as string)[],",
						"          personalTitlePrefix as string,",
						"          races as (raceDescriptor as string)[],",
						"          recognitions as (recognitionTypeDescriptor as string, achievementCategoryDescriptor as string, achievementCategorySystem as string, achievementTitle as string, criteria as string, criteriaURL as string, evidenceStatement as string, imageURL as string, issuerName as string, issuerOriginURL as string, recognitionAwardDate as date, recognitionAwardExpiresDate as date, recognitionDescription as string)[],",
						"          sexDescriptor as string,",
						"          telephones as (telephoneNumberTypeDescriptor as string, telephoneNumber as string, doNotPublishIndicator as boolean, orderOfPriority as integer, textMessageCapabilityIndicator as boolean)[],",
						"          tribalAffiliations as (tribalAffiliationDescriptor as string)[],",
						"          visas as (visaDescriptor as string)[],",
						"          yearsOfPriorProfessionalExperience as float,",
						"          yearsOfPriorTeachingExperience as float,",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          staffUniqueId,",
						"          personId = personReference.personId,",
						"          addresses,",
						"          ancestryEthnicOrigins,",
						"          birthDate,",
						"          citizenshipStatusDescriptor,",
						"          credentials,",
						"          electronicMails,",
						"          firstName,",
						"          generationCodeSuffix,",
						"          highestCompletedLevelOfEducationDescriptor,",
						"          highlyQualifiedTeacher,",
						"          hispanicLatinoEthnicity,",
						"          identificationCodes,",
						"          identificationDocuments,",
						"          internationalAddresses,",
						"          languages,",
						"          lastSurname,",
						"          loginId,",
						"          maidenName,",
						"          middleName,",
						"          oldEthnicityDescriptor,",
						"          otherNames,",
						"          personalIdentificationDocuments,",
						"          personalTitlePrefix,",
						"          races,",
						"          recognitions,",
						"          sexDescriptor,",
						"          telephones,",
						"          tribalAffiliations,",
						"          visas,",
						"          yearsOfPriorProfessionalExperience,",
						"          yearsOfPriorTeachingExperience,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_stateEducationAgencies')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('stateEducationAgencies'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          categories as (educationOrganizationCategoryDescriptor as string)[],",
						"          stateEducationAgencyId as integer,",
						"          accountabilities as (cteGraduationRateInclusion as boolean, schoolYearTypeReference as (schoolYear as integer, link as (rel as string, href as string)))[],",
						"          addresses as (addressTypeDescriptor as string, stateAbbreviationDescriptor as string, city as string, postalCode as string, streetNumberName as string, localeDescriptor as string, apartmentRoomSuiteNumber as string, buildingSiteNumber as string, congressionalDistrict as string, countyFIPSCode as string, doNotPublishIndicator as boolean, latitude as string, longitude as string, nameOfCounty as string, periods as (beginDate as date, endDate as date)[])[],",
						"          federalFunds as (fiscalYear as integer, federalProgramsFundingAllocation as float)[],",
						"          identificationCodes as (educationOrganizationIdentificationSystemDescriptor as string, identificationCode as string)[],",
						"          indicators as (indicatorDescriptor as string, indicatorGroupDescriptor as string, indicatorLevelDescriptor as string, designatedBy as string, indicatorValue as string, periods as (beginDate as date, endDate as date)[])[],",
						"          institutionTelephones as (institutionTelephoneNumberTypeDescriptor as string, telephoneNumber as string)[],",
						"          internationalAddresses as (addressTypeDescriptor as string, countryDescriptor as string, addressLine1 as string, addressLine2 as string, addressLine3 as string, addressLine4 as string, beginDate as date, endDate as date, latitude as string, longitude as string)[],",
						"          nameOfInstitution as string,",
						"          operationalStatusDescriptor as string,",
						"          shortNameOfInstitution as string,",
						"          webSite as string,",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          categories,",
						"          stateEducationAgencyId,",
						"          accountabilities,",
						"          addresses,",
						"          federalFunds,",
						"          identificationCodes,",
						"          indicators,",
						"          institutionTelephones,",
						"          internationalAddresses,",
						"          nameOfInstitution,",
						"          operationalStatusDescriptor,",
						"          shortNameOfInstitution,",
						"          webSite,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_studentAcademicRecords')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('studentAcademicRecords'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          termDescriptor as string,",
						"          educationOrganizationReference as (educationOrganizationId as integer, link as (rel as string, href as string)),",
						"          schoolYearTypeReference as (schoolYear as integer, link as (rel as string, href as string)),",
						"          studentReference as (studentUniqueId as string, link as (rel as string, href as string)),",
						"          academicHonors as (academicHonorCategoryDescriptor as string, honorDescription as string, achievementCategoryDescriptor as string, achievementCategorySystem as string, achievementTitle as string, criteria as string, criteriaURL as string, evidenceStatement as string, honorAwardDate as date, honorAwardExpiresDate as date, imageURL as string, issuerName as string, issuerOriginURL as string)[],",
						"          classRanking as (classRank as integer, classRankingDate as date, percentageRanking as integer, totalNumberInClass as integer),",
						"          cumulativeAttemptedCreditConversion as float,",
						"          cumulativeAttemptedCredits as float,",
						"          cumulativeAttemptedCreditTypeDescriptor as string,",
						"          cumulativeEarnedCreditConversion as float,",
						"          cumulativeEarnedCredits as float,",
						"          cumulativeEarnedCreditTypeDescriptor as string,",
						"          cumulativeGradePointAverage as float,",
						"          cumulativeGradePointsEarned as float,",
						"          diplomas as (diplomaTypeDescriptor as string, diplomaAwardDate as date, achievementCategoryDescriptor as string, diplomaLevelDescriptor as string, achievementCategorySystem as string, achievementTitle as string, criteria as string, criteriaURL as string, cteCompleter as boolean, diplomaAwardExpiresDate as date, diplomaDescription as string, evidenceStatement as string, imageURL as string, issuerName as string, issuerOriginURL as string)[],",
						"          gradePointAverages as (gradePointAverageTypeDescriptor as string, gradePointAverageValue as float, isCumulative as boolean, maxGradePointAverageValue as float)[],",
						"          gradeValueQualifier as string,",
						"          projectedGraduationDate as date,",
						"          recognitions as (recognitionTypeDescriptor as string, achievementCategoryDescriptor as string, achievementCategorySystem as string, achievementTitle as string, criteria as string, criteriaURL as string, evidenceStatement as string, imageURL as string, issuerName as string, issuerOriginURL as string, recognitionAwardDate as date, recognitionAwardExpiresDate as date, recognitionDescription as string)[],",
						"          reportCards as (reportCardReference as (educationOrganizationId as integer, gradingPeriodDescriptor as string, gradingPeriodSchoolId as integer, gradingPeriodSchoolYear as integer, gradingPeriodSequence as integer, studentUniqueId as string, link as (rel as string, href as string)))[],",
						"          sessionAttemptedCreditConversion as float,",
						"          sessionAttemptedCredits as float,",
						"          sessionAttemptedCreditTypeDescriptor as string,",
						"          sessionEarnedCreditConversion as float,",
						"          sessionEarnedCredits as float,",
						"          sessionEarnedCreditTypeDescriptor as string,",
						"          sessionGradePointAverage as float,",
						"          sessionGradePointsEarned as float,",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          termDescriptor,",
						"          educationOrganizationReference,",
						"          schoolYearTypeReference,",
						"          studentReference,",
						"          academicHonors,",
						"          classRanking,",
						"          cumulativeAttemptedCreditConversion,",
						"          cumulativeAttemptedCredits,",
						"          cumulativeAttemptedCreditTypeDescriptor,",
						"          cumulativeEarnedCreditConversion,",
						"          cumulativeEarnedCredits,",
						"          cumulativeEarnedCreditTypeDescriptor,",
						"          cumulativeGradePointAverage,",
						"          cumulativeGradePointsEarned,",
						"          diplomas,",
						"          gradePointAverages,",
						"          gradeValueQualifier,",
						"          projectedGraduationDate,",
						"          recognitions,",
						"          reportCards,",
						"          sessionAttemptedCreditConversion,",
						"          sessionAttemptedCredits,",
						"          sessionAttemptedCreditTypeDescriptor,",
						"          sessionEarnedCreditConversion,",
						"          sessionEarnedCredits,",
						"          sessionEarnedCreditTypeDescriptor,",
						"          sessionGradePointAverage,",
						"          sessionGradePointsEarned,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_studentAssessments')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('studentAssessments'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          studentAssessmentIdentifier as string,",
						"          assessmentReference as (assessmentIdentifier as string, namespace as string, link as (rel as string, href as string)),",
						"          schoolYearTypeReference as (schoolYear as integer, link as (rel as string, href as string)),",
						"          studentReference as (studentUniqueId as string, link as (rel as string, href as string)),",
						"          accommodations as (accommodationDescriptor as string)[],",
						"          administrationDate as timestamp,",
						"          administrationEndDate as timestamp,",
						"          administrationEnvironmentDescriptor as string,",
						"          administrationLanguageDescriptor as string,",
						"          eventCircumstanceDescriptor as string,",
						"          eventDescription as string,",
						"          items as (assessmentItemResultDescriptor as string, responseIndicatorDescriptor as string, assessmentResponse as string, descriptiveFeedback as string, rawScoreResult as float, timeAssessed as string, assessmentItemReference as (assessmentIdentifier as string, identificationCode as string, namespace as string, link as (rel as string, href as string)))[],",
						"          performanceLevels as (assessmentReportingMethodDescriptor as string, performanceLevelDescriptor as string, performanceLevelMet as boolean)[],",
						"          platformTypeDescriptor as string,",
						"          reasonNotTestedDescriptor as string,",
						"          retestIndicatorDescriptor as string,",
						"          scoreResults as (assessmentReportingMethodDescriptor as string, resultDatatypeTypeDescriptor as string, result as string)[],",
						"          serialNumber as string,",
						"          studentObjectiveAssessments as (objectiveAssessmentReference as (assessmentIdentifier as string, identificationCode as string, namespace as string, link as (rel as string, href as string)), performanceLevels as (assessmentReportingMethodDescriptor as string, performanceLevelDescriptor as string, performanceLevelMet as boolean)[], scoreResults as (assessmentReportingMethodDescriptor as string, resultDatatypeTypeDescriptor as string, result as string)[])[],",
						"          whenAssessedGradeLevelDescriptor as string,",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          studentAssessmentIdentifier,",
						"          assessmentReference,",
						"          schoolYearTypeReference,",
						"          studentReference,",
						"          accommodations,",
						"          administrationDate,",
						"          administrationEndDate,",
						"          administrationEnvironmentDescriptor,",
						"          administrationLanguageDescriptor,",
						"          eventCircumstanceDescriptor,",
						"          eventDescription,",
						"          items,",
						"          performanceLevels,",
						"          platformTypeDescriptor,",
						"          reasonNotTestedDescriptor,",
						"          retestIndicatorDescriptor,",
						"          scoreResults,",
						"          serialNumber,",
						"          studentObjectiveAssessments,",
						"          whenAssessedGradeLevelDescriptor,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_studentCTEProgramAssociations')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('studentCTEProgramAssociations'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          beginDate as date,",
						"          educationOrganizationReference as (educationOrganizationId as integer, link as (rel as string, href as string)),",
						"          programReference as (educationOrganizationId as integer, programName as string, programTypeDescriptor as string, link as (rel as string, href as string)),",
						"          studentReference as (studentUniqueId as string, link as (rel as string, href as string)),",
						"          ctePrograms as (careerPathwayDescriptor as string, cipCode as string, cteProgramCompletionIndicator as boolean, primaryCTEProgramIndicator as boolean)[],",
						"          cteProgramServices as (cteProgramServiceDescriptor as string, cipCode as string, primaryIndicator as boolean, serviceBeginDate as date, serviceEndDate as date)[],",
						"          endDate as date,",
						"          nonTraditionalGenderStatus as boolean,",
						"          participationStatus as (participationStatusDescriptor as string, designatedBy as string, statusBeginDate as date, statusEndDate as date),",
						"          privateCTEProgram as boolean,",
						"          programParticipationStatuses as (participationStatusDescriptor as string, statusBeginDate as date, designatedBy as string, statusEndDate as date)[],",
						"          reasonExitedDescriptor as string,",
						"          servedOutsideOfRegularSession as boolean,",
						"          services as (serviceDescriptor as string, primaryIndicator as boolean, serviceBeginDate as date, serviceEndDate as date)[],",
						"          technicalSkillsAssessmentDescriptor as string,",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          beginDate,",
						"          educationOrganizationId = educationOrganizationReference.educationOrganizationId,",
						"          programName = programReference.programName,",
						"          programTypeDescriptor = programReference.programTypeDescriptor,",
						"          studentUniqueId = studentReference.studentUniqueId,",
						"          ctePrograms,",
						"          cteProgramServices,",
						"          endDate,",
						"          nonTraditionalGenderStatus,",
						"          participationStatus,",
						"          privateCTEProgram,",
						"          programParticipationStatuses,",
						"          reasonExitedDescriptor,",
						"          servedOutsideOfRegularSession,",
						"          services,",
						"          technicalSkillsAssessmentDescriptor,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_studentCohortAssociations')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('studentCohortAssociations'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          beginDate as date,",
						"          cohortReference as (cohortIdentifier as string, educationOrganizationId as integer, link as (rel as string, href as string)),",
						"          studentReference as (studentUniqueId as string, link as (rel as string, href as string)),",
						"          endDate as date,",
						"          sections as (sectionReference as (localCourseCode as string, schoolId as integer, schoolYear as integer, sectionIdentifier as string, sessionName as string, link as (rel as string, href as string)))[],",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          beginDate,",
						"          cohortIdentifier = cohortReference.cohortIdentifier,",
						"          educationOrganizationId = cohortReference.educationOrganizationId,",
						"          studentUniqueId = studentReference.studentUniqueId,",
						"          endDate,",
						"          sections,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_studentCompetencyObjectives')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('studentCompetencyObjectives'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          gradingPeriodReference as (gradingPeriodDescriptor as string, periodSequence as integer, schoolId as integer, schoolYear as integer, link as (rel as string, href as string)),",
						"          objectiveCompetencyObjectiveReference as (educationOrganizationId as integer, objective as string, objectiveGradeLevelDescriptor as string, link as (rel as string, href as string)),",
						"          studentReference as (studentUniqueId as string, link as (rel as string, href as string)),",
						"          competencyLevelDescriptor as string,",
						"          diagnosticStatement as string,",
						"          generalStudentProgramAssociations as (generalStudentProgramAssociationReference as (beginDate as date, educationOrganizationId as integer, programEducationOrganizationId as integer, programName as string, programTypeDescriptor as string, studentUniqueId as string, link as (rel as string, href as string)))[],",
						"          studentSectionAssociations as (studentSectionAssociationReference as (beginDate as date, localCourseCode as string, schoolId as integer, schoolYear as integer, sectionIdentifier as string, sessionName as string, studentUniqueId as string, link as (rel as string, href as string)))[],",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          gradingPeriodDescriptor = gradingPeriodReference.gradingPeriodDescriptor,",
						"          periodSequence = gradingPeriodReference.periodSequence,",
						"          schoolId = gradingPeriodReference.schoolId,",
						"          schoolYear = gradingPeriodReference.schoolYear,",
						"          objective = objectiveCompetencyObjectiveReference.objective,",
						"          objectiveGradeLevelDescriptor = objectiveCompetencyObjectiveReference.objectiveGradeLevelDescriptor,",
						"          studentUniqueId = studentReference.studentUniqueId,",
						"          competencyLevelDescriptor,",
						"          diagnosticStatement,",
						"          generalStudentProgramAssociations,",
						"          studentSectionAssociations,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_studentDisciplineIncidentAssociations')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('studentDisciplineIncidentAssociations'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          disciplineIncidentReference as (incidentIdentifier as string, schoolId as integer, link as (rel as string, href as string)),",
						"          studentReference as (studentUniqueId as string, link as (rel as string, href as string)),",
						"          behaviors as (behaviorDescriptor as string, behaviorDetailedDescription as string)[],",
						"          studentParticipationCodeDescriptor as string,",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          schoolId = disciplineIncidentReference.schoolId,",
						"          incidentIdentifier = disciplineIncidentReference.incidentIdentifier,",
						"          studentUniqueId = studentReference.studentUniqueId,",
						"          behaviors,",
						"          studentParticipationCodeDescriptor,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_studentDisciplineIncidentBehaviorAssociations')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('studentDisciplineIncidentBehaviorAssociations'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          behaviorDescriptor as string,",
						"          disciplineIncidentReference as (incidentIdentifier as string, schoolId as integer, link as (rel as string, href as string)),",
						"          studentReference as (studentUniqueId as string, link as (rel as string, href as string)),",
						"          behaviorDetailedDescription as string,",
						"          disciplineIncidentParticipationCodes as (disciplineIncidentParticipationCodeDescriptor as string)[],",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          behaviorDescriptor,",
						"          schoolId = disciplineIncidentReference.schoolId,",
						"          incidentIdentifier = disciplineIncidentReference.incidentIdentifier,",
						"          studentUniqueId = studentReference.studentUniqueId,",
						"          behaviorDetailedDescription,",
						"          disciplineIncidentParticipationCodes,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_studentDisciplineIncidentNonOffenderAssociations')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('studentDisciplineIncidentNonOffenderAssociations'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          disciplineIncidentReference as (incidentIdentifier as string, schoolId as integer, link as (rel as string, href as string)),",
						"          studentReference as (studentUniqueId as string, link as (rel as string, href as string)),",
						"          disciplineIncidentParticipationCodes as (disciplineIncidentParticipationCodeDescriptor as string)[],",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          schoolId = disciplineIncidentReference.schoolId,",
						"          incidentIdentifier = disciplineIncidentReference.incidentIdentifier,",
						"          studentUniqueId = studentReference.studentUniqueId,",
						"          disciplineIncidentParticipationCodes,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_studentEducationOrganizationAssociations')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('studentEducationOrganizationAssociations'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          educationOrganizationReference as (educationOrganizationId as integer, link as (rel as string, href as string)),",
						"          studentReference as (studentUniqueId as string, link as (rel as string, href as string)),",
						"          addresses as (addressTypeDescriptor as string, stateAbbreviationDescriptor as string, city as string, postalCode as string, streetNumberName as string, localeDescriptor as string, apartmentRoomSuiteNumber as string, buildingSiteNumber as string, congressionalDistrict as string, countyFIPSCode as string, doNotPublishIndicator as boolean, latitude as string, longitude as string, nameOfCounty as string, periods as (beginDate as date, endDate as date)[])[],",
						"          ancestryEthnicOrigins as (ancestryEthnicOriginDescriptor as string)[],",
						"          barrierToInternetAccessInResidenceDescriptor as string,",
						"          cohortYears as (cohortYearTypeDescriptor as string, termDescriptor as string, schoolYearTypeReference as (schoolYear as integer, link as (rel as string, href as string)))[],",
						"          disabilities as (disabilityDescriptor as string, disabilityDeterminationSourceTypeDescriptor as string, disabilityDiagnosis as string, orderOfDisability as integer, designations as (disabilityDesignationDescriptor as string)[])[],",
						"          electronicMails as (electronicMailTypeDescriptor as string, electronicMailAddress as string, doNotPublishIndicator as boolean, primaryEmailAddressIndicator as boolean)[],",
						"          hispanicLatinoEthnicity as boolean,",
						"          internationalAddresses as (addressTypeDescriptor as string, countryDescriptor as string, addressLine1 as string, addressLine2 as string, addressLine3 as string, addressLine4 as string, beginDate as date, endDate as date, latitude as string, longitude as string)[],",
						"          internetAccessInResidence as boolean,",
						"          internetAccessTypeInResidenceDescriptor as string,",
						"          internetPerformanceInResidenceDescriptor as string,",
						"          languages as (languageDescriptor as string, uses as (languageUseDescriptor as string)[])[],",
						"          limitedEnglishProficiencyDescriptor as string,",
						"          loginId as string,",
						"          oldEthnicityDescriptor as string,",
						"          primaryLearningDeviceAccessDescriptor as string,",
						"          primaryLearningDeviceAwayFromSchoolDescriptor as string,",
						"          primaryLearningDeviceProviderDescriptor as string,",
						"          profileThumbnail as string,",
						"          programParticipations as (programTypeDescriptor as string, beginDate as date, designatedBy as string, endDate as date, programCharacteristics as (programCharacteristicDescriptor as string)[])[],",
						"          races as (raceDescriptor as string)[],",
						"          sexDescriptor as string,",
						"          studentCharacteristics as (studentCharacteristicDescriptor as string, designatedBy as string, periods as (beginDate as date, endDate as date)[])[],",
						"          studentIdentificationCodes as (studentIdentificationSystemDescriptor as string, assigningOrganizationIdentificationCode as string, identificationCode as string)[],",
						"          studentIndicators as (indicatorName as string, designatedBy as string, indicator as string, indicatorGroup as string, periods as (beginDate as date, endDate as date)[])[],",
						"          telephones as (telephoneNumberTypeDescriptor as string, telephoneNumber as string, doNotPublishIndicator as boolean, orderOfPriority as integer, textMessageCapabilityIndicator as boolean)[],",
						"          tribalAffiliations as (tribalAffiliationDescriptor as string)[],",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          educationOrganizationId = educationOrganizationReference.educationOrganizationId,",
						"          studentUniqueId = studentReference.studentUniqueId,",
						"          addresses,",
						"          ancestryEthnicOrigins,",
						"          barrierToInternetAccessInResidenceDescriptor,",
						"          cohortYears,",
						"          disabilities,",
						"          electronicMails,",
						"          hispanicLatinoEthnicity,",
						"          internationalAddresses,",
						"          internetAccessInResidence,",
						"          internetAccessTypeInResidenceDescriptor,",
						"          internetPerformanceInResidenceDescriptor,",
						"          languages,",
						"          limitedEnglishProficiencyDescriptor,",
						"          loginId,",
						"          oldEthnicityDescriptor,",
						"          primaryLearningDeviceAccessDescriptor,",
						"          primaryLearningDeviceAwayFromSchoolDescriptor,",
						"          primaryLearningDeviceProviderDescriptor,",
						"          profileThumbnail,",
						"          programParticipations,",
						"          races,",
						"          sexDescriptor,",
						"          studentCharacteristics,",
						"          studentIdentificationCodes,",
						"          studentIndicators,",
						"          telephones,",
						"          tribalAffiliations,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_studentEducationOrganizationResponsibilityAssociations')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('studentEducationOrganizationResponsibilityAssociations'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          beginDate as date,",
						"          responsibilityDescriptor as string,",
						"          educationOrganizationReference as (educationOrganizationId as integer, link as (rel as string, href as string)),",
						"          studentReference as (studentUniqueId as string, link as (rel as string, href as string)),",
						"          endDate as date,",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          beginDate,",
						"          responsibilityDescriptor,",
						"          educationOrganizationId = educationOrganizationReference.educationOrganizationId,",
						"          studentUniqueId = studentReference.studentUniqueId,",
						"          endDate,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_studentGradebookEntries')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('studentGradebookEntries'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          gradebookEntryReference as (dateAssigned as date, gradebookEntryTitle as string, localCourseCode as string, schoolId as integer, schoolYear as integer, sectionIdentifier as string, sessionName as string, link as (rel as string, href as string)),",
						"          studentSectionAssociationReference as (beginDate as date, localCourseCode as string, schoolId as integer, schoolYear as integer, sectionIdentifier as string, sessionName as string, studentUniqueId as string, link as (rel as string, href as string)),",
						"          competencyLevelDescriptor as string,",
						"          dateFulfilled as date,",
						"          diagnosticStatement as string,",
						"          letterGradeEarned as string,",
						"          numericGradeEarned as float,",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          gradebookEntryReference,",
						"          studentSectionAssociationReference,",
						"          competencyLevelDescriptor,",
						"          dateFulfilled,",
						"          diagnosticStatement,",
						"          letterGradeEarned,",
						"          numericGradeEarned,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_studentHomelessProgramAssociations')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('studentHomelessProgramAssociations'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          beginDate as date,",
						"          educationOrganizationReference as (educationOrganizationId as integer, link as (rel as string, href as string)),",
						"          programReference as (educationOrganizationId as integer, programName as string, programTypeDescriptor as string, link as (rel as string, href as string)),",
						"          studentReference as (studentUniqueId as string, link as (rel as string, href as string)),",
						"          awaitingFosterCare as boolean,",
						"          endDate as date,",
						"          homelessPrimaryNighttimeResidenceDescriptor as string,",
						"          homelessProgramServices as (homelessProgramServiceDescriptor as string, primaryIndicator as boolean, serviceBeginDate as date, serviceEndDate as date)[],",
						"          homelessUnaccompaniedYouth as boolean,",
						"          participationStatus as (participationStatusDescriptor as string, designatedBy as string, statusBeginDate as date, statusEndDate as date),",
						"          programParticipationStatuses as (participationStatusDescriptor as string, statusBeginDate as date, designatedBy as string, statusEndDate as date)[],",
						"          reasonExitedDescriptor as string,",
						"          servedOutsideOfRegularSession as boolean,",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          beginDate,",
						"          educationOrganizationId = educationOrganizationReference.educationOrganizationId,",
						"          programName = programReference.programName,",
						"          programTypeDescriptor = programReference.programTypeDescriptor,",
						"          studentUniqueId = studentReference.studentUniqueId,",
						"          awaitingFosterCare,",
						"          endDate,",
						"          homelessPrimaryNighttimeResidenceDescriptor,",
						"          homelessProgramServices,",
						"          homelessUnaccompaniedYouth,",
						"          participationStatus,",
						"          programParticipationStatuses,",
						"          reasonExitedDescriptor,",
						"          servedOutsideOfRegularSession,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_studentInterventionAssociations')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('studentInterventionAssociations'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          cohortReference as (cohortIdentifier as string, educationOrganizationId as integer, link as (rel as string, href as string)),",
						"          interventionReference as (educationOrganizationId as integer, interventionIdentificationCode as string, link as (rel as string, href as string)),",
						"          studentReference as (studentUniqueId as string, link as (rel as string, href as string)),",
						"          diagnosticStatement as string,",
						"          dosage as integer,",
						"          interventionEffectivenesses as (diagnosisDescriptor as string, gradeLevelDescriptor as string, populationServedDescriptor as string, interventionEffectivenessRatingDescriptor as string, improvementIndex as integer)[],",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          cohortIdentifier = cohortReference.cohortIdentifier,",
						"          educationOrganizationId = cohortReference.educationOrganizationId,",
						"          interventionIdentificationCode = interventionReference.interventionIdentificationCode,",
						"          studentUniqueId = studentReference.studentUniqueId,",
						"          diagnosticStatement,",
						"          dosage,",
						"          interventionEffectivenesses,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_studentInterventionAttendanceEvents')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('studentInterventionAttendanceEvents'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          attendanceEventCategoryDescriptor as string,",
						"          eventDate as date,",
						"          interventionReference as (educationOrganizationId as integer, interventionIdentificationCode as string, link as (rel as string, href as string)),",
						"          studentReference as (studentUniqueId as string, link as (rel as string, href as string)),",
						"          attendanceEventReason as string,",
						"          educationalEnvironmentDescriptor as string,",
						"          eventDuration as float,",
						"          interventionDuration as integer,",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          attendanceEventCategoryDescriptor,",
						"          eventDate,",
						"          interventionIdentificationCode = interventionReference.interventionIdentificationCode,",
						"          educationOrganizationId = interventionReference.educationOrganizationId,",
						"          studentUniqueId = studentReference.studentUniqueId,",
						"          attendanceEventReason,",
						"          educationalEnvironmentDescriptor,",
						"          eventDuration,",
						"          interventionDuration,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_studentLanguageInstructionProgramAssociations')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('studentLanguageInstructionProgramAssociations'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          beginDate as date,",
						"          educationOrganizationReference as (educationOrganizationId as integer, link as (rel as string, href as string)),",
						"          programReference as (educationOrganizationId as integer, programName as string, programTypeDescriptor as string, link as (rel as string, href as string)),",
						"          studentReference as (studentUniqueId as string, link as (rel as string, href as string)),",
						"          dosage as integer,",
						"          endDate as date,",
						"          englishLanguageProficiencyAssessments as (monitoredDescriptor as string, participationDescriptor as string, proficiencyDescriptor as string, progressDescriptor as string, schoolYearTypeReference as (schoolYear as integer, link as (rel as string, href as string)))[],",
						"          englishLearnerParticipation as boolean,",
						"          languageInstructionProgramServices as (languageInstructionProgramServiceDescriptor as string, primaryIndicator as boolean, serviceBeginDate as date, serviceEndDate as date)[],",
						"          participationStatus as (participationStatusDescriptor as string, designatedBy as string, statusBeginDate as date, statusEndDate as date),",
						"          programParticipationStatuses as (participationStatusDescriptor as string, statusBeginDate as date, designatedBy as string, statusEndDate as date)[],",
						"          reasonExitedDescriptor as string,",
						"          servedOutsideOfRegularSession as boolean,",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          beginDate,",
						"          educationOrganizationId = educationOrganizationReference.educationOrganizationId,",
						"          programName = programReference.programName,",
						"          programTypeDescriptor = programReference.programTypeDescriptor,",
						"          studentUniqueId = studentReference.studentUniqueId,",
						"          dosage,",
						"          endDate,",
						"          englishLanguageProficiencyAssessments,",
						"          englishLearnerParticipation,",
						"          languageInstructionProgramServices,",
						"          participationStatus,",
						"          programParticipationStatuses,",
						"          reasonExitedDescriptor,",
						"          servedOutsideOfRegularSession,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_studentLearningObjectives')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('studentLearningObjectives'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          gradingPeriodReference as (gradingPeriodDescriptor as string, periodSequence as integer, schoolId as integer, schoolYear as integer, link as (rel as string, href as string)),",
						"          learningObjectiveReference as (learningObjectiveId as string, namespace as string, link as (rel as string, href as string)),",
						"          studentReference as (studentUniqueId as string, link as (rel as string, href as string)),",
						"          competencyLevelDescriptor as string,",
						"          diagnosticStatement as string,",
						"          generalStudentProgramAssociations as (generalStudentProgramAssociationReference as (beginDate as date, educationOrganizationId as integer, programEducationOrganizationId as integer, programName as string, programTypeDescriptor as string, studentUniqueId as string, link as (rel as string, href as string)))[],",
						"          studentSectionAssociations as (studentSectionAssociationReference as (beginDate as date, localCourseCode as string, schoolId as integer, schoolYear as integer, sectionIdentifier as string, sessionName as string, studentUniqueId as string, link as (rel as string, href as string)))[],",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          gradingPeriodReference,",
						"          learningObjectiveReference,",
						"          studentReference,",
						"          competencyLevelDescriptor,",
						"          diagnosticStatement,",
						"          generalStudentProgramAssociations,",
						"          studentSectionAssociations,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_studentMigrantEducationProgramAssociations')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('studentMigrantEducationProgramAssociations'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          beginDate as date,",
						"          educationOrganizationReference as (educationOrganizationId as integer, link as (rel as string, href as string)),",
						"          programReference as (educationOrganizationId as integer, programName as string, programTypeDescriptor as string, link as (rel as string, href as string)),",
						"          studentReference as (studentUniqueId as string, link as (rel as string, href as string)),",
						"          continuationOfServicesReasonDescriptor as string,",
						"          eligibilityExpirationDate as date,",
						"          endDate as date,",
						"          lastQualifyingMove as date,",
						"          migrantEducationProgramServices as (migrantEducationProgramServiceDescriptor as string, primaryIndicator as boolean, serviceBeginDate as date, serviceEndDate as date)[],",
						"          participationStatus as (participationStatusDescriptor as string, designatedBy as string, statusBeginDate as date, statusEndDate as date),",
						"          priorityForServices as boolean,",
						"          programParticipationStatuses as (participationStatusDescriptor as string, statusBeginDate as date, designatedBy as string, statusEndDate as date)[],",
						"          qualifyingArrivalDate as date,",
						"          reasonExitedDescriptor as string,",
						"          servedOutsideOfRegularSession as boolean,",
						"          stateResidencyDate as date,",
						"          usInitialEntry as date,",
						"          usInitialSchoolEntry as date,",
						"          usMostRecentEntry as date,",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          beginDate,",
						"          educationOrganizationReference,",
						"          programReference,",
						"          studentReference,",
						"          continuationOfServicesReasonDescriptor,",
						"          eligibilityExpirationDate,",
						"          endDate,",
						"          lastQualifyingMove,",
						"          migrantEducationProgramServices,",
						"          participationStatus,",
						"          priorityForServices,",
						"          programParticipationStatuses,",
						"          qualifyingArrivalDate,",
						"          reasonExitedDescriptor,",
						"          servedOutsideOfRegularSession,",
						"          stateResidencyDate,",
						"          usInitialEntry,",
						"          usInitialSchoolEntry,",
						"          usMostRecentEntry,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_studentNeglectedOrDelinquentProgramAssociations')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('studentNeglectedOrDelinquentProgramAssociations'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          beginDate as date,",
						"          educationOrganizationReference as (educationOrganizationId as integer, link as (rel as string, href as string)),",
						"          programReference as (educationOrganizationId as integer, programName as string, programTypeDescriptor as string, link as (rel as string, href as string)),",
						"          studentReference as (studentUniqueId as string, link as (rel as string, href as string)),",
						"          elaProgressLevelDescriptor as string,",
						"          endDate as date,",
						"          mathematicsProgressLevelDescriptor as string,",
						"          neglectedOrDelinquentProgramDescriptor as string,",
						"          neglectedOrDelinquentProgramServices as (neglectedOrDelinquentProgramServiceDescriptor as string, primaryIndicator as boolean, serviceBeginDate as date, serviceEndDate as date)[],",
						"          participationStatus as (participationStatusDescriptor as string, designatedBy as string, statusBeginDate as date, statusEndDate as date),",
						"          programParticipationStatuses as (participationStatusDescriptor as string, statusBeginDate as date, designatedBy as string, statusEndDate as date)[],",
						"          reasonExitedDescriptor as string,",
						"          servedOutsideOfRegularSession as boolean,",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          beginDate,",
						"          educationOrganizationReference,",
						"          programReference,",
						"          studentReference,",
						"          elaProgressLevelDescriptor,",
						"          endDate,",
						"          mathematicsProgressLevelDescriptor,",
						"          neglectedOrDelinquentProgramDescriptor,",
						"          neglectedOrDelinquentProgramServices,",
						"          participationStatus,",
						"          programParticipationStatuses,",
						"          reasonExitedDescriptor,",
						"          servedOutsideOfRegularSession,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_studentParentAssociations')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('studentParentAssociations'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          parentReference as (parentUniqueId as string, link as (rel as string, href as string)),",
						"          studentReference as (studentUniqueId as string, link as (rel as string, href as string)),",
						"          contactPriority as integer,",
						"          contactRestrictions as string,",
						"          emergencyContactStatus as boolean,",
						"          legalGuardian as boolean,",
						"          livesWith as boolean,",
						"          primaryContactStatus as boolean,",
						"          relationDescriptor as string,",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          parentReference,",
						"          studentReference,",
						"          contactPriority,",
						"          contactRestrictions,",
						"          emergencyContactStatus,",
						"          legalGuardian,",
						"          livesWith,",
						"          primaryContactStatus,",
						"          relationDescriptor,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_studentProgramAssociations')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('studentProgramAssociations'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          beginDate as date,",
						"          educationOrganizationReference as (educationOrganizationId as integer, link as (rel as string, href as string)),",
						"          programReference as (educationOrganizationId as integer, programName as string, programTypeDescriptor as string, link as (rel as string, href as string)),",
						"          studentReference as (studentUniqueId as string, link as (rel as string, href as string)),",
						"          endDate as date,",
						"          participationStatus as (participationStatusDescriptor as string, designatedBy as string, statusBeginDate as date, statusEndDate as date),",
						"          programParticipationStatuses as (participationStatusDescriptor as string, statusBeginDate as date, designatedBy as string, statusEndDate as date)[],",
						"          reasonExitedDescriptor as string,",
						"          servedOutsideOfRegularSession as boolean,",
						"          services as (serviceDescriptor as string, primaryIndicator as boolean, serviceBeginDate as date, serviceEndDate as date)[],",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          beginDate,",
						"          educationOrganizationReference,",
						"          programReference,",
						"          studentReference,",
						"          endDate,",
						"          participationStatus,",
						"          programParticipationStatuses,",
						"          reasonExitedDescriptor,",
						"          servedOutsideOfRegularSession,",
						"          services,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_studentProgramAttendanceEvents')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('studentProgramAttendanceEvents'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          attendanceEventCategoryDescriptor as string,",
						"          eventDate as date,",
						"          educationOrganizationReference as (educationOrganizationId as integer, link as (rel as string, href as string)),",
						"          programReference as (educationOrganizationId as integer, programName as string, programTypeDescriptor as string, link as (rel as string, href as string)),",
						"          studentReference as (studentUniqueId as string, link as (rel as string, href as string)),",
						"          attendanceEventReason as string,",
						"          educationalEnvironmentDescriptor as string,",
						"          eventDuration as float,",
						"          programAttendanceDuration as integer,",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          attendanceEventCategoryDescriptor,",
						"          eventDate,",
						"          educationOrganizationReference,",
						"          programReference,",
						"          studentReference,",
						"          attendanceEventReason,",
						"          educationalEnvironmentDescriptor,",
						"          eventDuration,",
						"          programAttendanceDuration,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_studentSchoolAssociations')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('studentSchoolAssociations'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          entryDate as date,",
						"          calendarReference as (calendarCode as string, schoolId as integer, schoolYear as integer, link as (rel as string, href as string)),",
						"          classOfSchoolYearTypeReference as (schoolYear as integer, link as (rel as string, href as string)),",
						"          graduationPlanReference as (educationOrganizationId as integer, graduationPlanTypeDescriptor as string, graduationSchoolYear as integer, link as (rel as string, href as string)),",
						"          schoolReference as (schoolId as integer, link as (rel as string, href as string)),",
						"          schoolYearTypeReference as (schoolYear as integer, link as (rel as string, href as string)),",
						"          studentReference as (studentUniqueId as string, link as (rel as string, href as string)),",
						"          alternativeGraduationPlans as (alternativeGraduationPlanReference as (educationOrganizationId as integer, graduationPlanTypeDescriptor as string, graduationSchoolYear as integer, link as (rel as string, href as string)))[],",
						"          educationPlans as (educationPlanDescriptor as string)[],",
						"          employedWhileEnrolled as boolean,",
						"          entryGradeLevelDescriptor as string,",
						"          entryGradeLevelReasonDescriptor as string,",
						"          entryTypeDescriptor as string,",
						"          exitWithdrawDate as date,",
						"          exitWithdrawTypeDescriptor as string,",
						"          fullTimeEquivalency as float,",
						"          primarySchool as boolean,",
						"          repeatGradeIndicator as boolean,",
						"          residencyStatusDescriptor as string,",
						"          schoolChoiceTransfer as boolean,",
						"          termCompletionIndicator as boolean,",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          entryDate,",
						"          calendarReference,",
						"          classOfSchoolYearTypeReference,",
						"          graduationPlanReference,",
						"          schoolId = schoolReference.schoolId,",
						"          schoolYear = schoolYearTypeReference.schoolYear,",
						"          studentUniqueId = studentReference.studentUniqueId,",
						"          alternativeGraduationPlans,",
						"          educationPlans,",
						"          employedWhileEnrolled,",
						"          entryGradeLevelDescriptor,",
						"          entryGradeLevelReasonDescriptor,",
						"          entryTypeDescriptor,",
						"          exitWithdrawDate,",
						"          exitWithdrawTypeDescriptor,",
						"          fullTimeEquivalency,",
						"          primarySchool,",
						"          repeatGradeIndicator,",
						"          residencyStatusDescriptor,",
						"          schoolChoiceTransfer,",
						"          termCompletionIndicator,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_studentSchoolAttendanceEvents')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('studentSchoolAttendanceEvents'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          attendanceEventCategoryDescriptor as string,",
						"          eventDate as date,",
						"          schoolReference as (schoolId as integer, link as (rel as string, href as string)),",
						"          sessionReference as (schoolId as integer, schoolYear as integer, sessionName as string, link as (rel as string, href as string)),",
						"          studentReference as (studentUniqueId as string, link as (rel as string, href as string)),",
						"          arrivalTime as string,",
						"          attendanceEventReason as string,",
						"          departureTime as string,",
						"          educationalEnvironmentDescriptor as string,",
						"          eventDuration as float,",
						"          schoolAttendanceDuration as integer,",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          attendanceEventCategoryDescriptor,",
						"          eventDate,",
						"          schoolReference,",
						"          sessionReference,",
						"          studentReference,",
						"          arrivalTime,",
						"          attendanceEventReason,",
						"          departureTime,",
						"          educationalEnvironmentDescriptor,",
						"          eventDuration,",
						"          schoolAttendanceDuration,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_studentSchoolFoodServiceProgramAssociations')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('studentSchoolFoodServiceProgramAssociations'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          beginDate as date,",
						"          educationOrganizationReference as (educationOrganizationId as integer, link as (rel as string, href as string)),",
						"          programReference as (educationOrganizationId as integer, programName as string, programTypeDescriptor as string, link as (rel as string, href as string)),",
						"          studentReference as (studentUniqueId as string, link as (rel as string, href as string)),",
						"          directCertification as boolean,",
						"          endDate as date,",
						"          participationStatus as (participationStatusDescriptor as string, designatedBy as string, statusBeginDate as date, statusEndDate as date),",
						"          programParticipationStatuses as (participationStatusDescriptor as string, statusBeginDate as date, designatedBy as string, statusEndDate as date)[],",
						"          reasonExitedDescriptor as string,",
						"          schoolFoodServiceProgramServices as (schoolFoodServiceProgramServiceDescriptor as string, primaryIndicator as boolean, serviceBeginDate as date, serviceEndDate as date)[],",
						"          servedOutsideOfRegularSession as boolean,",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          beginDate,",
						"          educationOrganizationReference,",
						"          programReference,",
						"          studentReference,",
						"          directCertification,",
						"          endDate,",
						"          participationStatus,",
						"          programParticipationStatuses,",
						"          reasonExitedDescriptor,",
						"          schoolFoodServiceProgramServices,",
						"          servedOutsideOfRegularSession,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_studentSectionAssociations')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('studentSectionAssociations'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          beginDate as date,",
						"          sectionReference as (localCourseCode as string, schoolId as integer, schoolYear as integer, sectionIdentifier as string, sessionName as string, link as (rel as string, href as string)),",
						"          studentReference as (studentUniqueId as string, link as (rel as string, href as string)),",
						"          attemptStatusDescriptor as string,",
						"          endDate as date,",
						"          homeroomIndicator as boolean,",
						"          repeatIdentifierDescriptor as string,",
						"          teacherStudentDataLinkExclusion as boolean,",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          beginDate,",
						"          sessionName = sectionReference.sessionName,",
						"          sectionIdentifier = sectionReference.sectionIdentifier,",
						"          schoolYear = sectionReference.schoolYear,",
						"          schoolId = sectionReference.schoolId,",
						"          localCourseCode = sectionReference.localCourseCode,",
						"          studentUniqueId = studentReference.studentUniqueId,",
						"          attemptStatusDescriptor,",
						"          endDate,",
						"          homeroomIndicator,",
						"          repeatIdentifierDescriptor,",
						"          teacherStudentDataLinkExclusion,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_studentSectionAttendanceEvents')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('studentSectionAttendanceEvents'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          attendanceEventCategoryDescriptor as string,",
						"          eventDate as date,",
						"          sectionReference as (localCourseCode as string, schoolId as integer, schoolYear as integer, sectionIdentifier as string, sessionName as string, link as (rel as string, href as string)),",
						"          studentReference as (studentUniqueId as string, link as (rel as string, href as string)),",
						"          arrivalTime as string,",
						"          attendanceEventReason as string,",
						"          classPeriods as (classPeriodReference as (classPeriodName as string, schoolId as integer, link as (rel as string, href as string)))[],",
						"          departureTime as string,",
						"          educationalEnvironmentDescriptor as string,",
						"          eventDuration as float,",
						"          sectionAttendanceDuration as integer,",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          attendanceEventCategoryDescriptor,",
						"          eventDate,",
						"          sectionReference,",
						"          studentReference,",
						"          arrivalTime,",
						"          attendanceEventReason,",
						"          classPeriods,",
						"          departureTime,",
						"          educationalEnvironmentDescriptor,",
						"          eventDuration,",
						"          sectionAttendanceDuration,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_studentSpecialEducationProgramAssociations')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('studentSpecialEducationProgramAssociations'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          beginDate as date,",
						"          educationOrganizationReference as (educationOrganizationId as integer, link as (rel as string, href as string)),",
						"          programReference as (educationOrganizationId as integer, programName as string, programTypeDescriptor as string, link as (rel as string, href as string)),",
						"          studentReference as (studentUniqueId as string, link as (rel as string, href as string)),",
						"          disabilities as (disabilityDescriptor as string, disabilityDeterminationSourceTypeDescriptor as string, disabilityDiagnosis as string, orderOfDisability as integer, designations as (disabilityDesignationDescriptor as string)[])[],",
						"          endDate as date,",
						"          ideaEligibility as boolean,",
						"          iepBeginDate as date,",
						"          iepEndDate as date,",
						"          iepReviewDate as date,",
						"          lastEvaluationDate as date,",
						"          medicallyFragile as boolean,",
						"          multiplyDisabled as boolean,",
						"          participationStatus as (participationStatusDescriptor as string, designatedBy as string, statusBeginDate as date, statusEndDate as date),",
						"          programParticipationStatuses as (participationStatusDescriptor as string, statusBeginDate as date, designatedBy as string, statusEndDate as date)[],",
						"          reasonExitedDescriptor as string,",
						"          schoolHoursPerWeek as float,",
						"          servedOutsideOfRegularSession as boolean,",
						"          serviceProviders as (primaryProvider as boolean, staffReference as (staffUniqueId as string, link as (rel as string, href as string)))[],",
						"          specialEducationHoursPerWeek as float,",
						"          specialEducationProgramServices as (specialEducationProgramServiceDescriptor as string, primaryIndicator as boolean, serviceBeginDate as date, serviceEndDate as date, providers as (primaryProvider as boolean, staffReference as (staffUniqueId as string, link as (rel as string, href as string)))[])[],",
						"          specialEducationSettingDescriptor as string,",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          beginDate,",
						"          educationOrganizationReference,",
						"          programReference,",
						"          studentReference,",
						"          disabilities,",
						"          endDate,",
						"          ideaEligibility,",
						"          iepBeginDate,",
						"          iepEndDate,",
						"          iepReviewDate,",
						"          lastEvaluationDate,",
						"          medicallyFragile,",
						"          multiplyDisabled,",
						"          participationStatus,",
						"          programParticipationStatuses,",
						"          reasonExitedDescriptor,",
						"          schoolHoursPerWeek,",
						"          servedOutsideOfRegularSession,",
						"          serviceProviders,",
						"          specialEducationHoursPerWeek,",
						"          specialEducationProgramServices,",
						"          specialEducationSettingDescriptor,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_studentTitleIPartAProgramAssociations')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('studentTitleIPartAProgramAssociations'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          beginDate as date,",
						"          educationOrganizationReference as (educationOrganizationId as integer, link as (rel as string, href as string)),",
						"          programReference as (educationOrganizationId as integer, programName as string, programTypeDescriptor as string, link as (rel as string, href as string)),",
						"          studentReference as (studentUniqueId as string, link as (rel as string, href as string)),",
						"          endDate as date,",
						"          participationStatus as (participationStatusDescriptor as string, designatedBy as string, statusBeginDate as date, statusEndDate as date),",
						"          programParticipationStatuses as (participationStatusDescriptor as string, statusBeginDate as date, designatedBy as string, statusEndDate as date)[],",
						"          reasonExitedDescriptor as string,",
						"          servedOutsideOfRegularSession as boolean,",
						"          services as (serviceDescriptor as string, primaryIndicator as boolean, serviceBeginDate as date, serviceEndDate as date)[],",
						"          titleIPartAParticipantDescriptor as string,",
						"          titleIPartAProgramServices as (titleIPartAProgramServiceDescriptor as string, primaryIndicator as boolean, serviceBeginDate as date, serviceEndDate as date)[],",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          beginDate,",
						"          educationOrganizationReference,",
						"          programReference,",
						"          studentReference,",
						"          endDate,",
						"          participationStatus,",
						"          programParticipationStatuses,",
						"          reasonExitedDescriptor,",
						"          servedOutsideOfRegularSession,",
						"          services,",
						"          titleIPartAParticipantDescriptor,",
						"          titleIPartAProgramServices,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_students')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('students'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          studentUniqueId as string,",
						"          personReference as (personId as string, sourceSystemDescriptor as string, link as (rel as string, href as string)),",
						"          birthCity as string,",
						"          birthCountryDescriptor as string,",
						"          birthDate as date,",
						"          birthInternationalProvince as string,",
						"          birthSexDescriptor as string,",
						"          birthStateAbbreviationDescriptor as string,",
						"          citizenshipStatusDescriptor as string,",
						"          dateEnteredUS as date,",
						"          firstName as string,",
						"          generationCodeSuffix as string,",
						"          identificationDocuments as (identificationDocumentUseDescriptor as string, personalInformationVerificationDescriptor as string, issuerCountryDescriptor as string, documentExpirationDate as date, documentTitle as string, issuerDocumentIdentificationCode as string, issuerName as string)[],",
						"          lastSurname as string,",
						"          maidenName as string,",
						"          middleName as string,",
						"          multipleBirthStatus as boolean,",
						"          otherNames as (otherNameTypeDescriptor as string, firstName as string, generationCodeSuffix as string, lastSurname as string, middleName as string, personalTitlePrefix as string)[],",
						"          personalIdentificationDocuments as (identificationDocumentUseDescriptor as string, personalInformationVerificationDescriptor as string, issuerCountryDescriptor as string, documentExpirationDate as date, documentTitle as string, issuerDocumentIdentificationCode as string, issuerName as string)[],",
						"          personalTitlePrefix as string,",
						"          visas as (visaDescriptor as string)[],",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          studentUniqueId,",
						"          personId = personReference.personId,",
						"          birthCity,",
						"          birthCountryDescriptor,",
						"          birthDate,",
						"          birthInternationalProvince,",
						"          birthSexDescriptor,",
						"          birthStateAbbreviationDescriptor,",
						"          citizenshipStatusDescriptor,",
						"          dateEnteredUS,",
						"          firstName,",
						"          generationCodeSuffix,",
						"          identificationDocuments,",
						"          lastSurname,",
						"          maidenName,",
						"          middleName,",
						"          multipleBirthStatus,",
						"          otherNames,",
						"          personalIdentificationDocuments,",
						"          personalTitlePrefix,",
						"          visas,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_surveyCourseAssociations')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('surveyCourseAssociations'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          courseReference as (courseCode as string, educationOrganizationId as integer, link as (rel as string, href as string)),",
						"          surveyReference as (namespace as string, surveyIdentifier as string, link as (rel as string, href as string)),",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          courseReference,",
						"          surveyReference,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_surveyProgramAssociations')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('surveyProgramAssociations'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          programReference as (educationOrganizationId as integer, programName as string, programTypeDescriptor as string, link as (rel as string, href as string)),",
						"          surveyReference as (namespace as string, surveyIdentifier as string, link as (rel as string, href as string)),",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          programReference,",
						"          surveyReference,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_surveyQuestionResponses')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('surveyQuestionResponses'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          surveyQuestionReference as (namespace as string, questionCode as string, surveyIdentifier as string, link as (rel as string, href as string)),",
						"          surveyResponseReference as (namespace as string, surveyIdentifier as string, surveyResponseIdentifier as string, link as (rel as string, href as string)),",
						"          comment as string,",
						"          noResponse as boolean,",
						"          surveyQuestionMatrixElementResponses as (matrixElement as string, maxNumericResponse as integer, minNumericResponse as integer, noResponse as boolean, numericResponse as integer, textResponse as string)[],",
						"          values as (surveyQuestionResponseValueIdentifier as integer, numericResponse as integer, textResponse as string)[],",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          surveyQuestionReference,",
						"          surveyResponseReference,",
						"          comment,",
						"          noResponse,",
						"          surveyQuestionMatrixElementResponses,",
						"          values,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_surveyQuestions')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('surveyQuestions'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          questionCode as string,",
						"          surveyReference as (namespace as string, surveyIdentifier as string, link as (rel as string, href as string)),",
						"          surveySectionReference as (namespace as string, surveyIdentifier as string, surveySectionTitle as string, link as (rel as string, href as string)),",
						"          matrices as (matrixElement as string, maxRawScore as integer, minRawScore as integer)[],",
						"          questionFormDescriptor as string,",
						"          questionText as string,",
						"          responseChoices as (sortOrder as integer, numericValue as integer, textValue as string)[],",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          questionCode,",
						"          surveyReference,",
						"          surveySectionReference,",
						"          matrices,",
						"          questionFormDescriptor,",
						"          questionText,",
						"          responseChoices,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_surveyResponseEducationOrganizationTargetAssociations')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('surveyResponseEducationOrganizationTargetAssociations'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          educationOrganizationReference as (educationOrganizationId as integer, link as (rel as string, href as string)),",
						"          surveyResponseReference as (namespace as string, surveyIdentifier as string, surveyResponseIdentifier as string, link as (rel as string, href as string)),",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          educationOrganizationReference,",
						"          surveyResponseReference,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_surveyResponsePersonTargetAssociations')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('surveyResponsePersonTargetAssociations'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          personReference as (personId as string, sourceSystemDescriptor as string, link as (rel as string, href as string)),",
						"          surveyResponseReference as (namespace as string, surveyIdentifier as string, surveyResponseIdentifier as string, link as (rel as string, href as string)),",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          personReference,",
						"          surveyResponseReference,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_surveyResponseStaffTargetAssociations')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('surveyResponseStaffTargetAssociations'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          staffReference as (staffUniqueId as string, link as (rel as string, href as string)),",
						"          surveyResponseReference as (namespace as string, surveyIdentifier as string, surveyResponseIdentifier as string, link as (rel as string, href as string)),",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          staffReference,",
						"          surveyResponseReference,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_surveyResponses')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('surveyResponses'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          surveyResponseIdentifier as string,",
						"          parentReference as (parentUniqueId as string, link as (rel as string, href as string)),",
						"          staffReference as (staffUniqueId as string, link as (rel as string, href as string)),",
						"          studentReference as (studentUniqueId as string, link as (rel as string, href as string)),",
						"          surveyReference as (namespace as string, surveyIdentifier as string, link as (rel as string, href as string)),",
						"          electronicMailAddress as string,",
						"          fullName as string,",
						"          location as string,",
						"          responseDate as date,",
						"          responseTime as integer,",
						"          surveyLevels as (surveyLevelDescriptor as string)[],",
						"          etag as string,",
						"          ext as (TPDM as (personReference as (personId as string, sourceSystemDescriptor as string, link as (rel as string, href as string))))",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          surveyResponseIdentifier,",
						"          parentReference,",
						"          staffReference,",
						"          studentReference,",
						"          surveyReference,",
						"          electronicMailAddress,",
						"          fullName,",
						"          location,",
						"          responseDate,",
						"          responseTime,",
						"          surveyLevels,",
						"          etag,",
						"          ext,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_surveySectionAssociations')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('surveySectionAssociations'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          sectionReference as (localCourseCode as string, schoolId as integer, schoolYear as integer, sectionIdentifier as string, sessionName as string, link as (rel as string, href as string)),",
						"          surveyReference as (namespace as string, surveyIdentifier as string, link as (rel as string, href as string)),",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          sectionReference,",
						"          surveyReference,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_surveySectionResponseEducationOrganizationTargetAssociations')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('surveySectionResponseEducationOrganizationTargetAssociations'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          educationOrganizationReference as (educationOrganizationId as integer, link as (rel as string, href as string)),",
						"          surveySectionResponseReference as (namespace as string, surveyIdentifier as string, surveyResponseIdentifier as string, surveySectionTitle as string, link as (rel as string, href as string)),",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          educationOrganizationReference,",
						"          surveySectionResponseReference,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_surveySectionResponsePersonTargetAssociations')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('surveySectionResponsePersonTargetAssociations'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          personReference as (personId as string, sourceSystemDescriptor as string, link as (rel as string, href as string)),",
						"          surveySectionResponseReference as (namespace as string, surveyIdentifier as string, surveyResponseIdentifier as string, surveySectionTitle as string, link as (rel as string, href as string)),",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          personReference,",
						"          surveySectionResponseReference,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_surveySectionResponseStaffTargetAssociations')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('surveySectionResponseStaffTargetAssociations'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          staffReference as (staffUniqueId as string, link as (rel as string, href as string)),",
						"          surveySectionResponseReference as (namespace as string, surveyIdentifier as string, surveyResponseIdentifier as string, surveySectionTitle as string, link as (rel as string, href as string)),",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          staffReference,",
						"          surveySectionResponseReference,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_surveySectionResponses')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('surveySectionResponses'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          surveyResponseReference as (namespace as string, surveyIdentifier as string, surveyResponseIdentifier as string, link as (rel as string, href as string)),",
						"          surveySectionReference as (namespace as string, surveyIdentifier as string, surveySectionTitle as string, link as (rel as string, href as string)),",
						"          sectionRating as float,",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          surveyResponseReference,",
						"          surveySectionReference,",
						"          sectionRating,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_surveySections')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('surveySections'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          surveySectionTitle as string,",
						"          surveyReference as (namespace as string, surveyIdentifier as string, link as (rel as string, href as string)),",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          surveySectionTitle,",
						"          surveyReference,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Upsert_surveys')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Generated"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJSON"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDELTA"
						}
					],
					"transformations": [
						{
							"name": "AlterConditions"
						},
						{
							"name": "SelectColumns"
						},
						{
							"name": "DerivedColumn"
						}
					],
					"scriptLines": [
						"parameters{",
						"     entity as string ('surveys'),",
						"     directory as string ('Latest'),",
						"     schoolYear as string ('2017'),",
						"     districtId as string ('255901')",
						"}",
						"source(output(",
						"          id as string,",
						"          namespace as string,",
						"          surveyIdentifier as string,",
						"          educationOrganizationReference as (educationOrganizationId as integer, link as (rel as string, href as string)),",
						"          schoolYearTypeReference as (schoolYear as integer, link as (rel as string, href as string)),",
						"          sessionReference as (schoolId as integer, schoolYear as integer, sessionName as string, link as (rel as string, href as string)),",
						"          numberAdministered as integer,",
						"          surveyCategoryDescriptor as string,",
						"          surveyTitle as string,",
						"          etag as string",
						"     ),",
						"     useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Landing/Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Delta/\"),",
						"     documentForm: 'documentPerLine') ~> SourceJSON",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterConditions",
						"DerivedColumn select(mapColumn(",
						"          id,",
						"          namespace,",
						"          surveyIdentifier,",
						"          educationOrganizationReference,",
						"          schoolYearTypeReference,",
						"          sessionReference,",
						"          numberAdministered,",
						"          surveyCategoryDescriptor,",
						"          surveyTitle,",
						"          etag,",
						"          LastModifiedDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"SourceJSON derive(LastModifiedDate = currentUTC()) ~> DerivedColumn",
						"AlterConditions sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Standardized/Transactional/{$directory}/v5.3/General/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}\"),",
						"     mergeSchema: false,",
						"     autoCompact: false,",
						"     optimizedWrite: true,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> SinkDELTA"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Credential1')]",
			"type": "Microsoft.Synapse/workspaces/credentials",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"type": "ManagedIdentity",
				"typeProperties": {
					"resourceId": "/subscriptions/7b9a4896-4541-483f-bdc7-d8f4ec6be3ee/resourceGroups/rg-oea-edfi/providers/Microsoft.ManagedIdentity/userAssignedIdentities/mi-oea-edfi"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/1_read_me')]",
			"type": "Microsoft.Synapse/workspaces/notebooks",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"nbformat": 4,
				"nbformat_minor": 2,
				"sessionProperties": {
					"driverMemory": "28g",
					"driverCores": 4,
					"executorMemory": "28g",
					"executorCores": 4,
					"numExecutors": 2,
					"conf": {
						"spark.dynamicAllocation.enabled": "false",
						"spark.dynamicAllocation.minExecutors": "2",
						"spark.dynamicAllocation.maxExecutors": "2",
						"spark.autotune.trackingId": "6d316148-a71f-4d6e-9c50-05b8dfad2bd2"
					}
				},
				"metadata": {
					"saveOutput": true,
					"enableDebugMode": false,
					"kernelspec": {
						"name": "synapse_pyspark",
						"display_name": "python"
					},
					"language_info": {
						"name": "python"
					},
					"sessionKeepAliveTimeout": 30
				},
				"cells": [
					{
						"cell_type": "markdown",
						"metadata": {
							"nteract": {
								"transient": {
									"deleting": false
								}
							}
						},
						"source": [
							"![OEA](https://openeducationanalytics.org/assets/imgs/img_oea_logo.png)\n",
							"# OEA and the OEA Framework\n",
							"\n",
							"[OEA](https://openeducationanalytics.org/) is the overarching community and ecosystem centered around the effective and responsible use of data and analytics in education.\n",
							"\n",
							"The [OEA framework](https://github.com/microsoft/OpenEduAnalytics/tree/main/framework) is an open source python library and synapse pipeline assets - built in collaboration with the OEA community - that simplifies the process of working with the data in your data lake in a way that follows a standardized data lake architecture and data processing best practices through use of [Apache Spark](https://spark.apache.org/) and [delta lake](https://delta.io/) technologies.\n",
							"\n",
							"Listed below are 3 included examples that demonstrate the usage of the OEA framework."
						]
					},
					{
						"cell_type": "markdown",
						"metadata": {
							"nteract": {
								"transient": {
									"deleting": false
								}
							}
						},
						"source": [
							""
						]
					},
					{
						"cell_type": "markdown",
						"source": [
							"# Example #1: End to end (collect, prep, view)\n",
							"The OEA framework comes with a set of Synapse pipelines that demonstrate how to extract data from data sources with common interfaces.\n",
							"\n",
							"By clicking on \"Integrate\" in the left nav bar and opening \"example_main_pipeline\" you can run an example pipeline that does the following:\n",
							"- 1. Retrieves data from an http endpoint\n",
							"- 2. Lands the data in the stage1np directory\n",
							"- 3. Ingests the data by first running a pseudonymization process, then writing pseudonymized data to delta tables in stage2p and writing non-pseudonymized data to delta tables in stage2np\n",
							"- 4. Creates a spark db that points to the delta tables in stage2p and stage2np\n",
							"- 5. Creates a sql serverless db with views pointing to the delta tables in stage2p and stage2np\n",
							"\n",
							"You can then run the pipeline in the Reset folder called \"reset_all_for_source\" to reset everything in the data lake that was done in the \"example_main_pipeline\"."
						]
					},
					{
						"cell_type": "markdown",
						"metadata": {
							"nteract": {
								"transient": {
									"deleting": false
								}
							}
						},
						"source": [
							"# Example #2: batch data processing\n",
							"The notebook **_2_batch_processing_demo_** provides a self-contained demonstration of landing and ingesting 3 different types of batch data sets:\n",
							"\n",
							"1. [Incremental data](https://github.com/microsoft/OpenEduAnalytics/tree/main/framework#1-incremental-data)\n",
							"2. [Delta data](https://github.com/microsoft/OpenEduAnalytics/tree/main/framework#2-delta-data-change-data)\n",
							"3. [Snapshot data](https://github.com/microsoft/OpenEduAnalytics/tree/main/framework#3-snapshot-data)\n",
							"\n",
							"Open that notebook and walk through each cell for the details."
						]
					},
					{
						"cell_type": "markdown",
						"metadata": {
							"nteract": {
								"transient": {
									"deleting": false
								}
							}
						},
						"source": [
							"# Example #3: data generation demo\n",
							"When learning to work synapse studio and the OEA framework, and when developing the data exploration and data prep scripts you need, it's especially helpful to have test data sets to work with.\n",
							"\n",
							"The notebook **_3_data_generation_demo_** data generation demo shows how to generate test data sets across multiple fictional schools for testing purposes."
						]
					}
				]
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/2_batch_processing_demo')]",
			"type": "Microsoft.Synapse/workspaces/notebooks",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"nbformat": 4,
				"nbformat_minor": 2,
				"bigDataPool": {
					"referenceName": "spark3p1sm",
					"type": "BigDataPoolReference"
				},
				"sessionProperties": {
					"driverMemory": "28g",
					"driverCores": 4,
					"executorMemory": "28g",
					"executorCores": 4,
					"numExecutors": 2,
					"conf": {
						"spark.dynamicAllocation.enabled": "false",
						"spark.dynamicAllocation.minExecutors": "2",
						"spark.dynamicAllocation.maxExecutors": "2",
						"spark.autotune.trackingId": "8ccaa792-13bc-401f-affe-090e5af57b4b"
					}
				},
				"metadata": {
					"saveOutput": true,
					"enableDebugMode": false,
					"kernelspec": {
						"name": "synapse_pyspark",
						"display_name": "Synapse PySpark"
					},
					"language_info": {
						"name": "python"
					},
					"a365ComputeOptions": {
						"id": "/subscriptions/7b9a4896-4541-483f-bdc7-d8f4ec6be3ee/resourceGroups/rg-oea-CISDAG1/providers/Microsoft.Synapse/workspaces/syn-oea-cisdag1/bigDataPools/spark3p1sm",
						"name": "spark3p1sm",
						"type": "Spark",
						"endpoint": "https://syn-oea-cisdag1.dev.azuresynapse.net/livyApi/versions/2019-11-01-preview/sparkPools/spark3p1sm",
						"auth": {
							"type": "AAD",
							"authResource": "https://dev.azuresynapse.net"
						},
						"sparkVersion": "3.1",
						"nodeCount": 3,
						"cores": 4,
						"memory": 28
					},
					"sessionKeepAliveTimeout": 30
				},
				"cells": [
					{
						"cell_type": "markdown",
						"metadata": {
							"nteract": {
								"transient": {
									"deleting": false
								}
							}
						},
						"source": [
							"# OEA Demo\r\n",
							"This notebook demonstrates the batch processing features of the OEA framework."
						]
					},
					{
						"cell_type": "code",
						"metadata": {
							"jupyter": {
								"outputs_hidden": false,
								"source_hidden": false
							},
							"nteract": {
								"transient": {
									"deleting": false
								}
							},
							"collapsed": true
						},
						"source": [
							"%run /OEA_py"
						],
						"outputs": [],
						"execution_count": null
					},
					{
						"cell_type": "markdown",
						"metadata": {
							"nteract": {
								"transient": {
									"deleting": false
								}
							}
						},
						"source": [
							"# Incremental batches"
						]
					},
					{
						"cell_type": "code",
						"metadata": {
							"jupyter": {
								"source_hidden": false,
								"outputs_hidden": false
							},
							"nteract": {
								"transient": {
									"deleting": false
								}
							}
						},
						"source": [
							"# reset this example (deletes data in stage1np/example, stage2np/example, and stage2p/example)\r\n",
							"oea.delete_data_source('example')"
						],
						"outputs": [],
						"execution_count": null
					},
					{
						"cell_type": "code",
						"metadata": {
							"jupyter": {
								"source_hidden": false,
								"outputs_hidden": false
							},
							"nteract": {
								"transient": {
									"deleting": false
								}
							}
						},
						"source": [
							"# Land the first batch of test data\r\n",
							"df1 = spark.createDataFrame([(1,'Joe','English','2021'), (2,'Helen','English','2021')], ['id', 'name', 'language', 'school_year'])\r\n",
							"oea.land('example', 'student', df1)\r\n",
							"# show what's landed in stage1\r\n",
							"df = oea.load_csv('stage1np/example/student')\r\n",
							"df.show()"
						],
						"outputs": [],
						"execution_count": null
					},
					{
						"cell_type": "code",
						"metadata": {
							"jupyter": {
								"source_hidden": false,
								"outputs_hidden": false
							},
							"nteract": {
								"transient": {
									"deleting": false
								}
							}
						},
						"source": [
							"# ingest the first batch of test data into stage2\r\n",
							"example_schema = [['id', 'string', 'hash'], ['name', 'string', 'mask'], ['language', 'string', 'no-op'], ['school_year', 'string', 'partition-by']]\r\n",
							"oea.ingest_incremental_data('example', 'student', example_schema, 'school_year', 'id')\r\n",
							"\r\n",
							"# show what's in stage2\r\n",
							"df = oea.load_delta('stage2np/example/student_lookup')\r\n",
							"df.show()\r\n",
							"df = oea.load_delta('stage2p/example/student_pseudo')\r\n",
							"df.show()"
						],
						"outputs": [],
						"execution_count": null
					},
					{
						"cell_type": "code",
						"metadata": {
							"jupyter": {
								"source_hidden": false,
								"outputs_hidden": false
							},
							"nteract": {
								"transient": {
									"deleting": false
								}
							}
						},
						"source": [
							"# land the second batch of test data\r\n",
							"df2 = spark.createDataFrame([(3,'Elisa','Spanish','2021'), (4,'Lily','English','2021')], ['id', 'name', 'language', 'school_year'])\r\n",
							"oea.land('example', 'student', df2)\r\n",
							"# show the comprehensive set of data landed in stage1\r\n",
							"df = oea.load_csv('stage1np/example/student')\r\n",
							"df.show()"
						],
						"outputs": [],
						"execution_count": null
					},
					{
						"cell_type": "code",
						"metadata": {
							"jupyter": {
								"source_hidden": false,
								"outputs_hidden": false
							},
							"nteract": {
								"transient": {
									"deleting": false
								}
							}
						},
						"source": [
							"# ingest the second batch of test data into stage2\r\n",
							"oea.ingest_incremental_data('example', 'student', example_schema, 'school_year', 'id')\r\n",
							"\r\n",
							"# show what's in stage2\r\n",
							"df = oea.load_delta('stage2np/example/student_lookup')\r\n",
							"df.show()\r\n",
							"df = oea.load_delta('stage2p/example/student_pseudo')\r\n",
							"df.show()\r\n",
							"df.printSchema()"
						],
						"outputs": [],
						"execution_count": null
					},
					{
						"cell_type": "markdown",
						"metadata": {
							"nteract": {
								"transient": {
									"deleting": false
								}
							}
						},
						"source": [
							"# Delta batches"
						]
					},
					{
						"cell_type": "code",
						"metadata": {
							"jupyter": {
								"source_hidden": false,
								"outputs_hidden": false
							},
							"nteract": {
								"transient": {
									"deleting": false
								}
							}
						},
						"source": [
							"# reset this example (deletes data in stage1np/example, stage2np/example, and stage2p/example)\r\n",
							"oea.delete_data_source('delta_example')"
						],
						"outputs": [],
						"execution_count": null
					},
					{
						"cell_type": "code",
						"metadata": {
							"jupyter": {
								"source_hidden": false,
								"outputs_hidden": false
							},
							"nteract": {
								"transient": {
									"deleting": false
								}
							}
						},
						"source": [
							"# Land the first batch of test data\r\n",
							"df1 = spark.createDataFrame([(1,'Joseph','English','2021'), (2,'Helen','English','2021')], ['id', 'name', 'language', 'school_year'])\r\n",
							"oea.land('delta_example', 'student', df1)\r\n",
							"\r\n",
							"# show what's landed in stage1\r\n",
							"df = oea.load_csv('stage1np/delta_example/student')\r\n",
							"df.show()"
						],
						"outputs": [],
						"execution_count": null
					},
					{
						"cell_type": "code",
						"metadata": {
							"jupyter": {
								"source_hidden": false,
								"outputs_hidden": false
							},
							"nteract": {
								"transient": {
									"deleting": false
								}
							}
						},
						"source": [
							"# ingest the first batch of test data into stage2\r\n",
							"example_schema = [['id', 'string', 'hash'], ['name', 'string', 'mask'], ['language', 'string', 'no-op'], ['school_year', 'string', 'partition-by']]\r\n",
							"oea.ingest_delta_data('delta_example', 'student', example_schema, 'school_year')\r\n",
							"\r\n",
							"# show what's in stage2\r\n",
							"df = oea.load_delta('stage2np/delta_example/student_lookup')\r\n",
							"df.show()\r\n",
							"df = oea.load_delta('stage2p/delta_example/student_pseudo')\r\n",
							"df.show()"
						],
						"outputs": [],
						"execution_count": null
					},
					{
						"cell_type": "code",
						"metadata": {
							"jupyter": {
								"source_hidden": false,
								"outputs_hidden": false
							},
							"nteract": {
								"transient": {
									"deleting": false
								}
							}
						},
						"source": [
							"# Land the second batch of test data\r\n",
							"df2 = spark.createDataFrame([(1,'Joseph','Spanish','2021'), (3,'Elisa','Spanish','2021')], ['id', 'name', 'language', 'school_year'])\r\n",
							"oea.land('delta_example', 'student', df2)\r\n",
							"\r\n",
							"# show what's landed in stage1\r\n",
							"df = oea.load_csv('stage1np/delta_example/student')\r\n",
							"df.show()"
						],
						"outputs": [],
						"execution_count": null
					},
					{
						"cell_type": "code",
						"metadata": {
							"jupyter": {
								"source_hidden": false,
								"outputs_hidden": false
							},
							"nteract": {
								"transient": {
									"deleting": false
								}
							}
						},
						"source": [
							"# ingest the second batch of test data into stage2\r\n",
							"oea.ingest_delta_data('delta_example', 'student', example_schema, 'school_year')\r\n",
							"\r\n",
							"# show what's in stage2\r\n",
							"df = oea.load_delta('stage2np/delta_example/student_lookup')\r\n",
							"df.show()\r\n",
							"df = oea.load_delta('stage2p/delta_example/student_pseudo')\r\n",
							"df.show()\r\n",
							"df.printSchema()"
						],
						"outputs": [],
						"execution_count": null
					},
					{
						"cell_type": "markdown",
						"metadata": {
							"nteract": {
								"transient": {
									"deleting": false
								}
							}
						},
						"source": [
							"# Snapshot batches"
						]
					},
					{
						"cell_type": "code",
						"metadata": {
							"jupyter": {
								"source_hidden": false,
								"outputs_hidden": false
							},
							"nteract": {
								"transient": {
									"deleting": false
								}
							}
						},
						"source": [
							"# reset this example (deletes data in stage1np/example, stage2np/example, and stage2p/example)\r\n",
							"oea.delete_data_source('snapshot_example')"
						],
						"outputs": [],
						"execution_count": null
					},
					{
						"cell_type": "code",
						"metadata": {
							"jupyter": {
								"source_hidden": false,
								"outputs_hidden": false
							},
							"nteract": {
								"transient": {
									"deleting": false
								}
							}
						},
						"source": [
							"# land data in stage1\r\n",
							"df1 = spark.createDataFrame([(1,'Joseph','English','2021'), (2,'Helen','English','2021')], ['id', 'name', 'language', 'school_year'])\r\n",
							"oea.land('snapshot_example', 'student', df1)\r\n",
							"\r\n",
							"# show what's landed in stage1\r\n",
							"df = oea.load_csv('stage1np/snapshot_example/student')\r\n",
							"df.show()"
						],
						"outputs": [],
						"execution_count": null
					},
					{
						"cell_type": "code",
						"metadata": {
							"jupyter": {
								"source_hidden": false,
								"outputs_hidden": false
							},
							"nteract": {
								"transient": {
									"deleting": false
								}
							}
						},
						"source": [
							"# process data from stage1 into stage2\r\n",
							"example_schema = [['id', 'string', 'hash'], ['name', 'string', 'mask'], ['language', 'string', 'no-op'], ['school_year', 'string', 'partition-by']]\r\n",
							"oea.ingest_snapshot_data('snapshot_example', 'student', example_schema, 'school_year')\r\n",
							"\r\n",
							"# show what's in stage2\r\n",
							"df = oea.load_delta('stage2np/snapshot_example/student_lookup')\r\n",
							"df.show()\r\n",
							"df = oea.load_delta('stage2p/snapshot_example/student_pseudo')\r\n",
							"df.show()\r\n",
							"df.printSchema()"
						],
						"outputs": [],
						"execution_count": null
					},
					{
						"cell_type": "code",
						"metadata": {
							"jupyter": {
								"source_hidden": false,
								"outputs_hidden": false
							},
							"nteract": {
								"transient": {
									"deleting": false
								}
							}
						},
						"source": [
							"# land the second test data batch in stage1\r\n",
							"df2 = spark.createDataFrame([(1,'Joseph','Spanish','2021'), (3,'Elisa','Spanish','2021')], ['id', 'name', 'language', 'school_year'])\r\n",
							"oea.land('snapshot_example', 'student', df2)\r\n",
							"\r\n",
							"# show what's landed in stage1\r\n",
							"df = oea.load_csv('stage1np/snapshot_example/student')\r\n",
							"df.show()"
						],
						"outputs": [],
						"execution_count": null
					},
					{
						"cell_type": "code",
						"metadata": {
							"jupyter": {
								"source_hidden": false,
								"outputs_hidden": false
							},
							"nteract": {
								"transient": {
									"deleting": false
								}
							}
						},
						"source": [
							"# process data from stage1 into stage2\r\n",
							"example_schema = [['id', 'string', 'hash'], ['name', 'string', 'mask'], ['language', 'string', 'no-op'], ['school_year', 'string', 'partition-by']]\r\n",
							"oea.ingest_snapshot_data('snapshot_example', 'student', example_schema, 'school_year')\r\n",
							"\r\n",
							"# show what's in stage2\r\n",
							"df = oea.load_delta('stage2np/snapshot_example/student_lookup')\r\n",
							"df.show()\r\n",
							"df = oea.load_delta('stage2p/snapshot_example/student_pseudo')\r\n",
							"df.show()\r\n",
							"df.printSchema()"
						],
						"outputs": [],
						"execution_count": null
					}
				]
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/3_data_generation_demo')]",
			"type": "Microsoft.Synapse/workspaces/notebooks",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"nbformat": 4,
				"nbformat_minor": 2,
				"bigDataPool": {
					"referenceName": "spark3p1sm",
					"type": "BigDataPoolReference"
				},
				"sessionProperties": {
					"driverMemory": "28g",
					"driverCores": 4,
					"executorMemory": "28g",
					"executorCores": 4,
					"numExecutors": 2,
					"conf": {
						"spark.dynamicAllocation.enabled": "false",
						"spark.dynamicAllocation.minExecutors": "2",
						"spark.dynamicAllocation.maxExecutors": "2",
						"spark.autotune.trackingId": "aca14578-3d46-435a-be12-6937ab9f61d5"
					}
				},
				"metadata": {
					"saveOutput": true,
					"enableDebugMode": false,
					"kernelspec": {
						"name": "synapse_pyspark",
						"display_name": "Synapse PySpark"
					},
					"language_info": {
						"name": "python"
					},
					"a365ComputeOptions": {
						"id": "/subscriptions/7b9a4896-4541-483f-bdc7-d8f4ec6be3ee/resourceGroups/rg-oea-CISDAG1/providers/Microsoft.Synapse/workspaces/syn-oea-cisdag1/bigDataPools/spark3p1sm",
						"name": "spark3p1sm",
						"type": "Spark",
						"endpoint": "https://syn-oea-cisdag1.dev.azuresynapse.net/livyApi/versions/2019-11-01-preview/sparkPools/spark3p1sm",
						"auth": {
							"type": "AAD",
							"authResource": "https://dev.azuresynapse.net"
						},
						"sparkVersion": "3.1",
						"nodeCount": 3,
						"cores": 4,
						"memory": 28
					},
					"sessionKeepAliveTimeout": 30
				},
				"cells": [
					{
						"cell_type": "markdown",
						"metadata": {
							"nteract": {
								"transient": {
									"deleting": false
								}
							}
						},
						"source": [
							"# Data Generation Example\r\n",
							"This notebook demonstrates how to use the EdFiDataGenerator to generate test student data in the Ed-Fi format for as many schools as specified.\r\n",
							"\r\n",
							"To generate test Ed-Fi data, simple run this notebook.\r\n",
							"The test data will be generated in json format and written to stage1np/test_data in your data lake."
						]
					},
					{
						"cell_type": "code",
						"metadata": {
							"jupyter": {
								"source_hidden": false,
								"outputs_hidden": false
							},
							"nteract": {
								"transient": {
									"deleting": false
								}
							}
						},
						"source": [
							"%run OEA_py"
						],
						"outputs": [],
						"execution_count": null
					},
					{
						"cell_type": "code",
						"metadata": {
							"jupyter": {
								"source_hidden": false,
								"outputs_hidden": false
							},
							"nteract": {
								"transient": {
									"deleting": false
								}
							}
						},
						"source": [
							"%run DataGen_py"
						],
						"outputs": [],
						"execution_count": null
					},
					{
						"cell_type": "code",
						"metadata": {
							"jupyter": {
								"source_hidden": false,
								"outputs_hidden": false
							},
							"nteract": {
								"transient": {
									"deleting": false
								}
							}
						},
						"source": [
							"dg = EdFiDataGenerator()\r\n",
							"writer = DataLakeWriter(oea.stage1np + '/test_data')\r\n",
							"dg.generate_data(2, writer)"
						],
						"outputs": [],
						"execution_count": null
					}
				]
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/DataGen_py')]",
			"type": "Microsoft.Synapse/workspaces/notebooks",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"nbformat": 4,
				"nbformat_minor": 2,
				"bigDataPool": {
					"referenceName": "spark3p1sm",
					"type": "BigDataPoolReference"
				},
				"sessionProperties": {
					"driverMemory": "28g",
					"driverCores": 4,
					"executorMemory": "28g",
					"executorCores": 4,
					"numExecutors": 2,
					"conf": {
						"spark.dynamicAllocation.enabled": "false",
						"spark.dynamicAllocation.minExecutors": "2",
						"spark.dynamicAllocation.maxExecutors": "2",
						"spark.autotune.trackingId": "4d855aae-f81f-476a-ab30-15d59c07f721"
					}
				},
				"metadata": {
					"saveOutput": true,
					"enableDebugMode": false,
					"kernelspec": {
						"name": "synapse_pyspark",
						"display_name": "python"
					},
					"language_info": {
						"name": "python"
					},
					"a365ComputeOptions": {
						"id": "/subscriptions/7b9a4896-4541-483f-bdc7-d8f4ec6be3ee/resourceGroups/rg-oea-CISDAG1/providers/Microsoft.Synapse/workspaces/syn-oea-cisdag1/bigDataPools/spark3p1sm",
						"name": "spark3p1sm",
						"type": "Spark",
						"endpoint": "https://syn-oea-cisdag1.dev.azuresynapse.net/livyApi/versions/2019-11-01-preview/sparkPools/spark3p1sm",
						"auth": {
							"type": "AAD",
							"authResource": "https://dev.azuresynapse.net"
						},
						"sparkVersion": "3.1",
						"nodeCount": 3,
						"cores": 4,
						"memory": 28
					},
					"sessionKeepAliveTimeout": 30
				},
				"cells": [
					{
						"cell_type": "code",
						"source": [
							"import random\r\n",
							"import json\r\n",
							"from faker import Faker\r\n",
							"\r\n",
							"\"\"\" From DataGenUtil.py \"\"\"\r\n",
							"def list_of_dict_to_csv(list_of_dict, includeHeaders = True):\r\n",
							"    csv_str = ''\r\n",
							"    if includeHeaders == True:\r\n",
							"        header = []\r\n",
							"        for column_name in list_of_dict[0].keys(): \r\n",
							"            if not column_name.startswith('_'): header.append(column_name)\r\n",
							"        csv_str += \",\".join(header) + \"\\n\"\r\n",
							"\r\n",
							"    for row in list_of_dict:\r\n",
							"        csv_str += obj_to_csv(row) + \"\\n\"\r\n",
							"\r\n",
							"    return csv_str\r\n",
							"\r\n",
							"def obj_to_csv(obj):\r\n",
							"    csv = ''\r\n",
							"    for key in obj:\r\n",
							"        if not (key.startswith('_')): csv += str(obj[key]) + ','\r\n",
							"    return csv[:-1]\r\n",
							"\r\n",
							"def list_of_dict_to_json(list_of_dict):\r\n",
							"    json_str = '['\r\n",
							"    for row in list_of_dict:\r\n",
							"        json_str += obj_to_json(row) + \",\\n\"\r\n",
							"    return json_str[:-2] + ']'\r\n",
							"\r\n",
							"def obj_to_json(obj):\r\n",
							"    json_dict = {}\r\n",
							"    for key in obj:\r\n",
							"        if not (key.startswith('_')): json_dict[key] = obj[key]\r\n",
							"    return json.dumps(json_dict)\r\n",
							"\r\n",
							"\"\"\" From EdFiDataGenerator.py \"\"\"\r\n",
							"GENDER = ['Male','Female']\r\n",
							"BOOLEAN = [True, False]\r\n",
							"OPERATIONAL_STATUS = ['Active','Inactive']\r\n",
							"CHARTER_STATUS = ['School Charter', 'Open Enrollment Charter', 'Not a Charter School']\r\n",
							"GRADE_LEVEL = ['First Grade','Second Grade','Third Grade','Fourth Grade','Fifth Grade','Sixth Grade','Seventh Grade','Eighth Grade','Ninth Grade','Tenth Grade','Eleventh Grade','Twelfth Grade']\r\n",
							"SCHOOL_TYPES = ['High School', 'Middle School', 'Elementary School']\r\n",
							"SUBJECT_NAMES = [('Math','Algebra'), ('Math','Geometry'), ('Language','English'), ('History','World History'),('Science','Biology'), ('Science','Health'), ('Technology',' Programming'), ('Physical Education','Sports'), ('Arts','Music')]\r\n",
							"LEVELS_OF_EDUCATION = ['Some College No Degree', 'Doctorate', 'Bachelor\\'s','Master\\'s']\r\n",
							"PERSONAL_INFORMATION_VERIFICATION_DESCRIPTIONS = ['Entry in family Bible', 'Other official document', 'State-issued ID', 'Hospital certificate', 'Passport', 'Parents affidavit', 'Immigration document/visa', 'Drivers license']\r\n",
							"RACES = ['Asian' , 'Native Hawaiian - Pacific Islander', 'American Indian - Alaska Native', 'White']\r\n",
							"\r\n",
							"class EdFiDataGenerator:\r\n",
							"    def __init__(self,number_students_per_school=100, include_optional_fields=True, school_year='2021', credit_conversion_factor = 2.0, number_of_grades_per_school = 5, is_current_school_year = True, graduation_plans_per_school = 10, unique_id_length = 5, number_staffs_per_school = 50, number_sections_per_school = 10):\r\n",
							"        # Set a seed value in Faker so it generates same values every run.\r\n",
							"        self.faker = Faker('en_US')\r\n",
							"        Faker.seed(1)\r\n",
							"\r\n",
							"        self.include_optional_fields = include_optional_fields\r\n",
							"        self.graduation_plans_per_school = graduation_plans_per_school\r\n",
							"        self.school_year = school_year\r\n",
							"        self.country = 'United States of America'\r\n",
							"        self.number_students_per_school = number_students_per_school\r\n",
							"        self.credit_conversion_factor = credit_conversion_factor\r\n",
							"        self.number_of_grades_per_school = number_of_grades_per_school\r\n",
							"        self.is_current_school_year = is_current_school_year\r\n",
							"        self.unique_id_length = unique_id_length\r\n",
							"        self.number_staffs_per_school = number_staffs_per_school\r\n",
							"        self.number_sections_per_school = number_sections_per_school\r\n",
							"\r\n",
							"    def get_descriptor_string(self, key, value):\r\n",
							"        return \"uri://ed-fi.org/{}#{}\".format(key,value)\r\n",
							"\r\n",
							"    def generate_data(self, num_of_schools, writer):\r\n",
							"        edfi_data = [self.create_school() for _ in range(num_of_schools)]\r\n",
							"        edfi_data_formatted = self.format_edfi_data(edfi_data)\r\n",
							"\r\n",
							"\r\n",
							"        writer.write(f'EdFi/School.json',list_of_dict_to_json(edfi_data_formatted['Schools']))\r\n",
							"        writer.write(f'EdFi/Student.json',list_of_dict_to_json(edfi_data_formatted['Students']))\r\n",
							"        writer.write(f'EdFi/StudentSchoolAssociation.json',list_of_dict_to_json(edfi_data_formatted['StudentSchoolAssociations']))\r\n",
							"        writer.write(f'EdFi/Course.json',list_of_dict_to_json(edfi_data_formatted['Courses']))\r\n",
							"        writer.write(f'EdFi/Calendar.json',list_of_dict_to_json(edfi_data_formatted['Calendars']))\r\n",
							"        writer.write(f'EdFi/Sessions.json',list_of_dict_to_json(edfi_data_formatted['Sessions']))\r\n",
							"        writer.write(f'EdFi/StaffSchoolAssociations.json',list_of_dict_to_json(edfi_data_formatted['StaffSchoolAssociations']))\r\n",
							"        writer.write(f'EdFi/Sections.json',list_of_dict_to_json(edfi_data_formatted['Sections']))\r\n",
							"        writer.write(f'EdFi/Staffs.json',list_of_dict_to_json(edfi_data_formatted['Staffs']))\r\n",
							"        writer.write(f'EdFi/StudentSectionAssociations.json',list_of_dict_to_json(edfi_data_formatted['StudentSectionAssociations']))\r\n",
							"        writer.write(f'EdFi/StaffSectionAssociations.json',list_of_dict_to_json(edfi_data_formatted['StaffSectionAssociations']))\r\n",
							"\r\n",
							"\r\n",
							"    def create_school(self):\r\n",
							"        school_type = random.choice(SCHOOL_TYPES)\r\n",
							"        school_name = self.faker.city() + ' ' + school_type\r\n",
							"        school = {\r\n",
							"            'Id': self.faker.uuid4().replace('-',''),\r\n",
							"            'SchoolId': self.faker.random_number(digits = self.unique_id_length),\r\n",
							"            'NameOfInstitution': school_name,\r\n",
							"            'OperationalStatusDescriptor': self.get_descriptor_string('OperationalStatusDescriptor',random.choice(OPERATIONAL_STATUS)),\r\n",
							"            'ShortNameOfInstitution': ''.join([word[0] for word in school_name.split()]),\r\n",
							"            'Website':''.join(['www.',school_name.lower().replace(' ',''),'.com']),\r\n",
							"            'AdministrativeFundingControlDescriptor': self.get_descriptor_string('AdministrativeFundingControlDescriptor',random.choice(['public', 'private']) + ' School'),\r\n",
							"            'CharterStatusDescriptor': self.get_descriptor_string('CharterStatusDescriptor',random.choice(CHARTER_STATUS)),\r\n",
							"            'SchoolTypeDescriptor': self.get_descriptor_string('SchoolTypeDescriptor','Regular'),\r\n",
							"            'TitleIPartASchoolDesignationDescriptor': self.get_descriptor_string('TitleIPartASchoolDesignationDescriptor','Not A Title I School'),\r\n",
							"            'Addresses': self.create_address() if self.include_optional_fields else '',\r\n",
							"            'EducationOrganizationCategories':[{'EducationOrganizationCategoryDescriptor': self.get_descriptor_string('educationOrganizationCategoryDescriptor','School')}],\r\n",
							"            'IdentificationCodes': [\r\n",
							"                {\r\n",
							"                    'educationOrganizationIdentificationSystemDescriptor': self.get_descriptor_string('educationOrganizationIdentificationSystemDescriptor','SEA'),\r\n",
							"                    'identificationCode': self.faker.random_number(digits=10)\r\n",
							"                }\r\n",
							"            ],\r\n",
							"            'InstitutionTelephones': self.create_telephones(),\r\n",
							"            'InternationalAddresses': [],\r\n",
							"            'SchoolCategories': [\r\n",
							"                {\r\n",
							"                    'SchoolCategoryDescriptor': self.get_descriptor_string('SchoolCategoryDescriptor',school_type)\r\n",
							"                }\r\n",
							"            ],\r\n",
							"            'gradeLevels': [\r\n",
							"                {'gradeLevelDescriptor': self.get_descriptor_string('GradeLevelDescriptor',random.choice(GRADE_LEVEL))} for _ in range(4)\r\n",
							"            ]\r\n",
							"        }\r\n",
							"\r\n",
							"        school['_SchoolYears'] = self.create_school_years()\r\n",
							"        school['_Calendars'] = self.create_calendars(school)\r\n",
							"        school['_Students'] = self.create_students()\r\n",
							"        school['_Courses'] = self.create_courses(school['SchoolId'],school['Id'],school_name)\r\n",
							"        school['_GraduationPlans'] = self.create_graduation_plans(school)\r\n",
							"        school['_StudentAssociations'] = self.create_student_school_associations(school)\r\n",
							"        school['_Staffs'] = self.create_staffs()\r\n",
							"        school['_StaffSchoolAssociations'] = self.create_staff_school_associations(school)\r\n",
							"        school['_Sessions'] = self.create_sessions(school)\r\n",
							"        school['_Sections'] = self.create_sections(school)\r\n",
							"        school['_StaffSectionAssociations'] = self.create_staff_section_associations(school)\r\n",
							"        school['_StudentSectionAssociations'] = self.create_student_section_associations(school)\r\n",
							"        return school\r\n",
							"\r\n",
							"    def create_students(self):\r\n",
							"        students = []\r\n",
							"        for _ in range(self.number_students_per_school):\r\n",
							"            gender = random.choice(GENDER)\r\n",
							"            fname = self.faker.first_name_male() if gender == 'Male' else self.faker.first_name_female()\r\n",
							"            students.append({\r\n",
							"                'Id': self.faker.uuid4().replace('-',''),\r\n",
							"                'StudentUniqueId': self.faker.random_number(digits = self.unique_id_length),\r\n",
							"                \"BirthCity\": self.faker.city(),\r\n",
							"                \"BirthDate\": str(self.faker.date_between(start_date='-18y',end_date='-5y')),\r\n",
							"                \"BirthSexDescriptor\": self.get_descriptor_string('birthStateAbbreviationDescriptor', gender),\r\n",
							"                \"FirstName\": fname,\r\n",
							"                \"IdentificationDocuments\": [],\r\n",
							"                \"LastSurname\": self.faker.last_name(),\r\n",
							"                \"OtherNames\": [\r\n",
							"                    {\r\n",
							"                        \"OtherNameTypeDescriptor\": self.get_descriptor_string('otherNameTypeDescriptor','Nickname'),\r\n",
							"                        \"FirstName\": self.faker.first_name_male() if gender == 'Male' else self.faker.first_name_female(),\r\n",
							"                        \"PersonalTitlePrefix\": 'Mr' if gender == 'Male' else 'Ms'\r\n",
							"                    }\r\n",
							"                ],\r\n",
							"                \"PersonalIdentificationDocuments\": [],\r\n",
							"                \"PersonalTitlePrefix\": 'Mr' if gender == 'Male' else 'Ms',\r\n",
							"                \"Visas\": [],\r\n",
							"                \"_etag\": self.faker.random_number(digits=10)\r\n",
							"        })\r\n",
							"        return students\r\n",
							"\r\n",
							"\r\n",
							"    def create_student_school_associations(self,school):\r\n",
							"        result = []\r\n",
							"        graduation_plan_ids = [gp['Id'] for gp in school['_GraduationPlans']]\r\n",
							"        for student in school['_Students']:\r\n",
							"            result.append({\r\n",
							"                'Id': self.faker.uuid4().replace('-',''),\r\n",
							"                \"GraduationPlanReference\": {\r\n",
							"                    \"EducationOrganizationId\": school['SchoolId'],\r\n",
							"                    \"GraduationPlanTypeDescriptor\": \"uri://ed-fi.org/GraduationPlanTypeDescriptor#Minimum\",\r\n",
							"                    \"GraduationSchoolYear\": self.school_year,\r\n",
							"                    \"Link\": {\r\n",
							"                        \"rel\": \"GraduationPlan\",\r\n",
							"                        \"href\": '/ed-fi/graduationPlans/{}'.format(random.choice(graduation_plan_ids))\r\n",
							"                    }\r\n",
							"                },\r\n",
							"                \"SchoolReference\": {\r\n",
							"                    \"SchoolId\": school['SchoolId'],\r\n",
							"                    \"Link\": {\r\n",
							"                        \"rel\": \"School\",\r\n",
							"                        \"href\": '/ed-fi/schools/{}'.format(school['Id'])\r\n",
							"                    }\r\n",
							"                },\r\n",
							"                \"StudentReference\": {\r\n",
							"                    \"StudentUniqueId\": student['StudentUniqueId'],\r\n",
							"                    \"Link\": {\r\n",
							"                        \"rel\": \"Student\",\r\n",
							"                        \"href\": \"/ed-fi/students/{}\".format(student['Id'])\r\n",
							"                    }\r\n",
							"                },\r\n",
							"                \"EntryDate\": str(self.faker.date_between(start_date='-5y',end_date='today')),\r\n",
							"                \"EntryGradeLevelDescriptor\": \"uri://ed-fi.org/GradeLevelDescriptor#{}\".format(random.choice(GRADE_LEVEL)),\r\n",
							"                \"AlternativeGraduationPlans\": [],\r\n",
							"                \"EducationPlans\": [],\r\n",
							"                \"_etag\": self.faker.random_number(digits=10)\r\n",
							"            })\r\n",
							"        return result\r\n",
							"\r\n",
							"    def create_calendars(self,school):\r\n",
							"        return {\r\n",
							"            'Id': self.faker.uuid4().replace('-',''),\r\n",
							"            'CalendarCode':self.faker.random_number(digits = self.unique_id_length),\r\n",
							"            \"SchoolReference\": {\r\n",
							"                \"SchoolId\": school['SchoolId'],\r\n",
							"                \"Link\": {\r\n",
							"                    \"rel\": \"School\",\r\n",
							"                    \"href\": \"/ed-fi/schools/{}\".format(school['Id'])\r\n",
							"                }\r\n",
							"            },\r\n",
							"            \"SchoolYearTypeReference\": {\r\n",
							"                \"SchoolYear\": self.school_year,\r\n",
							"                \"Link\": {\r\n",
							"                    \"rel\": \"SchoolYearType\",\r\n",
							"                    \"href\": \"/ed-fi/schoolYearTypes/{}\".format(school['_SchoolYears']['Id'])\r\n",
							"                }\r\n",
							"            },\r\n",
							"            'CalendarTypeDescriptor': self.get_descriptor_string('calendarTypeDescriptor','Student Specific'),\r\n",
							"            'GradeLevel': []\r\n",
							"        }\r\n",
							"\r\n",
							"    def create_address(self):\r\n",
							"        address = []\r\n",
							"        state = self.faker.state_abbr()\r\n",
							"        for n in ['Physical', 'Mailing']:\r\n",
							"            address.append({\r\n",
							"                'AddressType':n,\r\n",
							"                'City':self.faker.city(),\r\n",
							"                'PostalCode':self.faker.postcode(),\r\n",
							"                'StateAbbreviation':state,\r\n",
							"                'StreetNumberName':self.faker.street_name()\r\n",
							"            })\r\n",
							"        return address\r\n",
							"\r\n",
							"    def create_courses(self,school_id,id,school_name):\r\n",
							"        courses = []\r\n",
							"        for subject,course_name in SUBJECT_NAMES:\r\n",
							"            courseCode = '{}-{}'.format(course_name[0:3].upper(),random.choice(range(1,5)))\r\n",
							"            courses.append({\r\n",
							"                \"Id\": self.faker.uuid4().replace('-',''),\r\n",
							"                \"EducationOrganizationReference\": {\r\n",
							"                    \"EducationOrganizationId\": school_id,\r\n",
							"                    \"Link\": {\r\n",
							"                        \"rel\": \"School\",\r\n",
							"                        \"href\": \"/ed-fi/schools/{}\".format(id)\r\n",
							"                    }\r\n",
							"                },\r\n",
							"                \"CourseCode\": courseCode,\r\n",
							"                \"AcademicSubjectDescriptor\": self.get_descriptor_string('academicSubjectDescriptor', subject),\r\n",
							"                \"CourseDefinedByDescriptor\": self.get_descriptor_string('CourseDefinedByDescriptor','SEA'),\r\n",
							"                \"CourseDescription\": 'Description about {}'.format(course_name),\r\n",
							"                \"CourseGPAApplicabilityDescriptor\": self.get_descriptor_string('CourseGPAApplicabilityDescriptor',random.choice(['Applicable','Not Applicable'])),\r\n",
							"                \"CourseTitle\": course_name,\r\n",
							"                \"HighSchoolCourseRequirement\": random.choice(BOOLEAN),\r\n",
							"                \"NumberOfParts\": 1,\r\n",
							"                \"CompetencyLevels\": [],\r\n",
							"                \"IdentificationCodes\": [\r\n",
							"                    {\r\n",
							"                        \"CourseIdentificationSystemDescriptor\": self.get_descriptor_string('CourseIdentificationSystemDescriptor','LEA course code'),\r\n",
							"                        \"CourseCatalogURL\": \"http://www.{}.edu/coursecatalog\".format(school_name.lower().replace(' ','')),\r\n",
							"                        \"IdentificationCode\": courseCode\r\n",
							"                    },\r\n",
							"                    {\r\n",
							"                        \"CourseIdentificationSystemDescriptor\": self.get_descriptor_string('CourseIdentificationSystemDescriptor','State course code'),\r\n",
							"                        \"IdentificationCode\": self.faker.random_number(digits = self.unique_id_length)\r\n",
							"                    }\r\n",
							"                ],\r\n",
							"                \"LearningObjectives\": [],\r\n",
							"                \"LearningStandards\": [\r\n",
							"                    {\r\n",
							"                        \"LearningStandardReference\": {\r\n",
							"                            \"LearningStandardId\": self.faker.random_number(digits = self.unique_id_length),\r\n",
							"                            \"Link\": {\r\n",
							"                                \"rel\": \"LearningStandard\",\r\n",
							"                                \"href\": \"/ed-fi/learningStandards/{}\".format(self.faker.uuid4().replace('-',''))\r\n",
							"                            }\r\n",
							"                        }\r\n",
							"                    }\r\n",
							"                ],\r\n",
							"                \"LevelCharacteristics\": [\r\n",
							"                    {\r\n",
							"                        \"CourseLevelCharacteristicDescriptor\": self.get_descriptor_string('CourseLevelCharacteristicDescriptor','Core Subject')\r\n",
							"                    }\r\n",
							"                ],\r\n",
							"                \"OfferedGradeLevels\": [],\r\n",
							"                \"_etag\": self.faker.random_number(digits=10)\r\n",
							"            })\r\n",
							"        return courses\r\n",
							"\r\n",
							"\r\n",
							"    def create_graduation_plans(self, school):\r\n",
							"        graduation_plans = []\r\n",
							"        for _ in range(self.graduation_plans_per_school):\r\n",
							"            graduation_plans.append({\r\n",
							"                'Id': self.faker.uuid4().replace('-',''),\r\n",
							"                \"EducationOrganizationReference\": {\r\n",
							"                    \"EducationOrganizationId\": school['SchoolId'],\r\n",
							"                    \"link\": {\r\n",
							"                        \"rel\": \"School\",\r\n",
							"                        \"href\": \"/ed-fi/schools/{}\".format(school['Id'])\r\n",
							"                    }\r\n",
							"                },\r\n",
							"                \"GraduationSchoolYearTypeReference\": {\r\n",
							"                    \"SchoolYear\": self.school_year,\r\n",
							"                    \"Link\": {\r\n",
							"                        \"rel\": \"SchoolYearType\",\r\n",
							"                        \"href\": \"/ed-fi/schoolYearTypes/{}\".format(school['_SchoolYears']['Id'])\r\n",
							"                    }\r\n",
							"                },\r\n",
							"                \"GraduationPlanTypeDescriptor\": self.get_descriptor_string('GraduationPlanTypeDescriptor', random.choice(['Minimum','Recommended'])),\r\n",
							"                \"TotalRequiredCredits\": random.choice(range(20,30)),\r\n",
							"                \"CreditsByCourses\": [],\r\n",
							"                \"CreditsByCreditCategories\": [\r\n",
							"                    {\r\n",
							"                        \"CreditCategoryDescriptor\": self.get_descriptor_string('CreditCategoryDescriptor','Honors'),\r\n",
							"                        \"Credits\": random.choice(range(5,15))\r\n",
							"                    }\r\n",
							"                ],\r\n",
							"                \"CreditsBySubjects\": [],\r\n",
							"                \"RequiredAssessments\": [],\r\n",
							"                \"_etag\": self.faker.random_number(digits=10)\r\n",
							"            })\r\n",
							"        return graduation_plans\r\n",
							"\r\n",
							"    def create_school_years(self):\r\n",
							"        return {\r\n",
							"            'Id': self.faker.uuid4().replace('-',''),\r\n",
							"            'SchoolYear': self.school_year,\r\n",
							"            'CurrentSchoolYear': self.is_current_school_year,\r\n",
							"            'schoolYearDescription': 'Description about school year',\r\n",
							"            '_etag': self.faker.random_number(digits=10)\r\n",
							"        }\r\n",
							"\r\n",
							"    def create_telephones(self):\r\n",
							"        return [\r\n",
							"            {\r\n",
							"                'InstitutionTelephoneNumberTypeDescriptor': self.get_descriptor_string('InstitutionTelephoneNumberTypeDescriptor', _),\r\n",
							"                \"TelephoneNumber\": self.faker.phone_number()\r\n",
							"            }\r\n",
							"            for _ in ['Fax','Main']\r\n",
							"        ]\r\n",
							"\r\n",
							"    def create_staffs(self):\r\n",
							"        staffs = []\r\n",
							"        for _ in range(self.number_staffs_per_school):\r\n",
							"            gender = random.choice(GENDER)\r\n",
							"            fname = self.faker.first_name_male() if gender == 'Male' else self.faker.first_name_female()\r\n",
							"            lname = self.faker.last_name()\r\n",
							"            staffs.append({\r\n",
							"                \"Id\": self.faker.uuid4().replace('-',''),\r\n",
							"                \"StaffUniqueId\": self.faker.random_number(digits = self.unique_id_length),\r\n",
							"                \"BirthDate\": str(self.faker.date_between(start_date='-60y',end_date='-30y')),\r\n",
							"                \"FirstName\": fname,\r\n",
							"                \"HighestCompletedLevelOfEducationDescriptor\": self.get_descriptor_string('LevelOfEducationDescriptor', value = random.choice(LEVELS_OF_EDUCATION)),\r\n",
							"                \"HispanicLatinoEthnicity\": random.choice(BOOLEAN),\r\n",
							"                \"LastSurname\": lname,\r\n",
							"                \"LoginId\": '{}{}'.format(fname[0],lname.lower()),\r\n",
							"                \"PersonalTitlePrefix\": 'Mr' if gender == 'Male' else 'Ms',\r\n",
							"                \"SexDescriptor\": self.get_descriptor_string('SexDescriptor', value = gender),\r\n",
							"                \"YearsOfPriorProfessionalExperience\": random.choice(range(50)),\r\n",
							"                \"Addresses\": self.create_address(),\r\n",
							"                \"AncestryEthnicOrigins\": [],\r\n",
							"                \"Credentials\": [\r\n",
							"                    {\r\n",
							"                        \"CredentialReference\": {\r\n",
							"                            \"CredentialIdentifier\": self.faker.random_number(digits = 10),\r\n",
							"                            \"StateOfIssueStateAbbreviationDescriptor\": self.get_descriptor_string('StateAbbreviationDescriptor', 'TX'),\r\n",
							"                            \"Link\": {\r\n",
							"                                \"rel\": \"Credential\",\r\n",
							"                                \"href\": \"/ed-fi/credentials/\" + self.faker.uuid4().replace('-','')\r\n",
							"                            }\r\n",
							"                        }\r\n",
							"                    }\r\n",
							"                ],\r\n",
							"                \"ElectronicMails\": [\r\n",
							"                    {\r\n",
							"                        \"ElectronicMailAddress\": \"{}{}@edfi.org\".format(fname,lname),\r\n",
							"                        \"ElectronicMailTypeDescriptor\": self.get_descriptor_string('ElectronicMailTypeDescriptor','Work')\r\n",
							"                    }\r\n",
							"                ],\r\n",
							"                \"IdentificationCodes\": [\r\n",
							"                    {\r\n",
							"                        \"StaffIdentificationSystemDescriptor\": self.get_descriptor_string('StaffIdentificationSystemDescriptor','State'),\r\n",
							"                        \"IdentificationCode\": self.faker.random_number(digits = self.unique_id_length)\r\n",
							"                    }\r\n",
							"                ],\r\n",
							"                \"IdentificationDocuments\": [],\r\n",
							"                \"InternationalAddresses\": self.create_address(),\r\n",
							"                \"Languages\": [],\r\n",
							"                \"OtherNames\": [self.faker.first_name_male() if gender == 'Male' else self.faker.first_name_female()],\r\n",
							"                \"PersonalIdentificationDocuments\": [\r\n",
							"                    {\r\n",
							"                        \"IdentificationDocumentUseDescriptor\": \"uri://ed-fi.org/IdentificationDocumentUseDescriptor#Personal Information Verification\",\r\n",
							"                        \"PersonalInformationVerificationDescriptor\": self.get_descriptor_string('PersonalInformationVerificationDescriptor', value = random.choice(PERSONAL_INFORMATION_VERIFICATION_DESCRIPTIONS))\r\n",
							"                    }\r\n",
							"                ],\r\n",
							"                \"Races\": [\r\n",
							"                    {\r\n",
							"                        \"RaceDescriptor\": self.get_descriptor_string('RaceDescriptor', value = random.choice(RACES))\r\n",
							"                    }\r\n",
							"                ],\r\n",
							"                \"_etag\": self.faker.random_number(digits=10)\r\n",
							"            })\r\n",
							"        return staffs\r\n",
							"\r\n",
							"    def create_sessions(self, school):\r\n",
							"\r\n",
							"        return [{\r\n",
							"            \"Id\": self.faker.uuid4().replace('-',''),\r\n",
							"            \"SchoolReference\":{\r\n",
							"                \"SchoolId\":school['SchoolId'],\r\n",
							"                \"Link\":{\r\n",
							"                    \"rel\":\"School\",\r\n",
							"                    \"href\":\"/ed-fi/schools/{}\".format(school['Id'])\r\n",
							"                }\r\n",
							"            },\r\n",
							"            \"SchoolYearTypeReference\": {\r\n",
							"                \"SchoolYear\": self.school_year,\r\n",
							"                \"Link\": {\r\n",
							"                    \"rel\": \"SchoolYearType\",\r\n",
							"                    \"href\": \"/ed-fi/schoolYearTypes/{}\".format(school['_SchoolYears']['Id'])\r\n",
							"                }\r\n",
							"            },\r\n",
							"            \"SessionName\": \"{} - {} Fall Semester\".format(int(self.school_year) - 1, self.school_year ),\r\n",
							"            \"BeginDate\": \"{}-08-{}\".format(int(self.school_year) - 1, random.randint(1,30)),\r\n",
							"            \"EndDate\": \"{}-12-{}\".format(int(self.school_year) - 1, random.randint(1,30)),\r\n",
							"            \"TermDescriptor\": self.get_descriptor_string('TermDescriptor', 'Fall Semester'),\r\n",
							"            \"TotalInstructionalDays\": random.randint(60,130),\r\n",
							"            \"GradingPeriods\": [\r\n",
							"                {\r\n",
							"                    \"GradingPeriodReference\": {\r\n",
							"                    \"SchoolId\": school['SchoolId'],\r\n",
							"                    \"SchoolYear\": self.school_year,\r\n",
							"                    \"GradingPeriodDescriptor\": \"uri://ed-fi.org/GradingPeriodDescriptor#First Six Weeks\",\r\n",
							"                    \"PeriodSequence\": 1,\r\n",
							"                    \"Link\": {\r\n",
							"                        \"rel\": \"GradingPeriod\",\r\n",
							"                        \"href\": \"/ed-fi/gradingPeriods/{}\".format(self.faker.uuid4().replace('-',''))\r\n",
							"                    }\r\n",
							"                    }\r\n",
							"                },\r\n",
							"                {\r\n",
							"                    \"GradingPeriodReference\": {\r\n",
							"                    \"SchoolId\": school['SchoolId'],\r\n",
							"                    \"SchoolYear\": self.school_year,\r\n",
							"                    \"GradingPeriodDescriptor\": \"uri://ed-fi.org/GradingPeriodDescriptor#Second Six Weeks\",\r\n",
							"                    \"PeriodSequence\": 2,\r\n",
							"                    \"Link\": {\r\n",
							"                        \"rel\": \"GradingPeriod\",\r\n",
							"                        \"href\": \"/ed-fi/gradingPeriods/{}\".format(self.faker.uuid4().replace('-',''))\r\n",
							"                    }\r\n",
							"                    }\r\n",
							"                },\r\n",
							"                {\r\n",
							"                    \"GradingPeriodReference\": {\r\n",
							"                    \"SchoolId\": school['SchoolId'],\r\n",
							"                    \"SchoolYear\": self.school_year,\r\n",
							"                    \"GradingPeriodDescriptor\": \"uri://ed-fi.org/GradingPeriodDescriptor#Third Six Weeks\",\r\n",
							"                    \"PeriodSequence\": 3,\r\n",
							"                    \"Link\": {\r\n",
							"                        \"rel\": \"GradingPeriod\",\r\n",
							"                        \"href\": \"/ed-fi/gradingPeriods/{}\".format(self.faker.uuid4().replace('-',''))\r\n",
							"                    }\r\n",
							"                    }\r\n",
							"                }\r\n",
							"            ],\r\n",
							"            \"_etag\": self.faker.random_number(digits=10)\r\n",
							"        },\r\n",
							"        {\r\n",
							"            \"Id\": self.faker.uuid4().replace('-',''),\r\n",
							"            \"SchoolReference\":{\r\n",
							"                \"SchoolId\":school['SchoolId'],\r\n",
							"                \"Link\":{\r\n",
							"                    \"rel\":\"School\",\r\n",
							"                    \"href\":\"/ed-fi/schools/{}\".format(school['Id'])\r\n",
							"                }\r\n",
							"            },\r\n",
							"            \"SchoolYearTypeReference\": {\r\n",
							"                \"SchoolYear\": self.school_year,\r\n",
							"                \"Link\": {\r\n",
							"                    \"rel\": \"SchoolYearType\",\r\n",
							"                    \"href\": \"/ed-fi/schoolYearTypes/{}\".format(school['_SchoolYears']['Id'])\r\n",
							"                }\r\n",
							"            },\r\n",
							"            \"SessionName\": \"{} - {} Spring Semester\".format(int(self.school_year) - 1, self.school_year),\r\n",
							"            \"BeginDate\": \"{}-01-{}\".format(self.school_year, random.randint(1,30)),\r\n",
							"            \"EndDate\": \"{}-05-{}\".format(self.school_year, random.randint(1,30)),\r\n",
							"            \"TermDescriptor\": self.get_descriptor_string('TermDescriptor', 'Spring Semester'),\r\n",
							"            \"TotalInstructionalDays\": random.randint(60,130),\r\n",
							"            \"GradingPeriods\": [\r\n",
							"                {\r\n",
							"                    \"GradingPeriodReference\": {\r\n",
							"                    \"SchoolId\": school['SchoolId'],\r\n",
							"                    \"SchoolYear\": self.school_year,\r\n",
							"                    \"GradingPeriodDescriptor\": \"uri://ed-fi.org/GradingPeriodDescriptor#Fourth Six Weeks\",\r\n",
							"                    \"PeriodSequence\": 4,\r\n",
							"                    \"Link\": {\r\n",
							"                        \"rel\": \"GradingPeriod\",\r\n",
							"                        \"href\": \"/ed-fi/gradingPeriods/{}\".format(self.faker.uuid4().replace('-',''))\r\n",
							"                    }\r\n",
							"                    }\r\n",
							"                },\r\n",
							"                {\r\n",
							"                    \"GradingPeriodReference\": {\r\n",
							"                    \"SchoolId\": school['SchoolId'],\r\n",
							"                    \"SchoolYear\": self.school_year,\r\n",
							"                    \"GradingPeriodDescriptor\": \"uri://ed-fi.org/GradingPeriodDescriptor#Fifth Six Weeks\",\r\n",
							"                    \"PeriodSequence\": 5,\r\n",
							"                    \"Link\": {\r\n",
							"                        \"rel\": \"GradingPeriod\",\r\n",
							"                        \"href\": \"/ed-fi/gradingPeriods/{}\".format(self.faker.uuid4().replace('-',''))\r\n",
							"                    }\r\n",
							"                    }\r\n",
							"                },\r\n",
							"                {\r\n",
							"                    \"GradingPeriodReference\": {\r\n",
							"                    \"SchoolId\": school['SchoolId'],\r\n",
							"                    \"SchoolYear\": self.school_year,\r\n",
							"                    \"GradingPeriodDescriptor\": \"uri://ed-fi.org/GradingPeriodDescriptor#Sixth Six Weeks\",\r\n",
							"                    \"PeriodSequence\": 6,\r\n",
							"                    \"Link\": {\r\n",
							"                        \"rel\": \"GradingPeriod\",\r\n",
							"                        \"href\": \"/ed-fi/gradingPeriods/{}\".format(self.faker.uuid4().replace('-',''))\r\n",
							"                    }\r\n",
							"                    }\r\n",
							"                }\r\n",
							"            ],\r\n",
							"            \"_etag\": self.faker.random_number(digits=10)\r\n",
							"        }]\r\n",
							"\r\n",
							"    def create_sections(self, school):\r\n",
							"        sections = []\r\n",
							"        for _ in range(self.number_sections_per_school):\r\n",
							"            semesterType = random.choice(['Spring', 'Fall'])\r\n",
							"            subjectName = random.choice(SUBJECT_NAMES)[1]\r\n",
							"            subjectNumber = random.randint(1,5)\r\n",
							"            sections.append({\r\n",
							"                \"Id\": self.faker.uuid4().replace('-',''),\r\n",
							"                \"CourseOfferingReference\": {\r\n",
							"                    \"LocalCourseCode\": \"{}-{}\".format(subjectName[0:3].upper(), subjectNumber),\r\n",
							"                    \"SchoolId\": school['SchoolId'],\r\n",
							"                    \"SchoolYear\": self.school_year,\r\n",
							"                    \"SessionName\": \"{} - {} {} Semester\".format(int(self.school_year) - 1, semesterType, self.school_year),\r\n",
							"                    \"Link\": {\r\n",
							"                        \"rel\": \"CourseOffering\",\r\n",
							"                        \"href\": \"/ed-fi/courseOfferings/{}\".format(self.faker.uuid4().replace('-',''))\r\n",
							"                    }\r\n",
							"                },\r\n",
							"                \"LocationReference\": {\r\n",
							"                    \"ClassroomIdentificationCode\": self.faker.random_number(digits = 3),\r\n",
							"                    \"SchoolId\": school['SchoolId'],\r\n",
							"                    \"Link\": {\r\n",
							"                        \"rel\": \"Location\",\r\n",
							"                        \"href\": \"/ed-fi/locations/{}\".format(self.faker.uuid4().replace('-',''))\r\n",
							"                    }\r\n",
							"                },\r\n",
							"                \"LocationSchoolReference\": {\r\n",
							"                    \"SchoolId\": school['SchoolId'],\r\n",
							"                    \"Link\": {\r\n",
							"                        \"rel\": \"School\",\r\n",
							"                        \"href\": \"/ed-fi/schools/{}\".format(school['Id'])\r\n",
							"                    }\r\n",
							"                },\r\n",
							"                \"SectionIdentifier\": self.faker.uuid4().replace('-',''),\r\n",
							"                \"AvailableCredits\": random.randint(1,4),\r\n",
							"                \"EducationalEnvironmentDescriptor\": self.get_descriptor_string('EducationalEnvironmentDescriptor','Classroom'),\r\n",
							"                \"SectionName\": \"{} {}\".format(subjectName, subjectNumber),\r\n",
							"                \"SequenceOfCourse\": random.randint(1,5),\r\n",
							"                \"Characteristics\": [],\r\n",
							"                \"ClassPeriods\": [\r\n",
							"                {\r\n",
							"                    \"ClassPeriodReference\": {\r\n",
							"                    \"SchoolId\": school['SchoolId'],\r\n",
							"                    \"ClassPeriodName\": \"{} - Traditional\".format(random.randint(1,5)),\r\n",
							"                    \"Link\": {\r\n",
							"                        \"rel\": \"ClassPeriod\",\r\n",
							"                        \"href\": \"/ed-fi/classPeriods/{}\".format(self.faker.uuid4().replace('-',''))\r\n",
							"                    }\r\n",
							"                    }\r\n",
							"                }\r\n",
							"                ],\r\n",
							"                \"CourseLevelCharacteristics\": [],\r\n",
							"                \"OfferedGradeLevels\": [],\r\n",
							"                \"Programs\": [],\r\n",
							"                \"_etag\": self.faker.random_number(digits=10)\r\n",
							"            })\r\n",
							"        return sections\r\n",
							"\r\n",
							"    def create_student_section_associations(self, school):\r\n",
							"        student_section_associations = []\r\n",
							"        session = random.choice(school['_Sessions'])\r\n",
							"        for student in school['_Students']:\r\n",
							"            course = random.choice(school['_Courses'])\r\n",
							"            section = random.choice(school['_Sections'])\r\n",
							"            student_section_associations.append({\r\n",
							"                    \"Id\": self.faker.uuid4().replace('-',''),\r\n",
							"                    \"SectionReference\": {\r\n",
							"                        \"LocalCourseCode\": course['CourseCode'],\r\n",
							"                        \"SchoolId\": school['SchoolId'],\r\n",
							"                        \"SchoolYear\": self.school_year,\r\n",
							"                        \"SectionIdentifier\": section['SectionIdentifier'],\r\n",
							"                        \"SessionName\": session['SessionName'],\r\n",
							"                        \"Link\": {\r\n",
							"                            \"rel\": \"Section\",\r\n",
							"                            \"href\": \"/ed-fi/sections/{}\".format(section['Id'])\r\n",
							"                        }\r\n",
							"                    },\r\n",
							"                    \"StudentReference\": {\r\n",
							"                        \"StudentUniqueId\": student['StudentUniqueId'],\r\n",
							"                        \"Link\": {\r\n",
							"                            \"rel\": \"Student\",\r\n",
							"                            \"href\": \"/ed-fi/students/{}\".format(student['Id'])\r\n",
							"                        }\r\n",
							"                    },\r\n",
							"                    \"BeginDate\": session['BeginDate'],\r\n",
							"                    \"EndDate\": session['EndDate'],\r\n",
							"                    \"HomeroomIndicator\": random.choice(BOOLEAN),\r\n",
							"                    \"_etag\": self.faker.random_number(digits = 10)\r\n",
							"                })\r\n",
							"        return student_section_associations\r\n",
							"\r\n",
							"    def create_staff_section_associations(self,school):\r\n",
							"        staff_section_associations = []\r\n",
							"        for staff in school['_Staffs']:\r\n",
							"            session = random.choice(school['_Sessions'])\r\n",
							"            section = random.choice(school['_Sections'])\r\n",
							"            staff_section_associations.append({\r\n",
							"                \"Id\": self.faker.uuid4().replace('-',''),\r\n",
							"                \"SectionReference\": {\r\n",
							"                    \"LocalCourseCode\": section['CourseOfferingReference']['LocalCourseCode'],\r\n",
							"                    \"SchoolId\": school['SchoolId'],\r\n",
							"                    \"SchoolYear\": self.school_year,\r\n",
							"                    \"SectionIdentifier\": section['SectionIdentifier'],\r\n",
							"                    \"SessionName\": session['SessionName'],\r\n",
							"                    \"Link\": {\r\n",
							"                        \"rel\": \"Section\",\r\n",
							"                        \"href\": \"/ed-fi/sections/{}\".format(section['Id'])\r\n",
							"                    }\r\n",
							"                },\r\n",
							"                \"StaffReference\": {\r\n",
							"                    \"StaffUniqueId\": staff['StaffUniqueId'],\r\n",
							"                    \"Link\": {\r\n",
							"                        \"rel\": \"Staff\",\r\n",
							"                        \"href\": \"/ed-fi/staffs/{}\".format(staff['Id'])\r\n",
							"                    }\r\n",
							"                },\r\n",
							"                \"BeginDate\": session['BeginDate'],\r\n",
							"                \"ClassroomPositionDescriptor\": \"uri://ed-fi.org/ClassroomPositionDescriptor#Teacher of Record\",\r\n",
							"                \"EndDate\": session['EndDate'],\r\n",
							"                \"_etag\": self.faker.uuid4().replace('-','')\r\n",
							"            })\r\n",
							"        return staff_section_associations\r\n",
							"\r\n",
							"\r\n",
							"    def create_staff_school_associations(self, school):\r\n",
							"        staff_school_associations = []\r\n",
							"        for staff in school['_Staffs']:\r\n",
							"            staff_school_associations.append({\r\n",
							"                \"Id\": self.faker.uuid4().replace('-',''),\r\n",
							"                \"SchoolReference\": {\r\n",
							"                    \"SchoolId\": school['SchoolId'],\r\n",
							"                    \"Link\": {\r\n",
							"                        \"rel\": \"School\",\r\n",
							"                        \"href\": \"/ed-fi/schools/{}\".format(school['Id'])\r\n",
							"                    }\r\n",
							"                },\r\n",
							"                \"StaffReference\": {\r\n",
							"                    \"StaffUniqueId\": staff['StaffUniqueId'],\r\n",
							"                    \"Link\": {\r\n",
							"                        \"rel\": \"Staff\",\r\n",
							"                        \"href\": \"/ed-fi/staffs/{}\".format(staff['Id'])\r\n",
							"                    }\r\n",
							"                },\r\n",
							"                \"ProgramAssignmentDescriptor\": self.get_descriptor_string('ProgramAssignmentDescriptor','Regular Education'),\r\n",
							"                \"AcademicSubjects\": [\r\n",
							"                    {\r\n",
							"                        \"AcademicSubjectDescriptor\": self.get_descriptor_string('AcademicSubjectDescriptor',random.choice(SUBJECT_NAMES)[0])\r\n",
							"                    }\r\n",
							"                ],\r\n",
							"                \"GradeLevels\": [\r\n",
							"                    {'GradeLevelDescriptor': self.get_descriptor_string('GradeLevelDescriptor',random.choice(GRADE_LEVEL))} for _ in range(4)\r\n",
							"            ],\r\n",
							"                \"_etag\": self.faker.random_number(digits=10)\r\n",
							"            })\r\n",
							"        return staff_school_associations\r\n",
							"\r\n",
							"    def format_edfi_data(self,data):\r\n",
							"        result = {\r\n",
							"            'Schools':[],\r\n",
							"            'Students':[],\r\n",
							"            'Calendars':[],\r\n",
							"            'Courses':[],\r\n",
							"            'StudentSchoolAssociations':[],\r\n",
							"            'Staffs':[],\r\n",
							"            'Sections': [],\r\n",
							"            'StaffSchoolAssociations':[],\r\n",
							"            'Sessions':[],\r\n",
							"            'StudentSectionAssociations':[],\r\n",
							"            'StaffSectionAssociations':[]\r\n",
							"\r\n",
							"        }\r\n",
							"        for school in data:\r\n",
							"            result['Schools'].append({key: school[key] for key in school if not (key.startswith('_')) })\r\n",
							"            result['Students'] += school['_Students']\r\n",
							"            result['Courses'] += school['_Courses']\r\n",
							"            result['StudentSchoolAssociations'] += school['_StudentAssociations']\r\n",
							"            result['Calendars'].append(school['_Calendars'])\r\n",
							"            result['Staffs'] += school['_Staffs']\r\n",
							"            result['Sections'] += school['_Sections']\r\n",
							"            result['StaffSchoolAssociations'] += school['_StaffSchoolAssociations']\r\n",
							"            result['Sessions'] += school['_Sessions']\r\n",
							"            result['StudentSectionAssociations'] += school['_StudentSectionAssociations']\r\n",
							"            result['StaffSectionAssociations'] += school['_StaffSectionAssociations']\r\n",
							"\r\n",
							"\r\n",
							"        return result\r\n",
							""
						],
						"outputs": [],
						"execution_count": null
					}
				]
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/M365DataGenerator_py')]",
			"type": "Microsoft.Synapse/workspaces/notebooks",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"nbformat": 4,
				"nbformat_minor": 2,
				"bigDataPool": {
					"referenceName": "spark3p1sm",
					"type": "BigDataPoolReference"
				},
				"sessionProperties": {
					"driverMemory": "28g",
					"driverCores": 4,
					"executorMemory": "28g",
					"executorCores": 4,
					"numExecutors": 2,
					"conf": {
						"spark.dynamicAllocation.enabled": "false",
						"spark.dynamicAllocation.minExecutors": "2",
						"spark.dynamicAllocation.maxExecutors": "2",
						"spark.autotune.trackingId": "9c85338e-06af-4d86-8a8f-37b92d86fcfb"
					}
				},
				"metadata": {
					"saveOutput": true,
					"enableDebugMode": false,
					"kernelspec": {
						"name": "synapse_pyspark",
						"display_name": "python"
					},
					"language_info": {
						"name": "python"
					},
					"a365ComputeOptions": {
						"id": "/subscriptions/7b9a4896-4541-483f-bdc7-d8f4ec6be3ee/resourceGroups/rg-oea-CISDAG1/providers/Microsoft.Synapse/workspaces/syn-oea-cisdag1/bigDataPools/spark3p1sm",
						"name": "spark3p1sm",
						"type": "Spark",
						"endpoint": "https://syn-oea-cisdag1.dev.azuresynapse.net/livyApi/versions/2019-11-01-preview/sparkPools/spark3p1sm",
						"auth": {
							"type": "AAD",
							"authResource": "https://dev.azuresynapse.net"
						},
						"sparkVersion": "3.1",
						"nodeCount": 3,
						"cores": 4,
						"memory": 28
					},
					"sessionKeepAliveTimeout": 30
				},
				"cells": [
					{
						"cell_type": "code",
						"source": [
							"import csv\n",
							"import os\n",
							"import shutil\n",
							"import random\n",
							"import math\n",
							"import pandas as pd\n",
							"from datetime import datetime\n",
							"from faker import Faker\n",
							"\n",
							"SUBJECTS = ['Math - Algebra', 'Math - Geometry', 'English Language', 'History - World History',\n",
							"            'Science Biology', 'Health', 'Technology - Programming', 'Physical Education', 'Art', 'Music']\n",
							"SCHOOL_TYPES = ['High', 'High', 'High']\n",
							"\n",
							"\n",
							"class M365DataGenerator:\n",
							"    def __init__(self, activity_min_per_person=5, activity_max_per_person=20, students_per_school=100, classes_in_student_schedule=6, students_per_section=25, student_teacher_ratio=9, include_optional_fields=True,\n",
							"                 fall_semester_start_date='2021-08-15', fall_semester_end_date='2021-12-15', spring_semester_start_date='2022-01-10', spring_semester_end_date='2022-05-10'):\n",
							"        # Set a seed value in Faker so it generates the same values every time it's run\n",
							"        self.faker = Faker('en_US')\n",
							"        Faker.seed(1)\n",
							"\n",
							"        self.activity_min_per_person = activity_min_per_person\n",
							"        self.activity_max_per_person = activity_max_per_person\n",
							"        self.students_per_school = students_per_school\n",
							"        self.classes_in_student_schedule = classes_in_student_schedule\n",
							"        self.students_per_section = students_per_section\n",
							"        self.student_teacher_ratio = student_teacher_ratio\n",
							"        self.include_optional = include_optional_fields\n",
							"        self.fall_semester_start_date = fall_semester_start_date\n",
							"        self.fall_semester_end_date = fall_semester_end_date\n",
							"        self.spring_semester_start_date = spring_semester_start_date\n",
							"        self.spring_semester_end_date = spring_semester_end_date\n",
							"        self.school_year = '2021'\n",
							"\n",
							"        self.teachers_per_school = math.ceil(self.students_per_school/self.student_teacher_ratio)\n",
							"        self.section_id = 1\n",
							"        self.student_id = 1\n",
							"        self.teacher_id = 1\n",
							"        self.course_id = 1\n",
							"        self.school_id = 1\n",
							"        self.term_id = 1\n",
							"        self.domain = '@Classrmtest86.org'\n",
							"\n",
							"    def generate_data(self, num_of_schools, writer):\n",
							"        schools = ''\n",
							"        datetime_str = datetime.now().strftime('%Y-%m-%dT%H%M_%S')\n",
							"\n",
							"        for n in range(num_of_schools):\n",
							"            school_data = self.create_school(n)\n",
							"            m365_data = self.format_m365_data(school_data)\n",
							"            schools += m365_data.pop('Org')\n",
							"            for key in m365_data.keys(): \n",
							"                writer.write(f'm365/{datetime_str}/{key}/part1.csv', m365_data[key])\n",
							"\n",
							"            writer.write(f'contoso_sis/{datetime_str}/studentattendance/part1.csv', school_data.pop('_attendance'))\n",
							"            writer.write(f'contoso_sis/{datetime_str}/studentsectionmark/part1.csv', school_data.pop('_section_marks'))\n",
							"            writer.write(f'contoso_sis/{datetime_str}/students/part1.csv', self.list_of_dict_to_csv(school_data['_students']))\n",
							"\n",
							"            start_date = datetime.strptime(self.fall_semester_start_date, \"%Y-%m-%d\")\n",
							"            end_date = datetime.strptime(self.spring_semester_end_date, \"%Y-%m-%d\")\n",
							"            if end_date > datetime.now(): end_date = datetime.now()\n",
							"\n",
							"            self.create_and_write_activity_data(school_data['_students'], start_date, end_date, f'm365/{datetime_str}/Activity/part1.csv', writer)\n",
							"            self.create_and_write_activity_data(school_data['_teachers'], start_date, end_date, f'm365/{datetime_str}/Activity/part2.csv', writer)\n",
							"\n",
							"        writer.write(f'm365/{datetime_str}/Org/part1.csv', schools)\n",
							"\n",
							"    def create_school(self, school_id):\n",
							"        school_id = 'sch' + str(school_id)\n",
							"        fname = self.faker.first_name()\n",
							"        lname = self.faker.last_name()\n",
							"        school = {\n",
							"            'SIS ID': school_id,\n",
							"            'Name': self.get_fake_school_name(),\n",
							"            'School Number': school_id if self.include_optional else '',\n",
							"            'School NCES_ID': school_id if self.include_optional else '',\n",
							"            'Grade Low': '9' if self.include_optional else '',\n",
							"            'Grade High': '12' if self.include_optional else '',\n",
							"            'State ID': school_id if self.include_optional else '',\n",
							"            'Principal SIS ID': '02100' if self.include_optional else '',\n",
							"            'Principal Name': f\"{fname} {lname}\" if self.include_optional else '',\n",
							"            'Principal Secondary Email': f\"{fname.lower()}.{lname.lower()}{self.domain}\" if self.include_optional else '',\n",
							"            'Address': self.faker.building_number() if self.include_optional else '',\n",
							"            'City': self.faker.city() if self.include_optional else '',\n",
							"            'State': 'WA' if self.include_optional else '',\n",
							"            'Zip': '98074' if self.include_optional else '',\n",
							"            'Country': 'US' if self.include_optional else '',\n",
							"            'Phone': self.faker.phone_number() if self.include_optional else '',\n",
							"            'Zone': '1' if self.include_optional else '',\n",
							"        }\n",
							"\n",
							"        school['_calendar'] = {'Id': f'edp_cal{school_id}',\n",
							"                            'Name': f'{self.school_year} Calendar',\n",
							"                            'Description': f'calendar for {self.school_year}',\n",
							"                            'SchoolYear': self.school_year,\n",
							"                            'IsCurrent': 'True',\n",
							"                            'ExternalId': f'cal{school_id}',\n",
							"                            'CreateDate': '8/13/2020 10:36:44 AM',\n",
							"                            'LastModifiedDate': '8/15/2020 11:36:00 PM',\n",
							"                            'IsActive': 'True',\n",
							"                            'OrgId': f'edp_{school_id}'\n",
							"                            }\n",
							"        school['_students'] = self.create_students(school['SIS ID'])\n",
							"        school['_teachers'] = self.create_teachers(school['SIS ID'])\n",
							"        school['_courses'] = self.create_courses(school['_calendar']['Id'])\n",
							"        school['_terms'] = self.create_terms(school['_calendar']['Id'])\n",
							"        for term in school['_terms']:\n",
							"            self.create_sections(term, school['SIS ID'], school['_courses'])\n",
							"\n",
							"        self.add_student_data(school) # adds student_section_membership, attendance, section_marks\n",
							"        self.add_teacher_data(school) # staff_section_membership\n",
							"\n",
							"        return school\n",
							"\n",
							"    def format_m365_data(self, school):\n",
							"        ref_aad_id = '7DAF8820-6691-4D61-A210-CE94EA7D3667'\n",
							"        ref_upn_id = '450E6525-61A6-4BF6-A3D5-F95EB5CB1183'\n",
							"        parent_org_id = 'sch0'\n",
							"        ref_org_type_district = '1198ADF7-3DA7-4DA6-A8CB-6FC3313C063C'\n",
							"        ref_org_type_school = '0AA7E195-1576-440B-817C-BCCA6949E2ED'\n",
							"        ref_student_org_role = '0D16FCED-6DC7-4235-90BF-724D40ABC7BD'\n",
							"        ref_staff_org_role = '03FFC8C5-9C64-4321-8041-334F07A252F0'\n",
							"        ref_enrollment_status = 'F36F047A-F410-4761-B41F-17B952A8EAD4'\n",
							"        ref_section_type = '96669810-AB33-4B0F-92BE-6E2CC6F30EE9'\n",
							"        ref_session_type = '1C69DBD1-5CDA-44B2-AEAA-510F9D5DA98D'\n",
							"        source_system_id = 'edp_SIS1'\n",
							"        datetime_str = \"8/13/2020 10:09:43 AM\"        \n",
							"\n",
							"        m365_data = {}\n",
							"        m365_data['RefDefinition'] = REF_DEFINITION_CSV\n",
							"        m365_data['Calendar'] = self.obj_to_csv(school['_calendar']) + \"\\n\"\n",
							"        m365_data['Org'] = f\"edp_{school['SIS ID']},{school['Name']},{school['School Number']},{school['SIS ID']},{datetime_str},{datetime_str},True,edp_{parent_org_id},{ref_org_type_school},{source_system_id}\\n\"\n",
							"        m365_data['StudentSectionMembership'] = school['_student_section_membership']\n",
							"        m365_data['StaffSectionMembership'] = school['_staff_section_membership']\n",
							"\n",
							"        m365_data['Person'] = ''\n",
							"        m365_data['StudentOrgAffiliation'] = ''\n",
							"        m365_data['StaffOrgAffiliation'] = ''\n",
							"        m365_data['PersonIdentifier'] = ''\n",
							"        m365_data['Section'] = ''\n",
							"        m365_data['Session'] = ''\n",
							"        m365_data['Course'] = ''\n",
							"\n",
							"        for student in school['_students']:\n",
							"            m365_data['StudentOrgAffiliation'] += f\"edp_oa_{student['SIS ID']},True,,,oa_{student['SIS ID']},{datetime_str},{datetime_str},True,edp_{school['SIS ID']},edp_{student['SIS ID']},{self.get_grade_ref(student['Grade'])},{ref_student_org_role},{ref_enrollment_status}\\n\"\n",
							"            m365_data['Person'] += f\"edp_{student['SIS ID']},{student['First Name']},{student['Middle Name']},{student['Last Name']},,,True,{student['SIS ID']},{datetime_str},{datetime_str},True,{source_system_id}\\n\"\n",
							"            m365_data['PersonIdentifier'] += f\"edp_pi1_{student['SIS ID']},{student['_upn']},,{ref_upn_id},pi1_{student['SIS ID']},{datetime_str},{datetime_str},True,edp_{student['SIS ID']},{source_system_id}\\n\"\n",
							"            m365_data['PersonIdentifier'] += f\"edp_pi2_{student['SIS ID']},{student['_aad']},,{ref_aad_id},pi2_{student['SIS ID']},{datetime_str},{datetime_str},True,edp_{student['SIS ID']},{source_system_id}\\n\"\n",
							"        for teacher in school['_teachers']:\n",
							"            m365_data['StaffOrgAffiliation'] += f\"edp_oa_{teacher['SIS ID']},True,,,oa_{teacher['SIS ID']},{datetime_str},{datetime_str},True,edp_{school['SIS ID']},edp_{teacher['SIS ID']},,{ref_staff_org_role}\\n\"\n",
							"            m365_data['Person'] += f\"edp_{teacher['SIS ID']},{teacher['First Name']},{teacher['Middle Name']},{teacher['Last Name']},,,True,{teacher['SIS ID']},{datetime_str},{datetime_str},True,{source_system_id}\\n\"\n",
							"            m365_data['PersonIdentifier'] += f\"edp_pi1_{teacher['SIS ID']},{teacher['_upn']},,{ref_upn_id},pi1_{teacher['SIS ID']},{datetime_str},{datetime_str},True,edp_{teacher['SIS ID']},{source_system_id}\\n\"\n",
							"            m365_data['PersonIdentifier'] += f\"edp_pi2_{teacher['SIS ID']},{teacher['_aad']},,{ref_aad_id},pi2_{teacher['SIS ID']},{datetime_str},{datetime_str},True,edp_{teacher['SIS ID']},{source_system_id}\\n\"\n",
							"        for term in school['_terms']:\n",
							"        # todo: need to convert the term startdate and enddate to be the format that is expected to be coming from EDP (rather than the format used for sds)\n",
							"            m365_data['Session'] += f\"edp_{term['Term SIS ID']},{term['Term Name']},{term['Term StartDate']},{term['Term EndDate']},{term['Term SIS ID']},8/13/2020 10:36:44 AM,8/15/2020 11:36:00 PM,True,{term['_calendar_id']},,{ref_session_type}\\n\"\n",
							"        for section in term['_sections']:\n",
							"            m365_data['Section'] += f\"edp_{section['SIS ID']},{section['Section Name']},{section['Section Number']},,{section['SIS ID']},{datetime_str},{datetime_str},True,edp_{section['Course SIS ID']},{ref_section_type},edp_{section['Term SIS ID']},edp_{section['School SIS ID']}\\n\"\n",
							"        for course in school['_courses']:\n",
							"        # columns for DIP csv are: Id,Name,Code,Description,ExternalId,CreateDate,LastModifiedDate,IsActive,CalendarId\n",
							"            m365_data['Course'] += f\"edp_{course['Course SIS ID']},{course['Course Name']},{course['Course Number']},{course['Course Description']},{course['Course SIS ID']},8/13/2020 10:36:44 AM,8/15/2020 11:36:00 PM,True,{course['_calendar_id']}\\n\"\n",
							"\n",
							"        return m365_data\n",
							"\n",
							"    def create_terms(self, calendar_id):\n",
							"        terms = []\n",
							"        terms.append({\n",
							"            'Term SIS ID': 'term' + str(self.term_id),\n",
							"            'Term Name': 'Fall Semester',\n",
							"            'Term StartDate': '9/1/2019',\n",
							"            'Term EndDate': '12/22/2019',\n",
							"            '_sections': [],\n",
							"            # this is an array of arrays representing the sections and the spots (available seats) within each section\n",
							"            '_section_spots': [],\n",
							"            '_calendar_id': calendar_id\n",
							"        })\n",
							"        self.term_id += 1\n",
							"        terms.append({\n",
							"            'Term SIS ID': 'term' + str(self.term_id),\n",
							"            'Term Name': 'Spring Semester',\n",
							"            'Term StartDate': '1/21/2020',\n",
							"            'Term EndDate': '5/30/2020',\n",
							"            '_sections': [],\n",
							"            '_section_spots': [],\n",
							"            '_calendar_id': calendar_id\n",
							"        })\n",
							"        self.term_id += 1\n",
							"        return terms\n",
							"\n",
							"    def create_courses(self, calendar_id):\n",
							"        courses = []\n",
							"        for subject in SUBJECTS:\n",
							"            courses.append({\n",
							"                'Course SIS ID': 'course' + str(self.course_id),\n",
							"                'Course Name': subject,\n",
							"                'Course Number': str(self.course_id),\n",
							"                'Course Description': \"Instruction covering \" + subject,\n",
							"                'Course Subject': subject,\n",
							"                '_calendar_id': calendar_id\n",
							"            })\n",
							"            self.course_id += 1\n",
							"        return courses\n",
							"\n",
							"    def create_students(self, school_id):\n",
							"        students = []\n",
							"        for n in range(self.students_per_school):\n",
							"            gender = random.choice(['Male', 'Female'])\n",
							"            if gender == 'Male': fname = self.faker.first_name_male()\n",
							"            else: fname = self.faker.first_name_female()\n",
							"\n",
							"            fname = self.faker.first_name()\n",
							"            lname = self.faker.last_name()\n",
							"            email = f\"{fname.lower()}{lname.lower()}{self.student_id}{self.domain}\"\n",
							"            students.append({\n",
							"                'SIS ID': 'st' + str(self.student_id),\n",
							"                'School SIS ID': school_id,\n",
							"                'Username': f\"{fname.lower()}{lname.lower()}{self.student_id}\",\n",
							"                'Password': self.faker.password() if self.include_optional else '',\n",
							"                'First Name': fname,\n",
							"                'Last Name': lname,\n",
							"                'Middle Name': self.faker.first_name() if self.include_optional else '',\n",
							"                'Secondary Email': email if self.include_optional else '',\n",
							"                'Student Number': str(self.student_id) if self.include_optional else '',\n",
							"                'Grade': random.choice(['9', '10', '11', '12']) if self.include_optional else '',\n",
							"                'State ID': '123' if self.include_optional else '',\n",
							"                'Status': 'Active' if self.include_optional else '',\n",
							"                'Birthdate': '4/2/2004' if self.include_optional else '',\n",
							"                'Graduation Year': '2020' if self.include_optional else '',\n",
							"                'Gender': gender,\n",
							"                'FederalRaceCategory': random.choice(['Asian', 'Black', 'White', 'Hispanic', 'American Indian']),\n",
							"                'PrimaryLanguage': random.choices(['English', 'Spanish', 'German', 'French', 'Japanese'], weights=(85, 10, 2, 2, 1))[0],\n",
							"                'ELLStatus': random.choices(['', 'English Learner', 'Initially Fluent English Proficient', 'Redesignated Fluent English Proficient'], weights=(80, 10, 5, 5))[0],\n",
							"                'SpecialEducation': random.choices(['', 'Designated Instruction Service', 'Resource Specialty Program', 'Special Day Class'], weights=(80, 10, 5, 5))[0],\n",
							"                'LowIncome': random.choices([0, 1], weights=(60, 40))[0],\n",
							"                'CumulativeGPA': random.choice([0.523, 0.423, 1.13, 2.63, 2.33, 3.33, 4.0]),                \n",
							"                '_role': 'Student',\n",
							"                '_section_ids': [],\n",
							"                '_upn': email,\n",
							"                '_aad': self.faker.uuid4()\n",
							"            })\n",
							"            self.student_id += 1\n",
							"        return students\n",
							"\n",
							"    def create_teachers(self, school_id):\n",
							"        teachers = []\n",
							"        for n in range(self.teachers_per_school):\n",
							"            fname = self.faker.first_name()\n",
							"            lname = self.faker.last_name()\n",
							"            email = f\"{fname.lower()}{lname.lower()}{self.teacher_id}{self.domain}\"\n",
							"            teachers.append({\n",
							"                'SIS ID': 't' + str(self.teacher_id),\n",
							"                'School SIS ID': school_id,\n",
							"                'Username': f\"{fname.lower()}{lname.lower()}{self.teacher_id}\",\n",
							"                'Password': self.faker.password() if self.include_optional else '',\n",
							"                'First Name': fname,\n",
							"                'Last Name': lname,\n",
							"                'Middle Name': self.faker.first_name() if self.include_optional else '',\n",
							"                'Secondary Email': email if self.include_optional else '',\n",
							"                'Teacher Number': str(self.teacher_id) if self.include_optional else '',\n",
							"                'State ID': '123' if self.include_optional else '',\n",
							"                'Status': 'Active' if self.include_optional else '',\n",
							"                'Title': 'Teacher' if self.include_optional else '',\n",
							"                'Qualification': 'EdLD' if self.include_optional else '',\n",
							"                '_role': 'Teacher',\n",
							"                '_section_ids': [],\n",
							"                '_upn': email,\n",
							"                '_aad': self.faker.uuid4()\n",
							"            })\n",
							"            self.teacher_id += 1\n",
							"        return teachers\n",
							"\n",
							"    def create_sections(self, term, school_id, courses):\n",
							"        spots_needed = self.students_per_school * self.classes_in_student_schedule\n",
							"        # determine the number of sections needed\n",
							"        sections_needed = math.ceil(spots_needed / self.students_per_section) + 1\n",
							"        for n in range(sections_needed):\n",
							"            course = random.choice(courses)\n",
							"            term['_sections'].append({\n",
							"                'SIS ID': 'sec' + str(self.section_id),\n",
							"                'School SIS ID': school_id,\n",
							"                'Section Name': course['Course Subject'] + \" \" + str(self.section_id),\n",
							"                'Section Number': str(self.section_id) if self.include_optional else '',\n",
							"                'Term SIS ID': term['Term SIS ID'] if self.include_optional else '',\n",
							"                'Term Name': term['Term Name'] if self.include_optional else '',\n",
							"                'Term StartDate': term['Term StartDate'] if self.include_optional else '',\n",
							"                'Term EndDate': term['Term EndDate'] if self.include_optional else '',\n",
							"                'Course SIS ID': course['Course SIS ID'] if self.include_optional else '',\n",
							"                'Course Name': course['Course Name'] if self.include_optional else '',\n",
							"                'Course Number': course['Course Number'] if self.include_optional else '',\n",
							"                'Course Description': course['Course Description'] if self.include_optional else '',\n",
							"                'Course Subject': course['Course Subject'] if self.include_optional else '',\n",
							"                'Periods': '2' if self.include_optional else '',\n",
							"                'Status': 'Active' if self.include_optional else ''\n",
							"            })\n",
							"            # add section spots\n",
							"            spots = []\n",
							"            for i in range(self.students_per_section):\n",
							"                spots.append('sec' + str(self.section_id))\n",
							"            term['_section_spots'].append(spots)\n",
							"            self.section_id += 1\n",
							"\n",
							"    def get_grade_ref(self, grade_str):\n",
							"        if grade_str == '9': return '4429F333-536A-458F-AE87-FDF5471B5E8D'\n",
							"        elif grade_str == '10': return 'B6747F48-667B-4F0D-8438-9D1B180A3791'\n",
							"        elif grade_str == '11': return '490702EA-9AC0-435E-AB8F-C1999BB0B393'\n",
							"        else: return '37DB651A-E2CC-4C16-8F52-27D4FA17B680'\n",
							"\n",
							"    def add_student_data(self, school):\n",
							"        ref_student_section_role = 'D1CA502E-DB62-41D2-B438-AC669E6A9663'\n",
							"        datetime_str = \"8/13/2020 10:09:43 AM\"\n",
							"        mark_id = 1\n",
							"        school['_student_section_membership'] = ''\n",
							"        school['_attendance'] = 'id,student_id,school_year,school_id,attendance_date,all_day,Period,section_id,AttendanceCode,PresenceFlag,attendance_status,attendance_type,attendance_sequence\\n'\n",
							"        school['_section_marks'] = 'id,student_id,section_id,school_year,term_id,numeric_grade_earned,alpha_grade_earned,is_final_grade,credits_attempted,credits_earned,grad_credit_type\\n'\n",
							"\n",
							"        for student in school['_students']:\n",
							"            for term in school['_terms']:\n",
							"                num_enrollments = 0\n",
							"                for section_spots in term['_section_spots']:\n",
							"                    if(len(section_spots) == 0): \n",
							"                        continue\n",
							"                    else:\n",
							"                        spot_taken = section_spots.pop()\n",
							"                        student['_section_ids'].append(spot_taken)\n",
							"                        school['_student_section_membership'] += f\"edp_ssm_{student['SIS ID']},,,ssm_{student['SIS ID']},{datetime_str},{datetime_str},True,edp_{student['SIS ID']},,{ref_student_section_role},edp_{spot_taken}\\n\"\n",
							"                        num_enrollments += 1\n",
							"                        school['_attendance'] += self.create_section_attendance(school['SIS ID'], student['SIS ID'], self.school_year, spot_taken,term['Term StartDate'], term['Term EndDate'])\n",
							"                        grade = self.get_random_grade()\n",
							"                        credits_earned = 5\n",
							"                        if grade[1] == 'F': credits_earned = 0\n",
							"                        school['_section_marks'] += f\"m{mark_id},{student['SIS ID']},{spot_taken},,{term['Term SIS ID']},{grade[0]},{grade[1]},No,5,{credits_earned},\\n\"\n",
							"                        mark_id += 1\n",
							"                    if (num_enrollments >= self.classes_in_student_schedule): break        \n",
							"\n",
							"    def create_section_attendance(self, school_id, student_id, school_year, section_id, start_date, end_date):\n",
							"        attendance = ''\n",
							"        date_range = pd.date_range(datetime.strptime(start_date, \"%m/%d/%Y\"), datetime.strptime(end_date, \"%m/%d/%Y\"))\n",
							"        for single_date in date_range:\n",
							"            attendance_code = random.choices(['P', 'A'], weights=(80,20))[0]\n",
							"            if attendance_code == 'P':\n",
							"                presence_flag = 1\n",
							"                attendance_status = 'Present'\n",
							"            else: \n",
							"                presence_flag = 0\n",
							"                attendance_status = 'Absent'\n",
							"            attendance += f\"att_{student_id},{student_id},{school_year},{school_id},{single_date.strftime('%d/%m/%Y')},No,1,{section_id},{attendance_code},{presence_flag},{attendance_status},ClassSectionAttendance,0\\n\"\n",
							"        return attendance\n",
							"\n",
							"\n",
							"    def add_teacher_data(self, school):\n",
							"        ref_staff_section_role = 'C943E793-2DB7-47C0-B187-A9ED65EEBD5B'\n",
							"        datetime_str = \"8/13/2020 10:09:43 AM\"\n",
							"        school['_staff_section_membership'] = ''\n",
							"        for term in school['_terms']:\n",
							"            teacher_index = 0\n",
							"            for section in term['_sections']:\n",
							"                teacher = school['_teachers'][teacher_index]\n",
							"                teacher['_section_ids'].append(section['SIS ID'])\n",
							"                school['_staff_section_membership'] += f\"edp_ssm_{teacher['SIS ID']},True,,,ssm_{teacher['SIS ID']},{datetime_str},{datetime_str},True,edp_{teacher['SIS ID']},{ref_staff_section_role},edp_{section['SIS ID']}\\n\"\n",
							"                teacher_index += 1\n",
							"                if (teacher_index == len(school['_teachers'])):\n",
							"                    teacher_index = 0  # start over from the beginning of the list of teachers\n",
							"\n",
							"    def create_and_write_activity_data(self, people, start_date, end_date, path_and_filename, writer):\n",
							"        signal_id_counter = 100\n",
							"        signal_types = ['VisitTeamChannel', 'ReactedWithEmoji', 'PostChannelMessage', 'ReplyChannelMessage', 'ExpandChannelMessage', 'CallRecordSummarized', 'FileAccessed', 'FileDownloaded',\n",
							"                        'FileModified', 'FileUploaded', 'ShareNotificationRequested', 'CommentCreated', 'UserAtMentioned', 'AddedToSharedWithMe', 'CommentDeleted', 'Unlike']\n",
							"        agents = ['', '\"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.182 Safari/537.36 Edg/88.0.705.74\"', '\"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Teams/1.3.00.34662 Chrome/80.0.3987.165 Electron/8.5.1 Safari/537.36\"',\n",
							"                '\"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.141 Safari/537.36\"', '\"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:78.0) Gecko/20100101 Firefox/78.0\"']\n",
							"        applications = ['Other apps', 'Teams', 'PowerPoint', 'Excel', 'PDF viewers', 'Media apps', 'Image apps', 'Word']\n",
							"        learning_activities = ['Communications', 'Assignments', 'Meetings']\n",
							"\n",
							"        # activity_csv.write('SignalType,StartTime,UserAgent,SignalId,SISClassId,OfficeClassId,ChannelId,AppName,ActorId,ActorRole,SchemaVersion,AssignmentId,SubmissionId,Action,AssginmentDueDate,ClassCreationDate,Grade,SourceFileExtension,MeetingDuration')\n",
							"        num_of_entries_for_person = self.faker.pyint(min_value=self.activity_min_per_person, max_value=self.activity_max_per_person)\n",
							"        for i in range(num_of_entries_for_person):\n",
							"            for person in people:\n",
							"                signal_type = random.choice(signal_types)\n",
							"                start_time = f\"{self.faker.date_time_between_dates(start_date, end_date)}.0000000\"\n",
							"                agent = random.choice(agents)\n",
							"                signal_id = self.faker.uuid4()\n",
							"                sis_class_id = random.choice(person['_section_ids'])\n",
							"                office_class_id = f\"office_id_{sis_class_id}\"\n",
							"                if signal_type == 'CallRecordSummarized':\n",
							"                    channel_id = f\"channel_{office_class_id}\"\n",
							"                else:\n",
							"                    channel_id = ''\n",
							"                app_name = random.choice(applications)\n",
							"                actor_id = person['_aad']\n",
							"                actor_role = person['_role']\n",
							"                schema_version = '1.06'\n",
							"                assignmentId = ''\n",
							"                submissionId = ''\n",
							"                action = ''\n",
							"                assginment_due_date = ''\n",
							"                class_creation_date = ''\n",
							"                grade = ''\n",
							"                source_file_extension = ''\n",
							"\n",
							"                hours = self.faker.pyint(min_value=0, max_value=23)\n",
							"                minutes = self.faker.pyint(min_value=0, max_value=59)\n",
							"                meeting_duration = f'00:{hours:02}:{minutes:02}'\n",
							"\n",
							"                # SignalType,StartTime,UserAgent,SignalId,SISClassId,OfficeClassId,ChannelId,AppName,ActorId,ActorRole,SchemaVersion,AssignmentId,SubmissionId,Action,AssginmentDueDate,ClassCreationDate,Grade,SourceFileExtension,MeetingDuration\n",
							"                writer.write(path_and_filename, f\"{signal_type},{start_time},{agent},{signal_id},{sis_class_id},{office_class_id},{channel_id},{app_name},{actor_id},{actor_role},{schema_version},{assignmentId},{submissionId},{action},{assginment_due_date},{class_creation_date},{grade},{source_file_extension},{meeting_duration}\\n\")\n",
							"\n",
							"    def get_fake_school_name(self):\n",
							"        name = self.faker.last_name()\n",
							"        if name == 'Ho': return self.get_fake_school_name()\n",
							"        else: return f\"{name} {random.choice(SCHOOL_TYPES)}\"\n",
							"\n",
							"    def get_random_grade(self):\n",
							"        num = random.randint(55, 110)\n",
							"        grade = ''\n",
							"        if num < 60: grade = 'F'\n",
							"        elif num >= 60 and num < 70: grade = 'D'\n",
							"        elif num >= 70 and num < 80: grade = 'C'\n",
							"        elif num >= 80 and num < 90: grade = 'B'\n",
							"        elif num >= 90: grade = 'A'\n",
							"        return [str(num), grade]\n",
							"\n",
							"    def list_of_dict_to_csv(self, list_of_dict):\n",
							"        csv_str = ''\n",
							"        header = []\n",
							"        for column_name in list_of_dict[0].keys(): \n",
							"            if not column_name.startswith('_'): header.append(column_name)\n",
							"        csv_str += \",\".join(header) + \"\\n\"\n",
							"\n",
							"        for row in list_of_dict:\n",
							"            csv_str += self.obj_to_csv(row) + \"\\n\"\n",
							"\n",
							"        return csv_str[:-1] # chop the final newline char\n",
							"\n",
							"    def obj_to_csv(self, obj):\n",
							"        csv = ''\n",
							"        for key in obj:\n",
							"            if not (key.startswith('_')): csv += str(obj[key]) + ','\n",
							"        return csv[:-1]        \n",
							"\n",
							"REF_DEFINITION_CSV=\"\"\"\n",
							"    F27548AC-5978-4DC7-8897-1F51FBBD269F,RefPhoneNumberType,ceds.ed.gov,Home,10,Home,True\n",
							"    1C20AA37-0D47-428A-9886-275D9314683B,RefPhoneNumberType,ceds.ed.gov,Work,20,Work,True\n",
							"    27127BF9-D27F-4550-8DB5-F5C45B9F300A,RefPhoneNumberType,ceds.ed.gov,Mobile,30,Mobile,True\n",
							"    2058208C-D839-4050-811E-5C967ED3479A,RefPhoneNumberType,ceds.ed.gov,Fax,40,Fax,True\n",
							"    F72DB3A7-60D1-4205-BCCE-261A5C70392A,RefPhoneNumberType,ceds.ed.gov,SMS,50,SMS (text),True\n",
							"    BAB42A97-EF46-4D19-BD7C-A16042D69290,RefPhoneNumberType,ceds.ed.gov,Other,60,Other,True\n",
							"    296C8859-65B6-41AF-9AC3-A756F805AA7A,RefEmailAddressType,ceds.ed.gov,Home,10,Home/personal,True\n",
							"    2BD5CAF9-B2E2-4BB9-9634-D7F9D9C99942,RefEmailAddressType,ceds.ed.gov,Work,20,Work,True\n",
							"    B62C5FF6-9C7C-4282-99DA-D989E975FED9,RefEmailAddressType,ceds.ed.gov,Organizational,30,Organizational,True\n",
							"    BE4EDAD4-273B-4AC0-B0A9-4AEAAA4D72FC,RefEmailAddressType,ceds.ed.gov,Other,40,Other,True\n",
							"    C7BA7784-18EA-48F7-A8CE-8F85317DB1FC,RefSessionType,imsglobal.org,gradingPeriod,10,Grading Period,True\n",
							"    1C69DBD1-5CDA-44B2-AEAA-510F9D5DA98D,RefSessionType,imsglobal.org,semester,20,Semester,True\n",
							"    535E0286-C64B-4E96-8866-8F05F7FD4B7D,RefSessionType,imsglobal.org,schoolYear,30,School Year,True\n",
							"    D3244521-1657-44CC-878D-A731819A8C10,RefSessionType,imsglobal.org,term,40,Term,True\n",
							"    9FC6B036-76CB-49C1-9B54-52B6DEA89B13,RefSessionType,imsglobal.org,quarter,50,Quarter,True\n",
							"    9CFF5B20-9F10-40CD-BE70-337E1D45EC22,RefOrgType,imsglobal.org,department,10,Department,True\n",
							"    0AA7E195-1576-440B-817C-BCCA6949E2ED,RefOrgType,imsglobal.org,school,20,School,True\n",
							"    1198ADF7-3DA7-4DA6-A8CB-6FC3313C063C,RefOrgType,imsglobal.org,district,30,District,True\n",
							"    DD0FD78C-8E83-4561-BCA9-D622C17239B1,RefOrgType,imsglobal.org,local,40,Local,True\n",
							"    92FBF859-EAF5-44DB-A009-F078DC5D9624,RefOrgType,imsglobal.org,state,50,State,True\n",
							"    CB89C3EF-00C6-4887-86F6-025E85EE0CD5,RefOrgType,imsglobal.org,national,60,National,True\n",
							"    0D70E313-D121-4BEB-873E-32AB1BE585BB,RefOrgType,microsoft.com,departmentOfEducation,70,Department of Education,True\n",
							"    A876151F-8E7B-4E0D-AD5E-1644489C06E2,RefOrgType,microsoft.com,ministryOfEducation,80,Ministry of Education,True\n",
							"    4EF75D0A-C056-4708-BBA8-93974487E3FB,RefOrgType,microsoft.com,university,90,University,True\n",
							"    A330F267-036A-49FD-9E41-BD04E33F72B4,RefOrgType,microsoft.com,college,100,College,True\n",
							"    9E5B404E-F884-4213-BB5A-C13896B3C64F,RefOrgType,microsoft.com,campus,110,Campus,True\n",
							"    E4DC78EC-B83E-490E-B2AC-A4002F2A1011,RefOrgType,microsoft.com,adultEducation,120,Adult Education,True\n",
							"    3F7E3E4A-17D8-4528-8023-4C51E1135DAF,RefAcademicSubject,ceds.ed.gov,13371,10,Arts,False\n",
							"    A8B9FD82-A3FE-4B58-B965-6D2485CAF4FF,RefAcademicSubject,ceds.ed.gov,73065,20,Career and Technical Education,False\n",
							"    75C20E7F-4064-4E66-93D1-AD60D8AF03E3,RefAcademicSubject,ceds.ed.gov,13372,30,English,False\n",
							"    B28AA87C-9357-40F3-8F3F-468D76100470,RefAcademicSubject,ceds.ed.gov,256,40,English as a second language (ESL),False\n",
							"    11F6E7A0-188D-4F29-9A85-D6C64DEBF51A,RefAcademicSubject,ceds.ed.gov,546,50,Foreign Languages,False\n",
							"    785C7805-478C-437E-9D0F-A42085F19CA6,RefAcademicSubject,ceds.ed.gov,73088,60,History Government - US,False\n",
							"    67B144F0-B0B7-4B48-B948-A1C0C41C2316,RefAcademicSubject,ceds.ed.gov,73089,70,History Government - World,False\n",
							"    8C053948-3868-4172-8439-90F3C763C1FB,RefAcademicSubject,ceds.ed.gov,554,80,Language arts,False\n",
							"    406A9BDB-D00A-47B2-9B58-0D7C6BA4B5F3,RefAcademicSubject,ceds.ed.gov,1166,90,Mathematics,False\n",
							"    6542AAA2-4241-41FA-8003-FE0D55C8C9B5,RefAcademicSubject,ceds.ed.gov,560,100,Reading,False\n",
							"    EFE570C8-4863-41B1-8F7A-6FE6F17C3FF9,RefAcademicSubject,ceds.ed.gov,13373,110,Reading/Language Arts,False\n",
							"    C78DB896-4E57-4118-93B0-4FBC0CFB4892,RefAcademicSubject,ceds.ed.gov,562,120,Science,False\n",
							"    C105C6B3-3CF9-472F-B865-043979160403,RefAcademicSubject,ceds.ed.gov,73086,130,Science - Life,False\n",
							"    8270A5B4-961D-49BC-93FF-B11B9A355800,RefAcademicSubject,ceds.ed.gov,73087,140,Science - Physical,False\n",
							"    857C8075-F125-4316-9C7D-C6F06A59A3B4,RefAcademicSubject,ceds.ed.gov,13374,150,\"Social Sciences (History, Geography, Economics, Civics and Government)\",False\n",
							"    71C56B0D-AD9A-44A9-83BD-B1346BA735FD,RefAcademicSubject,ceds.ed.gov,2043,160,Special education,False\n",
							"    D998AFA4-15B2-454E-AD56-9BD67562DE09,RefAcademicSubject,ceds.ed.gov,1287,170,Writing,False\n",
							"    125AD8F4-CBC2-4780-8ECA-766F6BB3616F,RefAcademicSubject,ceds.ed.gov,9999,180,Other,False\n",
							"    AF074314-C807-431D-849E-5C56DCFD56FB,RefSex,ceds.ed.gov,Male,10,Male,True\n",
							"    7BA57431-93E6-4F3A-B74F-56C84749E9A7,RefSex,ceds.ed.gov,Female,20,Female,True\n",
							"    FEA3A014-218A-470A-AB59-12F3064DC397,RefSex,ceds.ed.gov,Not selected,30,Not selected,True\n",
							"    C855A445-E7CC-4093-B6E3-E4B887C6FD92,RefState,ceds.ed.gov,AK,10,Alaska,True\n",
							"    16B07D3F-571C-40E6-92AA-73178BEF1542,RefState,ceds.ed.gov,AL,20,Alabama,True\n",
							"    50F6DDCA-C75C-4AFE-A024-0D2A0BF9D6CC,RefState,ceds.ed.gov,AR,30,Arkansas,True\n",
							"    EA24B73C-B071-453B-9E8A-8BD6E1AE19B8,RefState,ceds.ed.gov,AS,40,American Samoa,True\n",
							"    F24214B4-5DED-44D0-B29B-321BE28BCB93,RefState,ceds.ed.gov,AZ,50,Arizona,True\n",
							"    FC8D5952-EF82-465A-9D0B-62A06C58C0EE,RefState,ceds.ed.gov,CA,60,California,True\n",
							"    4A08E734-6101-4C0D-A066-E65F9183ED8A,RefState,ceds.ed.gov,CO,70,Colorado,True\n",
							"    05950FFE-C9F6-4918-8362-E7B7A5202C3C,RefState,ceds.ed.gov,CT,80,Connecticut,True\n",
							"    526B4BFB-5A10-40F5-BF4B-9704567AEF4D,RefState,ceds.ed.gov,DC,90,District of Columbia,True\n",
							"    9D61F8B8-EF3D-40EF-81CE-B59F69632F53,RefState,ceds.ed.gov,DE,100,Delaware,True\n",
							"    4FCAF288-4928-4450-8793-9852C29C2315,RefState,ceds.ed.gov,FL,110,Florida,True\n",
							"    35B9C40A-617F-4633-AA76-A56D5147E89E,RefState,ceds.ed.gov,FM,120,Federated States of Micronesia,True\n",
							"    FF5BC2E2-1D44-4B7B-8467-7643A6ABA583,RefState,ceds.ed.gov,GA,130,Georgia,True\n",
							"    4A38E332-EA89-4625-86D8-016B0628CA9C,RefState,ceds.ed.gov,GU,140,Guam,True\n",
							"    51F07FB9-AE06-4F3C-A8F2-99BAA9F143C2,RefState,ceds.ed.gov,HI,150,Hawaii,True\n",
							"    744C35E4-8B9F-43F2-BB8A-DDFBF860E581,RefState,ceds.ed.gov,IA,160,Iowa,True\n",
							"    84ADEB70-7F0E-4EEC-AC69-61C3EB5186D6,RefState,ceds.ed.gov,ID,170,Idaho,True\n",
							"    2770B048-41B8-4ADC-AC7D-359BE9CA77D3,RefState,ceds.ed.gov,IL,180,Illinois,True\n",
							"    55D9B58E-7FAA-4D83-8DCC-5C2D9D905444,RefState,ceds.ed.gov,IN,190,Indiana,True\n",
							"    D3B16F02-6C56-4D72-8088-23A56C8C353A,RefState,ceds.ed.gov,KS,200,Kansas,True\n",
							"    85F3BB5F-533D-4104-813C-8A5BAC6BED76,RefState,ceds.ed.gov,KY,210,Kentucky,True\n",
							"    D3355BB2-71AE-43C8-93A4-8A94AD3D368A,RefState,ceds.ed.gov,LA,220,Louisiana,True\n",
							"    994F7CFE-D3CA-4B25-9331-630DF404BACC,RefState,ceds.ed.gov,MA,230,Massachusetts,True\n",
							"    3F854FB2-918B-495D-9B6C-7E68975A5FB3,RefState,ceds.ed.gov,MD,240,Maryland,True\n",
							"    E8E5C5DD-6C00-4D79-91F0-9667C191D53D,RefState,ceds.ed.gov,ME,250,Maine,True\n",
							"    91AEB1E0-02AD-43AC-BBDA-C6C6F2EB8229,RefState,ceds.ed.gov,MH,260,Marshall Islands,True\n",
							"    8D5F6125-EDC8-4617-8625-CDCA447F0210,RefState,ceds.ed.gov,MI,270,Michigan,True\n",
							"    92093A91-AD63-4C8E-A241-54791538B51C,RefState,ceds.ed.gov,MN,280,Minnesota,True\n",
							"    975C4751-E25F-4268-AB1B-8802640ACE08,RefState,ceds.ed.gov,MO,290,Missouri,True\n",
							"    975F8937-3322-4ED9-8C58-D0B3BF3C7791,RefState,ceds.ed.gov,MP,300,Northern Marianas,True\n",
							"    D3C60549-CF5A-4763-9144-7FC62036954A,RefState,ceds.ed.gov,MS,310,Mississippi,True\n",
							"    773E67E2-B0BB-4756-BD7B-9483B2F40FEE,RefState,ceds.ed.gov,MT,320,Montana,True\n",
							"    D58CA3A6-6C82-4661-95DF-01ACE1075C96,RefState,ceds.ed.gov,NC,330,North Carolina,True\n",
							"    64444C9E-FBD7-419A-B0A7-58746793AC6E,RefState,ceds.ed.gov,ND,340,North Dakota,True\n",
							"    98934449-5343-46B9-898C-43E1E7C19032,RefState,ceds.ed.gov,NE,350,Nebraska,True\n",
							"    05339530-6CD1-43D0-8674-F7873C567D1A,RefState,ceds.ed.gov,NH,360,New Hampshire,True\n",
							"    A3B84025-5BA8-4229-8A11-0C518C1F4286,RefState,ceds.ed.gov,NJ,370,New Jersey,True\n",
							"    FC843EF9-169A-4D5E-90BB-5F19CB919638,RefState,ceds.ed.gov,NM,380,New Mexico,True\n",
							"    80555E2E-3A9F-4602-A90B-BF440C1ACCD4,RefState,ceds.ed.gov,NV,390,Nevada,True\n",
							"    E2ACE706-5524-413E-8164-6D74C4FDB2EC,RefState,ceds.ed.gov,NY,400,New York,True\n",
							"    7ECFD541-1962-4D01-BB86-5DD85766DD1D,RefState,ceds.ed.gov,OH,410,Ohio,True\n",
							"    3B66E105-18F3-4067-ACD7-6A055FB162C7,RefState,ceds.ed.gov,OK,420,Oklahoma,True\n",
							"    687A5C51-5F34-40E6-B329-1ADAEC370CD7,RefState,ceds.ed.gov,OR,430,Oregon,True\n",
							"    DE4620E9-7C57-4065-8DBD-9F767DDD7B88,RefState,ceds.ed.gov,PA,440,Pennsylvania,True\n",
							"    91FBFF8C-B029-45C2-82FE-BFF8C87FDCA8,RefState,ceds.ed.gov,PR,450,Puerto Rico,True\n",
							"    67A9EB33-C9E3-413E-B3D0-B00F26007A8E,RefState,ceds.ed.gov,PW,460,Palau,True\n",
							"    27B5FF55-80B3-4048-BACC-CA9A3C9DD3C4,RefState,ceds.ed.gov,RI,470,Rhode Island,True\n",
							"    26A7361D-2B27-4DE9-BCF7-AD03DBDEAA52,RefState,ceds.ed.gov,SC,480,South Carolina,True\n",
							"    21F4366B-9C35-4923-A3F7-45A4559DED6D,RefState,ceds.ed.gov,SD,490,South Dakota,True\n",
							"    DDD79C61-65F2-44AF-97C0-ED6E3B2AB65A,RefState,ceds.ed.gov,TN,500,Tennessee,True\n",
							"    06A57A29-DA3B-4A07-A8EB-9FA551405AB0,RefState,ceds.ed.gov,TX,510,Texas,True\n",
							"    4054F216-1E39-4FB8-ACAA-A9C3CC7824FB,RefState,ceds.ed.gov,UT,520,Utah,True\n",
							"    9A64EDAD-4DDE-43D6-A7E3-3E5A457787C5,RefState,ceds.ed.gov,VA,530,Virginia,True\n",
							"    6EA96E1A-8F15-4B2B-A6E3-93981E62C889,RefState,ceds.ed.gov,VI,540,Virgin Islands,True\n",
							"    98935CC0-B2E6-4120-A4CE-7B3CA18EB32D,RefState,ceds.ed.gov,VT,550,Vermont,True\n",
							"    2C1F84CE-FF58-492A-87EC-12B37A360DAD,RefState,ceds.ed.gov,WA,560,Washington,True\n",
							"    D1C6EEF1-B2A6-46CF-89A6-47E8BA2F969F,RefState,ceds.ed.gov,WI,570,Wisconsin,True\n",
							"    FA5DC2DC-DF72-4052-BE05-BC540196A154,RefState,ceds.ed.gov,WV,580,West Virginia,True\n",
							"    426A37AD-A542-4C9D-91C0-26F3D2D4AF42,RefState,ceds.ed.gov,WY,590,Wyoming,True\n",
							"    36BCBFE1-7EFA-420E-8FDC-9FED29376B16,RefState,ceds.ed.gov,AA,600,Armed Forces America,True\n",
							"    0C9210A8-8728-45C9-BE0C-3E93996BAD3F,RefState,ceds.ed.gov,AE,610,\"Armed Forces Africa, Canada, Europe, and Mideast\",True\n",
							"    1B1D8C7A-7DA4-4DEB-B6FB-D75951B0C4B7,RefState,ceds.ed.gov,AP,620,Armed Forces Pacific,True\n",
							"    D27CC7C7-B509-4C5D-A19E-296DEB840B0D,RefCountry,ceds.ed.gov,AF,10,AFGHANISTAN,True\n",
							"    C4248C85-E6A3-4003-946F-4F8A1465823C,RefCountry,ceds.ed.gov,AX,20,LAND ISLANDS,True\n",
							"    BAF71D44-906B-4725-9525-095861DB192C,RefCountry,ceds.ed.gov,AL,30,ALBANIA,True\n",
							"    6ED4915A-5F71-471A-B45B-09DB8C9BD6FA,RefCountry,ceds.ed.gov,DZ,40,ALGERIA,True\n",
							"    FBCB6596-3A6A-4AFB-AB7F-AFCB85C48674,RefCountry,ceds.ed.gov,AS,50,AMERICAN SAMOA,True\n",
							"    B875C46B-C971-4C34-B688-4D2CFB4D8901,RefCountry,ceds.ed.gov,AD,60,ANDORRA,True\n",
							"    D58E52A1-669A-4D3D-B3F2-BFB487083E99,RefCountry,ceds.ed.gov,AO,70,ANGOLA,True\n",
							"    6D5F15DA-1BCE-43F6-976E-AA4A9760CF26,RefCountry,ceds.ed.gov,AI,80,ANGUILLA,True\n",
							"    D8516776-672C-4806-BEA2-57C9C932D0B4,RefCountry,ceds.ed.gov,AQ,90,ANTARCTICA,True\n",
							"    1AF6BB03-DDBF-4A06-BB0B-7E2DD435EF00,RefCountry,ceds.ed.gov,AG,100,ANTIGUA AND BARBUDA,True\n",
							"    3E489A05-9414-4905-876A-48E6B087DD7C,RefCountry,ceds.ed.gov,AR,110,ARGENTINA,True\n",
							"    C95C52A4-06DD-481D-8067-E420C45AF05B,RefCountry,ceds.ed.gov,AM,120,ARMENIA,True\n",
							"    218A0515-0DF9-4A79-8A5C-7235CEA3D133,RefCountry,ceds.ed.gov,AW,130,ARUBA,True\n",
							"    4D36A8CE-7236-42A9-ADB3-2CAC9A6E0A8A,RefCountry,ceds.ed.gov,AU,140,AUSTRALIA,True\n",
							"    D5FBCC82-E6B9-4A7B-9C81-BE91C3BF3051,RefCountry,ceds.ed.gov,AT,150,AUSTRIA,True\n",
							"    86454B57-D0DC-4B5F-990B-35A073B725D7,RefCountry,ceds.ed.gov,AZ,160,AZERBAIJAN,True\n",
							"    C71E4CF0-43D1-4C5B-9B3B-5BAE9768B659,RefCountry,ceds.ed.gov,BS,170,BAHAMAS,True\n",
							"    431FD1D5-0C81-4519-871B-462125EB423F,RefCountry,ceds.ed.gov,BH,180,BAHRAIN,True\n",
							"    610B665A-62D2-4043-BD42-ABB357D215F1,RefCountry,ceds.ed.gov,BD,190,BANGLADESH,True\n",
							"    F7FD3C44-EF3A-4DCD-9FF8-BF1A6F511F15,RefCountry,ceds.ed.gov,BB,200,BARBADOS,True\n",
							"    35606A50-C1B3-467F-BEBA-F9090248EC13,RefCountry,ceds.ed.gov,BY,210,BELARUS,True\n",
							"    6B7A07BF-4F9C-4989-9EBD-113E314D94A9,RefCountry,ceds.ed.gov,BE,220,BELGIUM,True\n",
							"    053D2AEC-28D7-4657-B6F9-2618ECB66435,RefCountry,ceds.ed.gov,BZ,230,BELIZE,True\n",
							"    9DEC5368-A1CA-43A4-A811-79636D63C4CD,RefCountry,ceds.ed.gov,BJ,240,BENIN,True\n",
							"    0C40619F-73BE-482A-B0FC-94C65B65E5EE,RefCountry,ceds.ed.gov,BM,250,BERMUDA,True\n",
							"    AC73ED1A-8EBB-4FDC-9446-26313A9FCFDC,RefCountry,ceds.ed.gov,BT,260,BHUTAN,True\n",
							"    CFBE2FDB-0DB5-4C0E-8D3B-082E13FC0769,RefCountry,ceds.ed.gov,BO,270,BOLIVIA (PLURINATIONAL STATE OF),True\n",
							"    E9464C45-7AF9-4F70-B1C8-2799519C9AC4,RefCountry,ceds.ed.gov,BQ,280,\"BONAIRE, SINT EUSTATIUS AND SABA\",True\n",
							"    66AFEF2A-AAAC-403D-986A-D30131D0800B,RefCountry,ceds.ed.gov,BA,290,BOSNIA AND HERZEGOVINA,True\n",
							"    BF83057A-817C-46DD-9D96-B880D4A43632,RefCountry,ceds.ed.gov,BW,300,BOTSWANA,True\n",
							"    19BA7D54-5564-4089-900B-E4A876F501ED,RefCountry,ceds.ed.gov,BV,310,BOUVET ISLAND,True\n",
							"    E67825BB-F50A-4113-A0C9-E491254B761D,RefCountry,ceds.ed.gov,BR,320,BRAZIL,True\n",
							"    35D3248A-7192-439A-A124-A47EE8C5E22A,RefCountry,ceds.ed.gov,IO,330,BRITISH INDIAN OCEAN TERRITORY,True\n",
							"    5526EDE2-3618-4A09-9C85-6989FBDB0EB9,RefCountry,ceds.ed.gov,BN,340,BRUNEI DARUSSALAM,True\n",
							"    F835BE43-A886-4B6F-8FBB-FAE8037DA7FE,RefCountry,ceds.ed.gov,BG,350,BULGARIA,True\n",
							"    F4619148-DE08-431B-9F20-0AFCB4B0F381,RefCountry,ceds.ed.gov,BF,360,BURKINA FASO,True\n",
							"    41DAA537-F493-4613-A939-3854BBF6633C,RefCountry,ceds.ed.gov,BI,370,BURUNDI,True\n",
							"    FA8DA2A4-1B94-4768-A0CD-087FE2C3A57C,RefCountry,ceds.ed.gov,KH,380,CAMBODIA,True\n",
							"    D10579AF-BB48-4EFF-A28F-A08E67A8F38A,RefCountry,ceds.ed.gov,CM,390,CAMEROON,True\n",
							"    9FDB4302-095B-4CB8-BB21-38E92391CCE7,RefCountry,ceds.ed.gov,CA,400,CANADA,True\n",
							"    F00048DE-EAE4-4401-A346-3048E028F919,RefCountry,ceds.ed.gov,CV,410,CABO VERDE,True\n",
							"    C493E32C-145B-468F-BFBC-178D3617FE1F,RefCountry,ceds.ed.gov,KY,420,CAYMAN ISLANDS,True\n",
							"    943FF087-293A-48FC-B7E6-24A3CACA52AC,RefCountry,ceds.ed.gov,CF,430,CENTRAL AFRICAN REPUBLIC,True\n",
							"    FDEB4792-0633-41CA-AB8B-8B316DB92630,RefCountry,ceds.ed.gov,TD,440,CHAD,True\n",
							"    1C97B8BE-2418-4B72-925B-21486B9CAFEF,RefCountry,ceds.ed.gov,CL,450,CHILE,True\n",
							"    770CB099-B1FB-4E4B-B7EB-89DD0BAA15B6,RefCountry,ceds.ed.gov,CN,460,CHINA,True\n",
							"    22C29EDF-B3F5-4E84-98BF-68B0B73806C6,RefCountry,ceds.ed.gov,CX,470,CHRISTMAS ISLAND,True\n",
							"    7B7BC7C3-3B56-4F4A-B5DD-49583FBD798A,RefCountry,ceds.ed.gov,CC,480,COCOS (KEELING) ISLANDS,True\n",
							"    30EA0E0A-06C2-456E-9062-B1527AF18514,RefCountry,ceds.ed.gov,CO,490,COLOMBIA,True\n",
							"    8120B8A8-A113-44FD-8AE7-C0BFC05E3EAB,RefCountry,ceds.ed.gov,KM,500,COMOROS,True\n",
							"    1F4F8956-5A23-4185-A244-5DDAF2C4A8D5,RefCountry,ceds.ed.gov,CG,510,CONGO,True\n",
							"    D81156CD-C2DF-4BF4-B5E0-91A7D495D1F2,RefCountry,ceds.ed.gov,CD,520,\"CONGO, DEMOCRATIC REPUBLIC OF THE\",True\n",
							"    EA6D2CD0-4457-4752-AC10-2AD8C2192DFD,RefCountry,ceds.ed.gov,CK,530,COOK ISLANDS,True\n",
							"    1EE80E7F-CE07-4192-BC71-92CCE5DF5B87,RefCountry,ceds.ed.gov,CR,540,COSTA RICA,True\n",
							"    7D626101-21A0-48FB-A209-374636012EFA,RefCountry,ceds.ed.gov,CI,550,CTE D'IVOIRE,True\n",
							"    2976CDB1-2EBE-4FED-A988-5EA8166DA16D,RefCountry,ceds.ed.gov,HR,560,CROATIA,True\n",
							"    31B0ED95-2375-4E9D-8BA6-09F36FE4B303,RefCountry,ceds.ed.gov,CU,570,CUBA,True\n",
							"    3444FFC6-75DC-4BFD-A65F-C981B09A4E5D,RefCountry,ceds.ed.gov,CW,580,CURAAO,True\n",
							"    7303FDD1-C6C0-4328-8487-DB1E31922014,RefCountry,ceds.ed.gov,CY,590,CYPRUS,True\n",
							"    58D2376A-3B7E-4325-B238-080724BF7371,RefCountry,ceds.ed.gov,CZ,600,CZECH REPUBLIC,True\n",
							"    0279764E-EB81-4FC2-A027-AA18205E624E,RefCountry,ceds.ed.gov,DK,610,DENMARK,True\n",
							"    0D2664E5-F193-448F-8379-71A4B7B35751,RefCountry,ceds.ed.gov,DJ,620,DJIBOUTI,True\n",
							"    122C7D71-0875-45E6-BF67-592327F0EA3E,RefCountry,ceds.ed.gov,DM,630,DOMINICA,True\n",
							"    275978E1-6AEC-40D1-B9EF-5FD7109F249F,RefCountry,ceds.ed.gov,DO,640,DOMINICAN REPUBLIC,True\n",
							"    679BBA36-AE9E-4790-B6FA-8C4BF1DE1691,RefCountry,ceds.ed.gov,EC,650,ECUADOR,True\n",
							"    55B12FE3-A9DD-4487-8BD9-F1F5AA8BE5BD,RefCountry,ceds.ed.gov,EG,660,EGYPT,True\n",
							"    76B0ECDC-2393-41D8-83D2-5543017B43EA,RefCountry,ceds.ed.gov,SV,670,EL SALVADOR,True\n",
							"    1F5F7272-EE24-4BFB-9021-65DCDD641B47,RefCountry,ceds.ed.gov,GQ,680,EQUATORIAL GUINEA,True\n",
							"    39963E26-F3A7-4197-B258-8B5E031DBC91,RefCountry,ceds.ed.gov,ER,690,ERITREA,True\n",
							"    A42681D9-4185-4D8E-8F47-165D9D60DF2D,RefCountry,ceds.ed.gov,EE,700,ESTONIA,True\n",
							"    45963F45-7BAF-4D51-99F4-C71EAF3DD152,RefCountry,ceds.ed.gov,ET,710,ETHIOPIA,True\n",
							"    6CF21A67-DDD5-447F-9154-B4BDB8C886E9,RefCountry,ceds.ed.gov,FK,720,FALKLAND ISLANDS (MALVINAS),True\n",
							"    2E42F906-C8AA-432D-8EC6-AA4F07B3A98F,RefCountry,ceds.ed.gov,FO,730,FAROE ISLANDS,True\n",
							"    6F9646D1-CAE1-47BC-8E41-C82743997ACF,RefCountry,ceds.ed.gov,FJ,740,FIJI,True\n",
							"    428DE3F9-D201-4BD4-98CA-F0F92B127C0D,RefCountry,ceds.ed.gov,FI,750,FINLAND,True\n",
							"    281C8F83-1AB0-4678-B3AC-1E6DA98A1B8D,RefCountry,ceds.ed.gov,FR,760,FRANCE,True\n",
							"    6F8A17F4-006C-4DF0-95BE-2344577B4C87,RefCountry,ceds.ed.gov,GF,770,FRENCH GUIANA,True\n",
							"    0CAC2EF1-59E6-4390-9371-9EC5F400D3CA,RefCountry,ceds.ed.gov,PF,780,FRENCH POLYNESIA,True\n",
							"    2CD7DC70-F061-4845-B626-24E8C4076FE5,RefCountry,ceds.ed.gov,TF,790,FRENCH SOUTHERN TERRITORIES,True\n",
							"    105F3434-B6ED-457B-B395-B0BA7ED2EBD0,RefCountry,ceds.ed.gov,GA,800,GABON,True\n",
							"    3E0BA96F-0121-4C51-ADC4-5B0B840C720F,RefCountry,ceds.ed.gov,GM,810,GAMBIA,True\n",
							"    9E8290AE-90C6-4D4A-8F6A-B7C5B2BED017,RefCountry,ceds.ed.gov,GE,820,GEORGIA,True\n",
							"    8E28378A-05A3-4EEB-A9ED-C3B1695BBC00,RefCountry,ceds.ed.gov,DE,830,GERMANY,True\n",
							"    73C7F8FB-CC15-4ED7-9D4C-0B9B5054DABC,RefCountry,ceds.ed.gov,GH,840,GHANA,True\n",
							"    4A91F599-1CEB-47DA-9655-239F7414BF49,RefCountry,ceds.ed.gov,GI,850,GIBRALTAR,True\n",
							"    549ED6FA-054D-4E88-94A8-9A8CCD6A3A93,RefCountry,ceds.ed.gov,GR,860,GREECE,True\n",
							"    4AD8D4C1-2AA5-4F4B-85BF-0FBB2E0463BB,RefCountry,ceds.ed.gov,GL,870,GREENLAND,True\n",
							"    3AF9FCF6-15D7-451B-9355-702CB458AD29,RefCountry,ceds.ed.gov,GD,880,GRENADA,True\n",
							"    FD1FE91D-640F-4029-A2A7-1C85E939E37C,RefCountry,ceds.ed.gov,GP,890,GUADELOUPE,True\n",
							"    1FE1E74B-E294-4ADD-BF3A-5B4598C7C2CC,RefCountry,ceds.ed.gov,GU,900,GUAM,True\n",
							"    37F47BB7-4866-4052-8531-F70C6CC05509,RefCountry,ceds.ed.gov,GT,910,GUATEMALA,True\n",
							"    31737278-DDE3-4D14-B5BB-71ED800FD70D,RefCountry,ceds.ed.gov,GG,920,GUERNSEY,True\n",
							"    596BE35E-82B8-4350-B18A-76BAF253518D,RefCountry,ceds.ed.gov,GN,930,GUINEA,True\n",
							"    0A18754D-613A-4B3A-AB0E-CE0147035400,RefCountry,ceds.ed.gov,GW,940,GUINEA-BISSAU,True\n",
							"    894E840B-6BF1-4714-B1C1-5F86F1465E09,RefCountry,ceds.ed.gov,GY,950,GUYANA,True\n",
							"    C3AB650B-E895-4B45-956F-D4A21DE16762,RefCountry,ceds.ed.gov,HT,960,HAITI,True\n",
							"    A9063AF1-0FA1-40C5-BF1B-3C5025C1E226,RefCountry,ceds.ed.gov,HM,970,HEARD ISLAND AND MCDONALD ISLANDS,True\n",
							"    5382AB70-5BC5-4EE5-AC89-74222EB063E9,RefCountry,ceds.ed.gov,VA,980,HOLY SEE,True\n",
							"    501E2372-EAAC-4DAA-B5F8-498BB79B5D06,RefCountry,ceds.ed.gov,HN,990,HONDURAS,True\n",
							"    4566DA89-2577-421F-A7D4-BE159101CA25,RefCountry,ceds.ed.gov,HK,1000,HONG KONG,True\n",
							"    17F05B32-C93E-4B65-B97B-47739D7BE2B6,RefCountry,ceds.ed.gov,HU,1010,HUNGARY,True\n",
							"    0B407879-7D92-47F0-AD86-655E40283F93,RefCountry,ceds.ed.gov,IS,1020,ICELAND,True\n",
							"    922A1996-C5E6-4A8E-A2B4-CA61DD3F12BC,RefCountry,ceds.ed.gov,IN,1030,INDIA,True\n",
							"    509756FB-94BF-431D-B96E-9EC18A27298C,RefCountry,ceds.ed.gov,ID,1040,INDONESIA,True\n",
							"    85056B48-EB0B-4CA9-8015-116311F92A53,RefCountry,ceds.ed.gov,IR,1050,IRAN (ISLAMIC REPUBLIC OF),True\n",
							"    E47C2972-2934-48B8-A26E-A078AF162E45,RefCountry,ceds.ed.gov,IQ,1060,IRAQ,True\n",
							"    F7F3EC17-D221-4AD4-AEE4-1155F0487A69,RefCountry,ceds.ed.gov,IE,1070,IRELAND,True\n",
							"    73DF0854-8482-4AC8-81AA-AD5B6C4CF02D,RefCountry,ceds.ed.gov,IM,1080,ISLE OF MAN,True\n",
							"    F9F71EBE-27D8-4CF1-945E-65A1CD978236,RefCountry,ceds.ed.gov,IL,1090,ISRAEL,True\n",
							"    B653EDC2-B645-4BA6-889E-6F20DE6B6001,RefCountry,ceds.ed.gov,IT,1100,ITALY,True\n",
							"    751AC8A6-FF95-403B-9CC2-2894B726B76A,RefCountry,ceds.ed.gov,JM,1110,JAMAICA,True\n",
							"    A0A473A1-E41E-4C2B-A600-16607A1FB7FE,RefCountry,ceds.ed.gov,JP,1120,JAPAN,True\n",
							"    04788D74-1C8D-40DD-B2CD-CDE1D73FED54,RefCountry,ceds.ed.gov,JE,1130,JERSEY,True\n",
							"    5BA9655E-CC02-4E69-B586-1072DF66757B,RefCountry,ceds.ed.gov,JO,1140,JORDAN,True\n",
							"    3F5F2153-0E28-48C9-8D6D-805867AC67AB,RefCountry,ceds.ed.gov,KZ,1150,KAZAKHSTAN,True\n",
							"    479CE3D3-5DD5-4480-A1EB-A830439D329F,RefCountry,ceds.ed.gov,KE,1160,KENYA,True\n",
							"    327A46E4-9608-43D5-99A4-6841865FB4DB,RefCountry,ceds.ed.gov,KI,1170,KIRIBATI,True\n",
							"    75E9610E-0B9E-4340-B66F-8E405ED76662,RefCountry,ceds.ed.gov,KP,1180,KOREA (DEMOCRATIC PEOPLE'S REPUBLIC OF),True\n",
							"    AD688E73-BC4A-4417-9B7F-387BB0B665AA,RefCountry,ceds.ed.gov,KR,1190,\"KOREA, REPUBLIC OF\",True\n",
							"    F3B92EB3-4413-4E40-8748-742814C488FB,RefCountry,ceds.ed.gov,KW,1200,KUWAIT,True\n",
							"    167F86C4-8C7B-4299-A1A6-C8AF9AB67DBE,RefCountry,ceds.ed.gov,KG,1210,KYRGYZSTAN,True\n",
							"    D4844D61-AC72-4D42-B977-AC91738BBD4B,RefCountry,ceds.ed.gov,LA,1220,LAO PEOPLE'S DEMOCRATIC REPUBLIC,True\n",
							"    D399E902-AF94-4531-A52C-D956D0B7C55C,RefCountry,ceds.ed.gov,LV,1230,LATVIA,True\n",
							"    0724E62D-DF7D-43DE-B88D-C6D7790603A0,RefCountry,ceds.ed.gov,LB,1240,LEBANON,True\n",
							"    30C1236C-2A1B-40E5-8E47-9C5CB1BEB8D3,RefCountry,ceds.ed.gov,LS,1250,LESOTHO,True\n",
							"    22E384DE-DCE8-43A9-9373-7EA91F1D729A,RefCountry,ceds.ed.gov,LR,1260,LIBERIA,True\n",
							"    7C70F8B1-1D8A-48CA-BA4E-888276B155D5,RefCountry,ceds.ed.gov,LY,1270,LIBYA,True\n",
							"    30521C6A-BA6B-4B8B-A0D3-C1D1F0F38EDF,RefCountry,ceds.ed.gov,LI,1280,LIECHTENSTEIN,True\n",
							"    0B9965B2-6D41-4AA4-A860-96B4D6AE2BC5,RefCountry,ceds.ed.gov,LT,1290,LITHUANIA,True\n",
							"    795B7E23-49FA-4851-9228-5816BDC3C3A0,RefCountry,ceds.ed.gov,LU,1300,LUXEMBOURG,True\n",
							"    1F000974-CD71-4789-B5C8-7DEDE2BF4354,RefCountry,ceds.ed.gov,MO,1310,MACAO,True\n",
							"    7E2F4872-EC4A-4922-BE59-7E8E510319C3,RefCountry,ceds.ed.gov,MK,1320,\"MACEDONIA, THE FORMER YUGOSLAV REPUBLIC OF\",True\n",
							"    CB6825D4-A079-41DC-9511-D30AB3D9D8A0,RefCountry,ceds.ed.gov,MG,1330,MADAGASCAR,True\n",
							"    DAB841AE-A8D0-4B53-81C7-71CAA144BB79,RefCountry,ceds.ed.gov,MW,1340,MALAWI,True\n",
							"    55CD15C5-0B88-4B3F-88EA-2378A055B0E6,RefCountry,ceds.ed.gov,MY,1350,MALAYSIA,True\n",
							"    5DF7FD05-9BAB-4271-8AB4-A101656B99B7,RefCountry,ceds.ed.gov,MV,1360,MALDIVES,True\n",
							"    F38D0885-53A7-42C6-8923-1945E6BB924A,RefCountry,ceds.ed.gov,ML,1370,MALI,True\n",
							"    C96DFCAD-A2E6-4CCE-AC7D-BAAAEE4E2A5E,RefCountry,ceds.ed.gov,MT,1380,MALTA,True\n",
							"    47BBD0B0-FF49-4E7B-8022-5497DF5BA5C2,RefCountry,ceds.ed.gov,MH,1390,MARSHALL ISLANDS,True\n",
							"    B906FFA3-4C09-44D8-90B5-227D3B90CFD0,RefCountry,ceds.ed.gov,MQ,1400,MARTINIQUE,True\n",
							"    59EDC14B-E7F5-46C2-9F5C-F9569B5348A2,RefCountry,ceds.ed.gov,MR,1410,MAURITANIA,True\n",
							"    7E628BC1-2BB6-48C6-A210-4FD9677FAB9B,RefCountry,ceds.ed.gov,MU,1420,MAURITIUS,True\n",
							"    1AF13DD5-50E8-45AF-AAE4-4E45AA7CDA0E,RefCountry,ceds.ed.gov,YT,1430,MAYOTTE,True\n",
							"    86111F48-2681-44B5-BEC7-1B46F834C567,RefCountry,ceds.ed.gov,MX,1440,MEXICO,True\n",
							"    453FA007-D61C-4D1B-B6DC-CFD74313698C,RefCountry,ceds.ed.gov,FM,1450,MICRONESIA (FEDERATED STATES OF),True\n",
							"    01FDAC40-AF6F-477D-890D-8500DCC4432E,RefCountry,ceds.ed.gov,MD,1460,\"MOLDOVA, REPUBLIC OF\",True\n",
							"    0061C812-8A47-49DA-AE14-074386532A8F,RefCountry,ceds.ed.gov,MC,1470,MONACO,True\n",
							"    466CD301-592F-4480-9153-ECA53DC2DA2B,RefCountry,ceds.ed.gov,MN,1480,MONGOLIA,True\n",
							"    410F008B-CDA4-4609-A8AC-91DBF38EAE34,RefCountry,ceds.ed.gov,ME,1490,MONTENEGRO,True\n",
							"    B2411F7B-7BD3-4A93-9321-80661F7732E1,RefCountry,ceds.ed.gov,MS,1500,MONTSERRAT,True\n",
							"    E65079E9-6064-43F5-A9F3-797CB5DE8A0E,RefCountry,ceds.ed.gov,MA,1510,MOROCCO,True\n",
							"    89C048D5-9BD1-47A5-BDAA-9B4E58B22C48,RefCountry,ceds.ed.gov,MZ,1520,MOZAMBIQUE,True\n",
							"    5A666073-4114-4C83-9614-A28161BE68FC,RefCountry,ceds.ed.gov,MM,1530,MYANMAR,True\n",
							"    C262EBC2-14AC-4C7E-8333-4908FDA99F7A,RefCountry,ceds.ed.gov,NA,1540,NAMIBIA,True\n",
							"    1C352B2F-F6F0-401A-82A6-837187B393BB,RefCountry,ceds.ed.gov,NR,1550,NAURU,True\n",
							"    FD689F22-09BB-4A3C-AD17-055BF3B3B16C,RefCountry,ceds.ed.gov,NP,1560,NEPAL,True\n",
							"    8F9679A5-1B7A-4C35-9297-FCD4AF94CB12,RefCountry,ceds.ed.gov,NL,1570,NETHERLANDS,True\n",
							"    EE4E2F96-15AC-44FA-AA43-7ED8903A467D,RefCountry,ceds.ed.gov,NC,1580,NEW CALEDONIA,True\n",
							"    A016256C-E7F3-4B9F-9897-0AC80CED7A8D,RefCountry,ceds.ed.gov,NZ,1590,NEW ZEALAND,True\n",
							"    14C3C6C1-65E7-46AA-AA0D-A46428C6A7A4,RefCountry,ceds.ed.gov,NI,1600,NICARAGUA,True\n",
							"    0706A939-1EF8-45C9-AE0F-6C4E16442B3A,RefCountry,ceds.ed.gov,NE,1610,NIGER,True\n",
							"    AA8D132E-F753-4699-AC6B-5975AB620C81,RefCountry,ceds.ed.gov,NG,1620,NIGERIA,True\n",
							"    400A1956-D7C2-4207-BD4B-24DDAA4BEF74,RefCountry,ceds.ed.gov,NU,1630,NIUE,True\n",
							"    E388E2DB-9EAF-4B9E-AB8E-64CD118BB19F,RefCountry,ceds.ed.gov,NF,1640,NORFOLK ISLAND,True\n",
							"    529DCFA0-3191-49D7-9C5A-430BBC7C72F1,RefCountry,ceds.ed.gov,MP,1650,NORTHERN MARIANA ISLANDS,True\n",
							"    F6BB8EBD-13FC-492E-8C2F-12DEB51F4BC7,RefCountry,ceds.ed.gov,NO,1660,NORWAY,True\n",
							"    4C19193D-BC67-4FCB-94D0-1D7E05C6D5BC,RefCountry,ceds.ed.gov,OM,1670,OMAN,True\n",
							"    51E5415D-8663-40A0-92C7-85A4C90D726F,RefCountry,ceds.ed.gov,PK,1680,PAKISTAN,True\n",
							"    7C9C9603-04D3-4076-969D-B0FF10DE00CA,RefCountry,ceds.ed.gov,PW,1690,PALAU,True\n",
							"    4C5D8A77-B85E-4920-AB76-8F60D113BF81,RefCountry,ceds.ed.gov,PS,1700,\"PALESTINE, STATE OF\",True\n",
							"    EF403E92-BF0A-499C-8BFC-F2AF26EEE0C8,RefCountry,ceds.ed.gov,PA,1710,PANAMA,True\n",
							"    80BD56AF-3441-4A36-9E0A-275DE4CDFA43,RefCountry,ceds.ed.gov,PG,1720,PAPUA NEW GUINEA,True\n",
							"    41E21101-03D8-4549-A6AC-499136490091,RefCountry,ceds.ed.gov,PY,1730,PARAGUAY,True\n",
							"    51F14894-83C8-421B-B248-98567587BC9F,RefCountry,ceds.ed.gov,PE,1740,PERU,True\n",
							"    B59CD07B-E6C0-4A64-8965-27DDF675E8B9,RefCountry,ceds.ed.gov,PH,1750,PHILIPPINES,True\n",
							"    5C3F2B8C-D4D5-4CD7-84D6-E4596E1DD3B8,RefCountry,ceds.ed.gov,PN,1760,PITCAIRN,True\n",
							"    F52D0D10-06DD-4937-80B1-0331A1C211CB,RefCountry,ceds.ed.gov,PL,1770,POLAND,True\n",
							"    D7B2F40F-74F6-40C1-A02C-C9920B198526,RefCountry,ceds.ed.gov,PT,1780,PORTUGAL,True\n",
							"    1EC79991-D73C-4B3F-9CC4-537DC68FC48F,RefCountry,ceds.ed.gov,PR,1790,PUERTO RICO,True\n",
							"    46D0B925-44FB-46BD-9488-717888777756,RefCountry,ceds.ed.gov,QA,1800,QATAR,True\n",
							"    6827FD44-246C-4F53-9320-17946A6B4017,RefCountry,ceds.ed.gov,RE,1810,RUNION,True\n",
							"    C5101A5B-B94E-4E45-9291-AC5BF329CCB2,RefCountry,ceds.ed.gov,RO,1820,ROMANIA,True\n",
							"    4F9A48C8-A04D-4F5D-9100-E7FD403BBE46,RefCountry,ceds.ed.gov,RU,1830,RUSSIAN FEDERATION,True\n",
							"    5DB1879F-AE04-40FE-B3F2-13285D78216D,RefCountry,ceds.ed.gov,RW,1840,RWANDA,True\n",
							"    F8124018-FD02-4763-A8B0-57D04084E94D,RefCountry,ceds.ed.gov,BL,1850,SAINT BARTHLEMY,True\n",
							"    AA552BEE-7833-4A9C-AFE9-8DF0D4996950,RefCountry,ceds.ed.gov,SH,1860,\"SAINT HELENA, ASCENSION AND TRISTAN DA CUNHA\",True\n",
							"    7E325754-D43B-4431-A17B-1F39BCBC6FCB,RefCountry,ceds.ed.gov,KN,1870,SAINT KITTS AND NEVIS,True\n",
							"    993ED9DD-8902-413E-87F7-0A7F89AEB681,RefCountry,ceds.ed.gov,LC,1880,SAINT LUCIA,True\n",
							"    4B927548-A011-4EA4-A807-E9C7CA9B8182,RefCountry,ceds.ed.gov,MF,1890,SAINT MARTIN (FRENCH PART),True\n",
							"    9213514F-EF2F-41F1-819F-B5B9AA389DD8,RefCountry,ceds.ed.gov,PM,1900,SAINT PIERRE AND MIQUELON,True\n",
							"    A76FAAD0-97CC-4C01-A33B-17A84963DF17,RefCountry,ceds.ed.gov,VC,1910,SAINT VINCENT AND THE GRENADINES,True\n",
							"    02BF9BB8-2B0B-48DF-A44A-3F55C5E660CA,RefCountry,ceds.ed.gov,WS,1920,SAMOA,True\n",
							"    B777595B-0E66-4597-81D0-2FA3524B3DAF,RefCountry,ceds.ed.gov,SM,1930,SAN MARINO,True\n",
							"    AEEEBA86-00EB-4C50-91DC-0FD8BF63296C,RefCountry,ceds.ed.gov,ST,1940,SAO TOME AND PRINCIPE,True\n",
							"    ABEEF49C-2E93-458A-84F1-2D5C77424539,RefCountry,ceds.ed.gov,SA,1950,SAUDI ARABIA,True\n",
							"    94AD69A4-B71F-4FA9-91AE-F12BE09C81DE,RefCountry,ceds.ed.gov,SN,1960,SENEGAL,True\n",
							"    BCA16B75-BF2E-497D-824C-9EA569BD08DA,RefCountry,ceds.ed.gov,RS,1970,SERBIA,True\n",
							"    5FA3CF72-FFA4-40CE-8C4D-52793DBCBE64,RefCountry,ceds.ed.gov,SC,1980,SEYCHELLES,True\n",
							"    0E5B7268-6612-4092-B075-7CE554F6AA8B,RefCountry,ceds.ed.gov,SL,1990,SIERRA LEONE,True\n",
							"    0A490B99-2619-4F6A-AE5B-7F55869E569B,RefCountry,ceds.ed.gov,SG,2000,SINGAPORE,True\n",
							"    9585295D-9F85-4A5D-804F-8A78212EFA7E,RefCountry,ceds.ed.gov,SX,2010,SINT MAARTEN (DUTCH PART),True\n",
							"    C02772F6-4C93-4ADA-B30A-758A90AE7A2C,RefCountry,ceds.ed.gov,SK,2020,SLOVAKIA,True\n",
							"    1D56E8EE-74CC-49D6-8174-9670E6356024,RefCountry,ceds.ed.gov,SI,2030,SLOVENIA,True\n",
							"    A6425AC0-72D3-4008-8BBB-BEDC03F20AAA,RefCountry,ceds.ed.gov,SB,2040,SOLOMON ISLANDS,True\n",
							"    AC26F682-2AC1-4907-B165-CAE046FC2BCA,RefCountry,ceds.ed.gov,SO,2050,SOMALIA,True\n",
							"    A3D38931-C557-4530-902D-C27529532E7C,RefCountry,ceds.ed.gov,ZA,2060,SOUTH AFRICA,True\n",
							"    F0B07ACA-C168-4152-B6AB-2B7EE0162D0E,RefCountry,ceds.ed.gov,GS,2070,SOUTH GEORGIA AND THE SOUTH SANDWICH ISLANDS,True\n",
							"    930FB257-80FD-4410-91BE-0B047A0E9483,RefCountry,ceds.ed.gov,SS,2080,SOUTH SUDAN,True\n",
							"    7C9A8ABA-B6A4-4B31-8CBE-6609D283322D,RefCountry,ceds.ed.gov,ES,2090,SPAIN,True\n",
							"    ED6CE09B-5451-4215-922C-D5F1BD23D2C0,RefCountry,ceds.ed.gov,LK,2100,SRI LANKA,True\n",
							"    E9A6F2AE-7BF4-4DA7-92AA-E8685030B1B5,RefCountry,ceds.ed.gov,SD,2110,SUDAN,True\n",
							"    83D8D9EB-36E3-4081-9D3F-EFCB894B1EF0,RefCountry,ceds.ed.gov,SR,2120,SURINAME,True\n",
							"    0C728176-8046-4390-A579-84E67D67B1E1,RefCountry,ceds.ed.gov,SJ,2130,SVALBARD AND JAN MAYEN,True\n",
							"    FE5D4E7F-7E05-4018-89D1-4A2C3BA268A5,RefCountry,ceds.ed.gov,SZ,2140,SWAZILAND,True\n",
							"    F63636C1-3123-4700-82CE-C4FD7EA9C289,RefCountry,ceds.ed.gov,SE,2150,SWEDEN,True\n",
							"    0B958C09-33BF-47EF-B70E-C42E33FBDDC3,RefCountry,ceds.ed.gov,CH,2160,SWITZERLAND,True\n",
							"    D0E968A9-B41A-4301-B7E2-41FAE7B597A2,RefCountry,ceds.ed.gov,SY,2170,SYRIAN ARAB REPUBLIC,True\n",
							"    2F4865F0-C6E6-4C24-8D63-8095AE34B472,RefCountry,ceds.ed.gov,TW,2180,TAIWAN,True\n",
							"    77867C67-1973-41AD-8824-C08AB2EF346E,RefCountry,ceds.ed.gov,TJ,2190,TAJIKISTAN,True\n",
							"    3E8FFA2A-9A41-4ECF-AFFF-9BD16A555078,RefCountry,ceds.ed.gov,TZ,2200,\"TANZANIA, UNITED REPUBLIC OF\",True\n",
							"    41767821-A02C-4218-9066-D026FFA3213C,RefCountry,ceds.ed.gov,TH,2210,THAILAND,True\n",
							"    240F8689-9BE9-4883-82E5-4212B53DAB5B,RefCountry,ceds.ed.gov,TL,2220,TIMOR-LESTE,True\n",
							"    B67AF7FD-9496-46CD-907A-5040F7A4D56C,RefCountry,ceds.ed.gov,TG,2230,TOGO,True\n",
							"    03A40FA1-D42C-41D4-AC1C-A58A9309DC25,RefCountry,ceds.ed.gov,TK,2240,TOKELAU,True\n",
							"    77C473E4-BC68-4341-8F32-C312DCA7BFE2,RefCountry,ceds.ed.gov,TO,2250,TONGA,True\n",
							"    D07FBFC8-DE57-4D65-B0A3-2AC8CD6F12CA,RefCountry,ceds.ed.gov,TT,2260,TRINIDAD AND TOBAGO,True\n",
							"    6E2BF916-718B-4FBC-AB54-DD4DEE4D91E0,RefCountry,ceds.ed.gov,TN,2270,TUNISIA,True\n",
							"    50D8BE7D-2F24-4E3B-9E29-D75CF7177F19,RefCountry,ceds.ed.gov,TR,2280,TURKEY,True\n",
							"    61AFB333-7B93-471E-A4B0-EE4FEC8588B7,RefCountry,ceds.ed.gov,TM,2290,TURKMENISTAN,True\n",
							"    2BEB099D-61D0-4E8F-AF1F-96C1C781292C,RefCountry,ceds.ed.gov,TC,2300,TURKS AND CAICOS ISLANDS,True\n",
							"    D8DA0877-CCB5-4963-9E26-308BF067320C,RefCountry,ceds.ed.gov,TV,2310,TUVALU,True\n",
							"    BA5C6CDE-7D11-45AF-B30B-76500FA91425,RefCountry,ceds.ed.gov,UG,2320,UGANDA,True\n",
							"    52ECB0E0-22B9-4267-BDDD-998BAB471EC6,RefCountry,ceds.ed.gov,UA,2330,UKRAINE,True\n",
							"    EBF9A8F9-C0CC-4386-B221-25609FB31328,RefCountry,ceds.ed.gov,AE,2340,UNITED ARAB EMIRATES,True\n",
							"    3B3D1E6C-28D7-4189-8C7F-607F0211969B,RefCountry,ceds.ed.gov,GB,2350,UNITED KINGDOM OF GREAT BRITAIN AND NORTHERN IRELAND,True\n",
							"    B27E984F-0441-4833-8724-60E2496A47D7,RefCountry,ceds.ed.gov,US,2360,UNITED STATES OF AMERICA,True\n",
							"    24D20FA9-94ED-43EB-AC99-0A2E3E0E3A73,RefCountry,ceds.ed.gov,UM,2370,UNITED STATES MINOR OUTLYING ISLANDS,True\n",
							"    7EBF4E35-914B-4DB3-9827-08B9A4D3F45B,RefCountry,ceds.ed.gov,UY,2380,URUGUAY,True\n",
							"    9F932DC2-F603-4B5E-8F12-0BDD1E6AB1B8,RefCountry,ceds.ed.gov,UZ,2390,UZBEKISTAN,True\n",
							"    E8FDD235-C19F-4F0F-9300-78E5C22C70F2,RefCountry,ceds.ed.gov,VU,2400,VANUATU,True\n",
							"    F4FCCBA2-DCD9-403A-AF1E-9450EDAA0BDD,RefCountry,ceds.ed.gov,VE,2410,VENEZUELA (BOLIVARIAN REPUBLIC OF),True\n",
							"    F3CE298A-889D-4E33-B23B-0436D79AE5CA,RefCountry,ceds.ed.gov,VN,2420,VIET NAM,True\n",
							"    8F01500D-B796-48A3-B18D-26FB561A0A63,RefCountry,ceds.ed.gov,VG,2430,VIRGIN ISLANDS (BRITISH),True\n",
							"    4783FC4D-9665-4346-8C9D-4DA16D655DFF,RefCountry,ceds.ed.gov,VI,2440,VIRGIN ISLANDS (U.S.),True\n",
							"    C98465F0-6A37-4D23-97FE-845E92F82823,RefCountry,ceds.ed.gov,WF,2450,WALLIS AND FUTUNA,True\n",
							"    5CA05C14-7A46-4CF2-8E66-2A901E95ADE0,RefCountry,ceds.ed.gov,EH,2460,WESTERN SAHARA,True\n",
							"    81539402-144E-46BC-9ED0-FF0C666FDE08,RefCountry,ceds.ed.gov,YE,2470,YEMEN,True\n",
							"    2EB51FA4-1241-4614-87FE-190896B35849,RefCountry,ceds.ed.gov,ZM,2480,ZAMBIA,True\n",
							"    F0F142DC-C1C0-425E-9961-E438DEDBEB57,RefCountry,ceds.ed.gov,ZW,2490,ZIMBABWE,True\n",
							"    F772D02B-3B1E-41A4-941B-77BEBB2AF8B2,RefPersonRelationship,imsglobal.com,parent,10,Parent,True\n",
							"    C9D0304D-A529-409A-9C4E-C008E76EFA6E,RefPersonRelationship,imsglobal.com,relative,20,Relative,True\n",
							"    FE54C353-BFE9-4229-BDF7-F421423739A3,RefPersonRelationship,imsglobal.com,guardian,30,Guardian,True\n",
							"    0D16FCED-6DC7-4235-90BF-724D40ABC7BD,RefStudentOrgRole,imsglobal.org,student,10,Student,True\n",
							"    2BE22270-5236-41BF-B359-167E725F45DA,RefStaffOrgRole,imsglobal.org,aide,10,Aide,True\n",
							"    96DB6F6A-B3C7-4A8C-8885-42AFC7598528,RefStaffOrgRole,imsglobal.org,proctor,20,Proctor,True\n",
							"    03FFC8C5-9C64-4321-8041-334F07A252F0,RefStaffOrgRole,imsglobal.org,teacher,30,Teacher,True\n",
							"    6A43802A-4372-44D3-B3F0-7B9BC24EF9D8,RefStaffOrgRole,imsglobal.org,administrator,40,Administrator,True\n",
							"    DA004FFF-9B71-4926-9D7C-79B83B19F31B,RefStaffOrgRole,microsoft.com,itAdmin,50,IT Admin,True\n",
							"    05DE1E52-6991-4F77-BBC6-620A7171E1A6,RefStaffOrgRole,microsoft.com,officeStaff,60,Office Staff,True\n",
							"    57AA30CB-DAD3-4D73-B568-DFD0B431BD83,RefStaffOrgRole,microsoft.com,nurse,70,Nurse,True\n",
							"    8F5976E5-3EFB-45E7-8751-89C83BB10D86,RefStaffOrgRole,microsoft.com,occupationalTherapist,80,Occupational Therapist,True\n",
							"    DA01A84E-3E08-4047-996E-1240243825E6,RefStaffOrgRole,microsoft.com,physicalTherapist,90,Physical Therapist,True\n",
							"    CAA12695-48A2-4EAF-9798-EDB972CF89F2,RefStaffOrgRole,microsoft.com,speechTherapist,100,Speech Therapist,True\n",
							"    A5E30209-2416-47FF-BB2B-B30892A4544D,RefStaffOrgRole,microsoft.com,visionTherapist,110,Vision,True\n",
							"    4F0164B4-3827-4993-AEF5-29B5CCEAFA48,RefStaffOrgRole,microsoft.com,paraprofessional,120,Paraprofessional,True\n",
							"    329EF3DE-913A-45C2-B235-9B5BB9D1B576,RefStaffOrgRole,microsoft.com,teacherAssistant,130,Teacher Assistant,True\n",
							"    BC319764-C1EB-4DFA-8C43-65C8C96B5BBF,RefStaffOrgRole,microsoft.com,staff,140,Staff,True\n",
							"    D1CA502E-DB62-41D2-B438-AC669E6A9663,RefStudentSectionRole,imsglobal.org,student,10,Student,True\n",
							"    38846D3C-397F-40BB-B43E-89092FFB7FAD,RefStaffSectionRole,imsglobal.org,aide,10,Aide,True\n",
							"    453DD32F-1088-4BD4-9B0E-FD4AC325D676,RefStaffSectionRole,imsglobal.org,proctor,20,Proctor,True\n",
							"    C943E793-2DB7-47C0-B187-A9ED65EEBD5B,RefStaffSectionRole,imsglobal.org,teacher,30,Teacher,True\n",
							"    00574D97-8A98-454E-A879-9465A798CFE2,RefStaffSectionRole,microsoft.com,nurse,40,Nurse,True\n",
							"    6960C6A5-E850-4547-BF15-762A7260F7D9,RefStaffSectionRole,microsoft.com,occupationalTherapist,50,Occupational Therapist,True\n",
							"    F62E6FE1-DAC6-43D1-A6C9-EFB8429BA9C9,RefStaffSectionRole,microsoft.com,physicalTherapist,60,Physical Therapist,True\n",
							"    BD3A443E-778B-4B6F-85F7-D6B6E30D1795,RefStaffSectionRole,microsoft.com,speechTherapist,70,Speech Therapist,True\n",
							"    54970CC5-EE96-4A29-8A95-441109DEEBD0,RefStaffSectionRole,microsoft.com,visionTherapist,80,Vision,True\n",
							"    7690289D-A685-4886-B5A4-122544100B20,RefStaffSectionRole,microsoft.com,paraprofessional,90,Paraprofessional,True\n",
							"    C16353AD-902F-4CDC-86A5-30491A0612EA,RefStaffSectionRole,microsoft.com,teacherAssistant,100,Teacher Assistant,True\n",
							"    BBE8A650-B452-4B05-9CB6-D800F08A5E3C,RefStaffSectionRole,microsoft.com,staff,110,Staff,True\n",
							"    08DF30A4-DFF6-4EC9-8BDA-118F1B40FC4A,RefPersonGroupRole,microsoft.com,participant,10,Participant,True\n",
							"    632D8FC9-DEC5-420E-B8F4-D6CCFC3349F6,RefPersonGroupRole,microsoft.com,coach,20,Coach,True\n",
							"    E53285DE-8216-45C9-B0D0-3962883E425C,RefPersonGroupRole,microsoft.com,assistant,30,Assistant,True\n",
							"    353ABDDA-19D6-4008-8C56-506C65900782,RefGradeLevel,ceds.ed.gov,IT,10,Infant/Toddler,True\n",
							"    49EA747D-0A19-4EDF-BCFB-BB5F0166381F,RefGradeLevel,ceds.ed.gov,PR,20,Preschool,True\n",
							"    72B89395-E9E3-4564-8DAF-88AEA58AFED3,RefGradeLevel,ceds.ed.gov,PK,30,Prekindergarten,True\n",
							"    0CDED2E6-57B6-4A21-ABCC-1E3496DFB73E,RefGradeLevel,ceds.ed.gov,TK,40,Transitional Kindergarten,True\n",
							"    B1DA4920-25D6-4561-9221-ED4352F6B1B5,RefGradeLevel,ceds.ed.gov,KG,50,Kindergarten,True\n",
							"    6C0804DB-FF53-4CBB-88DC-BD00724A549E,RefGradeLevel,ceds.ed.gov,01,60,First grade,True\n",
							"    F81116C9-B37C-405F-A463-9E6279442376,RefGradeLevel,ceds.ed.gov,02,70,Second grade,True\n",
							"    E75F1B3A-3FFA-4E4D-8B55-6288F34FA491,RefGradeLevel,ceds.ed.gov,03,80,Third grade,True\n",
							"    5C9C9038-3E99-4EFD-9AF7-4B2C465D9ACA,RefGradeLevel,ceds.ed.gov,04,90,Fourth grade,True\n",
							"    490E900A-7629-47CD-B677-381718F9E2C4,RefGradeLevel,ceds.ed.gov,05,100,Fifth grade,True\n",
							"    DF413EB6-47E5-46DD-88AF-6478B2854D4A,RefGradeLevel,ceds.ed.gov,06,110,Sixth grade,True\n",
							"    6C2F76EA-5B22-4293-BA16-5216361AD233,RefGradeLevel,ceds.ed.gov,07,120,Seventh grade,True\n",
							"    B106D95C-CA5E-457E-B848-3A231917C34C,RefGradeLevel,ceds.ed.gov,08,130,Eighth grade,True\n",
							"    4429F333-536A-458F-AE87-FDF5471B5E8D,RefGradeLevel,ceds.ed.gov,09,140,Ninth grade,True\n",
							"    B6747F48-667B-4F0D-8438-9D1B180A3791,RefGradeLevel,ceds.ed.gov,10,150,Tenth grade,True\n",
							"    490702EA-9AC0-435E-AB8F-C1999BB0B393,RefGradeLevel,ceds.ed.gov,11,160,Eleventh grade,True\n",
							"    37DB651A-E2CC-4C16-8F52-27D4FA17B680,RefGradeLevel,ceds.ed.gov,12,170,Twelfth grade,True\n",
							"    8EDEF0A7-FE7A-48DD-A268-CA187E3986A5,RefGradeLevel,ceds.ed.gov,13,180,Grade 13,True\n",
							"    9C833058-4DA4-46D8-BB96-9A389105205E,RefGradeLevel,ceds.ed.gov,PS,190,Postsecondary,True\n",
							"    87DFDF97-B458-4F24-AD53-A1FEE4850309,RefGradeLevel,ceds.ed.gov,UG,200,Ungraded,True\n",
							"    7C0F1F97-101A-4E77-BC41-BAB1CC336733,RefGradeLevel,ceds.ed.gov,Other,210,Other,True\n",
							"    171E5E6E-4A6C-45B6-A185-1C8A63886B1C,RefRace,imsglobal.org,americanIndianOrAlaskaNative,10,American Indian or Alaska Native,True\n",
							"    49870DDA-FAD1-468E-B81A-103EB6ACC807,RefRace,imsglobal.org,asian,20,Asian,True\n",
							"    C417FFAF-9B5D-4809-9AD0-0CC88B334C1E,RefRace,imsglobal.org,blackOrAfricanAmerican,30,Black or African American,True\n",
							"    1DE06A27-C07B-4BA4-9228-B76CD70A6148,RefRace,imsglobal.org,nativeHawaiianOrOtherPacificIslander,40,Native Hawaiian or Other Pacific Islander,True\n",
							"    B953AE14-E0D1-47D3-B250-C72A8B0290DB,RefRace,imsglobal.org,white,50,White,True\n",
							"    547E761B-45D4-4A24-B1D7-814E4ABA35C2,RefEthnicity,imsglobal.org,hispanicOrLatinoEthnicity,10,Hispanic or Latino Ethnicity,True\n",
							"    08EAFC29-8F6D-4FF5-83A4-71B131D0E7DB,RefEnrollmentStatus,microsoft.com,ConcurrentlyEnrolled,10,Concurrently enrolled,True\n",
							"    F36F047A-F410-4761-B41F-17B952A8EAD4,RefEnrollmentStatus,microsoft.com,CurrentlyEnrolled,10,Currently enrolled,True\n",
							"    918F8FB7-D630-406F-BF04-62BF1255A148,RefEnrollmentStatus,microsoft.com,PreviouslyEnrolled,30,Previously enrolled,True\n",
							"    BEC33C7F-01C1-41EA-818F-FBFDAE867EB7,RefEnrollmentStatus,microsoft.com,Transferring,40,Transferring (will enroll),True\n",
							"    7DAF8820-6691-4D61-A210-CE94EA7D3667,RefIdentifierType,microsoft.com,ActiveDirectoryId,10,Active Directory Id,True\n",
							"    DB231C72-7C41-4A65-9A3D-49B9F6CD78C4,RefIdentifierType,microsoft.com,Fed,20,Federal Id,True\n",
							"    5D464768-0162-4B69-91CA-49F53AA0A474,RefIdentifierType,imsglobal.org,LTIId,30,LTI Id,True\n",
							"    450E6525-61A6-4BF6-A3D5-F95EB5CB1183,RefIdentifierType,imsglobal.org,username,40,Username (OneRoster),True\n",
							"    D787E8F6-4DD3-4C89-8293-CB3CDD0CC0A4,RefIdentifierType,imsglobal.org,identifier,50,Identifier (OneRoster),True\n",
							"    CEEF7E8E-E083-4048-B3C0-E7D1EE37A4E6,RefSectionType,imsglobal.org,homeroom,10,Homeroom,True\n",
							"    96669810-AB33-4B0F-92BE-6E2CC6F30EE9,RefSectionType,imsglobal.org,scheduled,20,Scheduled,True\n",
							"    E5F838D4-21C3-4932-850C-0BE7B169A85C,RefPublicSchoolResidenceStatus,ceds.ed.gov,01652,10,Resident of administrative unit and usual school attendance area.,True\n",
							"    901B2D88-967B-499B-91E8-9938CD03985F,RefPublicSchoolResidenceStatus,ceds.ed.gov,01653,20,\"Resident of administrative unit, but of other school attendance area.\",True\n",
							"    EFB677F4-D913-4A7E-A59D-8DD426CA7256,RefPublicSchoolResidenceStatus,ceds.ed.gov,01654,30,\"Resident of this state, but not of this administrative unit.\",True\n",
							"    3B5CBE72-809B-47C5-97BC-84EDF473CCFF,RefPublicSchoolResidenceStatus,ceds.ed.gov,01655,40,Resident of an administrative unit that crosses state boundaries.,True\n",
							"    C5BA9B59-F4A3-4506-BA0E-7F5967292D7A,RefPublicSchoolResidenceStatus,ceds.ed.gov,01656,50,Resident of another state.,True\n",
							"    BF84752E-4E3F-4B80-BED0-2DE4ABB355D5,RefRace,imsglobal.org,demographicRaceTwoOrMoreRaces,60,Designates multiple races,True\n",
							"    4B969AD4-3DF0-4C81-B586-E08DB2F89974,RefAcademicSubject,nces.ed.gov,01,10,English Language and Literature,True\n",
							"    DC5AE6F7-F7F7-4B0A-B838-C6A53947FC39,RefAcademicSubject,nces.ed.gov,02,20,Mathematics,True\n",
							"    3621BA8C-DA33-4230-AE29-7A69A674CAA1,RefAcademicSubject,nces.ed.gov,03,30,Life and Physical Sciences,True\n",
							"    3BCAA0B5-E890-4D44-9630-C2618FD8E872,RefAcademicSubject,nces.ed.gov,04,40,Social Sciences and History,True\n",
							"    DD70C99E-4863-4E76-BDC1-998CEE2E6075,RefAcademicSubject,nces.ed.gov,05,50,Visual and Performing Arts,True\n",
							"    0EFD2AC5-AA04-406D-BD9A-6C12602B4F44,RefAcademicSubject,nces.ed.gov,07,60,Religious Education and Theology,True\n",
							"    6ACD32DE-CF55-4D57-8058-BEADA9FA6745,RefAcademicSubject,nces.ed.gov,08,70,\"Physical, Health, and Safety Education\",True\n",
							"    FC6955CD-7355-41DC-A968-EE9BFBA51E19,RefAcademicSubject,nces.ed.gov,09,80,Military Science,True\n",
							"    5956FCAC-86B1-4110-B041-37569BD48E52,RefAcademicSubject,nces.ed.gov,10,90,Information Technology,True\n",
							"    B6EB7682-6A40-42E4-9963-AF9BB9890ECE,RefAcademicSubject,nces.ed.gov,11,100,Communication and Audio/Visual Technology,True\n",
							"    956A937F-A4EA-433D-9736-750E969745E5,RefAcademicSubject,nces.ed.gov,12,110,Business and Marketing,True\n",
							"    9F434285-9292-40F5-859D-715F1020AFFD,RefAcademicSubject,nces.ed.gov,13,120,Manufacturing,True\n",
							"    480A0424-CBE9-43B3-AF7F-F8BC3D11FECE,RefAcademicSubject,nces.ed.gov,14,130,Health Care Sciences,True\n",
							"    38BCFB35-1B7C-4E00-9F15-A9BB9347F7DE,RefAcademicSubject,nces.ed.gov,15,140,\"Public, Protective, and Government Service\",True\n",
							"    22A4D31A-E5A2-4C92-84B1-1E924547E083,RefAcademicSubject,nces.ed.gov,16,150,Hospitality and Tourism,True\n",
							"    49D3D99D-4AEE-4B59-B286-01978A458348,RefAcademicSubject,nces.ed.gov,17,160,Architecture and Construction,True\n",
							"    3690A6BE-5A9E-4D50-A97C-0368EA998A77,RefAcademicSubject,nces.ed.gov,18,170,\"Agriculture, Food, and Natural Resources\",True\n",
							"    2A52F377-0668-432C-BAB3-47669DDBFAA8,RefAcademicSubject,nces.ed.gov,19,180,Human Services,True\n",
							"    F183FE55-3189-4DA0-8FCF-8B027DD3FFD9,RefAcademicSubject,nces.ed.gov,20,190,\"Transportation, Distribution and Logistics\",True\n",
							"    2A7AC5E0-638E-4C56-A9B1-0EA0C4C068E8,RefAcademicSubject,nces.ed.gov,21,200,Engineering and Technology,True\n",
							"    B0095617-E1D0-4ADC-B07D-E96D06FFEEFB,RefAcademicSubject,nces.ed.gov,22,210,Miscellaneous,True\n",
							"    FC893BDD-3B3F-40F8-BD0E-921B4B7555D6,RefAcademicSubject,nces.ed.gov,23,220,Non-Subject-Specific,True\n",
							"    E937C1C2-398F-4DC2-A76A-0B39F3441311,RefAcademicSubject,nces.ed.gov,24,230,World Languages,True\n",
							"    F4DF5BDD-6698-4BB9-BC06-AA91325DDB3B,RefOrgType,microsoft.com,municipality,130,Municipality,True\n",
							"    8180C51D-59D8-42F5-B283-5F73CCDFE71E,RefOrgType,microsoft.com,academicTrust,140,Academic Trust,True\n",
							"    AB328F3A-329D-46B2-89FE-04558D5F3C17,RefOrgType,microsoft.com,localAuthority,150,Local Authority,True\n",
							"    A8AAFD43-8EC5-4E23-B4E4-F5FEBCD4EB23,RefOrgType,microsoft.com,region,160,Region,True\n",
							"    2432F831-58B0-4418-89DA-3AFB83CAA406,RefOrgType,microsoft.com,division,170,Division,True\n",
							"    E5F64566-42B1-4170-91ED-9095A7AABDF8,RefOrgType,microsoft.com,province,180,Province,True\n",
							"    A7B552AB-5FEE-4106-A82A-B104AD802243,RefOrgType,microsoft.com,researchCenter,190,Research Center,True\n",
							"    4A7A8BDF-CE07-4CF2-A774-061EE8814FB9,RefOrgType,microsoft.com,program,200,Program,True\n",
							"    BBDFDE11-F33A-4552-B070-0FEF5786E08F,RefStaffOrgRole,microsoft.com,professor,150,professor,True\n",
							"    23CD21F1-9932-4EED-BD5C-EE99A6C57B31,RefStaffOrgRole,microsoft.com,researcher,160,researcher,True\n",
							"    2A92CC07-161E-497D-8807-249F6A20948F,RefStaffOrgRole,microsoft.com,lecturer,170,lecturer,True\n",
							"    11DE2FAC-CAB6-4726-9462-1C3D91091429,RefStaffOrgRole,microsoft.com,affiliate,180,affiliate,True\n",
							"    DB0D832C-AA17-4F43-AB2B-92562DF9EF11,RefStaffOrgRole,microsoft.com,adjunct,190,adjunct,True\n",
							"    865BC785-449E-4F0C-A72B-3F8553D83F8A,RefStaffOrgRole,microsoft.com,alumni,200,alumni,True\n",
							"    845C489B-2A41-4A8E-B118-3080AD568418,RefStaffOrgRole,microsoft.com,instructor,210,instructor,True\n",
							"    75A1395F-CD88-4362-BE34-0AB54235F24C,RefStaffOrgRole,microsoft.com,chair,220,chair,True\n",
							"    583A3E66-878F-44E7-BBA3-1146C1BC5B2B,RefStaffOrgRole,microsoft.com,advisor,230,advisor,True\n",
							"    4D023BD0-FB4B-40D4-9C66-5995B1A765A6,RefStaffOrgRole,microsoft.com,faculty,240,faculty,True\n",
							"    0639C0E4-D351-42EF-92B4-8BD1CF27CA41,RefStaffOrgRole,microsoft.com,substitute,250,substitute,True\n",
							"    68294947-AA84-4D64-A9A3-16CBB1187E21,RefStaffOrgRole,microsoft.com,principal,260,principal,True\n",
							"    9D95BE64-81F1-49FA-8CC8-A93DD49B218F,RefStaffOrgRole,microsoft.com,specialServices,270,Special services,True\n",
							"    75A382BB-904C-461D-BE61-EDC0516B39D6,RefStaffSectionRole,microsoft.com,professor,120,professor,True\n",
							"    5742E90C-3600-4026-B014-3E0FFA5AC64C,RefStaffSectionRole,microsoft.com,researcher,130,researcher,True\n",
							"    08913527-F988-46E5-861A-A9C64A598CB5,RefStaffSectionRole,microsoft.com,lecturer,140,lecturer,True\n",
							"    8D939A14-7077-4A4A-88B5-ADB3C251BF17,RefStaffSectionRole,microsoft.com,affiliate,150,affiliate,True\n",
							"    6482B3B0-5A5C-4A32-820A-1749B323F9A9,RefStaffSectionRole,microsoft.com,adjunct,160,adjunct,True\n",
							"    65FB1E06-4E0C-4D69-8281-B1DD664FDF02,RefStaffSectionRole,microsoft.com,instructor,170,instructor,True\n",
							"    FDA194DD-3EBA-48AE-8ACE-83CE0A59C647,RefStaffSectionRole,microsoft.com,advisor,180,advisor,True\n",
							"    9C15F8C6-4287-4AF2-97C4-9A8AD1BE331E,RefStaffSectionRole,microsoft.com,faculty,190,faculty,True\n",
							"    75F91BF4-9816-4F36-8EC3-07EED1EE246E,RefStaffSectionRole,microsoft.com,substitute,200,substitute,True\n",
							"    15B67274-8286-4874-818B-AA361785B72D,RefStaffSectionRole,microsoft.com,principal,210,principal,True\n",
							"    6818DAAB-EBC6-4E3D-8DDE-2872F056F4B4,RefStaffSectionRole,microsoft.com,specialServices,220,Special services,True\n",
							"    9D829C49-EF4F-482C-AC37-10974F500889,RefGradeLevel,microsoft.com,PS1,220,Postsecondary freshman,True\n",
							"    72C52CC1-09B0-4F83-822C-3E6B41373250,RefGradeLevel,microsoft.com,PS2,230,Postsecondary sophomore,True\n",
							"    82C10216-45D1-4754-9B65-91906F220D97,RefGradeLevel,microsoft.com,PS3,240,Postsecondary junior,True\n",
							"    941D916E-900F-4AAE-862A-A37203ABB1CB,RefGradeLevel,microsoft.com,PS4,250,Postsecondary senior,True\n",
							"    85149F2C-769C-40CE-9CC8-A8F999291899,RefGradeLevel,microsoft.com,undergraduate,260,undergraduate,True\n",
							"    85CF8FA2-B882-4B58-8886-6AE741C4F5C7,RefGradeLevel,microsoft.com,graduate,270,graduate,True\n",
							"    3C9654D0-496E-421B-AC5B-41AF7A35EE7A,RefGradeLevel,microsoft.com,postgraduate,280,Graduate with an emphasis on research,True\n",
							"    CFEAC234-B304-49C4-B814-5448AC3A8FFD,RefGradeLevel,microsoft.com,alumni,290,alumni,True\n",
							"    BC7BD092-C3C1-4FAC-B82B-3D074DF4C832,RefGradeLevel,microsoft.com,adultEducation,300,Adult Education,True\"\"\""
						],
						"outputs": [],
						"execution_count": null
					}
				]
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/OEA_connector')]",
			"type": "Microsoft.Synapse/workspaces/notebooks",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"nbformat": 4,
				"nbformat_minor": 2,
				"bigDataPool": {
					"referenceName": "spark3p1sm",
					"type": "BigDataPoolReference"
				},
				"sessionProperties": {
					"driverMemory": "28g",
					"driverCores": 4,
					"executorMemory": "28g",
					"executorCores": 4,
					"numExecutors": 2,
					"conf": {
						"spark.dynamicAllocation.enabled": "false",
						"spark.dynamicAllocation.minExecutors": "2",
						"spark.dynamicAllocation.maxExecutors": "2",
						"spark.autotune.trackingId": "b3bfefd3-15ca-420e-8721-edc1c8e1807f"
					}
				},
				"metadata": {
					"saveOutput": true,
					"enableDebugMode": false,
					"kernelspec": {
						"name": "synapse_pyspark",
						"display_name": "Synapse PySpark"
					},
					"language_info": {
						"name": "python"
					},
					"a365ComputeOptions": {
						"id": "/subscriptions/7b9a4896-4541-483f-bdc7-d8f4ec6be3ee/resourceGroups/rg-oea-CISDAG1/providers/Microsoft.Synapse/workspaces/syn-oea-cisdag1/bigDataPools/spark3p1sm",
						"name": "spark3p1sm",
						"type": "Spark",
						"endpoint": "https://syn-oea-cisdag1.dev.azuresynapse.net/livyApi/versions/2019-11-01-preview/sparkPools/spark3p1sm",
						"auth": {
							"type": "AAD",
							"authResource": "https://dev.azuresynapse.net"
						},
						"sparkVersion": "3.1",
						"nodeCount": 3,
						"cores": 4,
						"memory": 28
					},
					"sessionKeepAliveTimeout": 30
				},
				"cells": [
					{
						"cell_type": "markdown",
						"metadata": {
							"nteract": {
								"transient": {
									"deleting": false
								}
							}
						},
						"source": [
							"# OEA connector\n",
							"This notebook provides a way for invoking methods on the OEA framework or supporting modules from a pipeline.\n",
							"\n",
							"When setting up a new module, be sure to include a new cell below that imports that module, so that its methods can be invoked by pipelines."
						]
					},
					{
						"cell_type": "code",
						"metadata": {
							"jupyter": {
								"source_hidden": false,
								"outputs_hidden": false
							},
							"nteract": {
								"transient": {
									"deleting": false
								}
							},
							"tags": [
								"parameters"
							]
						},
						"source": [
							"# These values should be passed in from the pipeline that is using this notebook as an activity.\r\n",
							"# Note that kwargs allows you to pass in a dict of params, but the dict has to specified as a string when invoked from a pipeline.\r\n",
							"# Also note that you can refer to attributes of an object in the params, for example: {'path':oea.stage2np}\r\n",
							"object_name = 'oea'\r\n",
							"method_name = ''\r\n",
							"kwargs = '{}'"
						],
						"outputs": [],
						"execution_count": null
					},
					{
						"cell_type": "code",
						"metadata": {
							"jupyter": {
								"outputs_hidden": false,
								"source_hidden": false
							},
							"nteract": {
								"transient": {
									"deleting": false
								}
							},
							"collapsed": true
						},
						"source": [
							"%run /OEA_py"
						],
						"outputs": [],
						"execution_count": null
					},
					{
						"cell_type": "code",
						"metadata": {
							"jupyter": {
								"outputs_hidden": false,
								"source_hidden": false
							},
							"nteract": {
								"transient": {
									"deleting": false
								}
							},
							"collapsed": true
						},
						"source": [
							"%run /ContosoSIS_py"
						],
						"outputs": [],
						"execution_count": null
					},
					{
						"cell_type": "code",
						"metadata": {
							"jupyter": {
								"source_hidden": false,
								"outputs_hidden": false
							},
							"nteract": {
								"transient": {
									"deleting": false
								}
							}
						},
						"source": [
							"obj = eval(object_name)\r\n",
							"kwargs = eval(kwargs)\r\n",
							"m = getattr(obj, method_name)\r\n",
							"result = m(**kwargs)\r\n",
							"mssparkutils.notebook.exit(result)"
						],
						"outputs": [],
						"execution_count": null
					}
				]
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/OEA_py')]",
			"type": "Microsoft.Synapse/workspaces/notebooks",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"nbformat": 4,
				"nbformat_minor": 2,
				"bigDataPool": {
					"referenceName": "spark3p1sm",
					"type": "BigDataPoolReference"
				},
				"sessionProperties": {
					"driverMemory": "28g",
					"driverCores": 4,
					"executorMemory": "28g",
					"executorCores": 4,
					"numExecutors": 2,
					"conf": {
						"spark.dynamicAllocation.enabled": "false",
						"spark.dynamicAllocation.minExecutors": "2",
						"spark.dynamicAllocation.maxExecutors": "2",
						"spark.autotune.trackingId": "73f111f5-d2dd-4fd1-8550-b9dd23576fbd"
					}
				},
				"metadata": {
					"saveOutput": true,
					"enableDebugMode": false,
					"kernelspec": {
						"name": "synapse_pyspark",
						"display_name": "python"
					},
					"language_info": {
						"name": "python"
					},
					"a365ComputeOptions": {
						"id": "/subscriptions/7b9a4896-4541-483f-bdc7-d8f4ec6be3ee/resourceGroups/rg-oea-CISDAG1/providers/Microsoft.Synapse/workspaces/syn-oea-cisdag1/bigDataPools/spark3p1sm",
						"name": "spark3p1sm",
						"type": "Spark",
						"endpoint": "https://syn-oea-cisdag1.dev.azuresynapse.net/livyApi/versions/2019-11-01-preview/sparkPools/spark3p1sm",
						"auth": {
							"type": "AAD",
							"authResource": "https://dev.azuresynapse.net"
						},
						"sparkVersion": "3.1",
						"nodeCount": 3,
						"cores": 4,
						"memory": 28
					},
					"sessionKeepAliveTimeout": 30
				},
				"cells": [
					{
						"cell_type": "code",
						"metadata": {
							"tags": [
								"parameters"
							]
						},
						"source": [
							"from delta.tables import DeltaTable\n",
							"from notebookutils import mssparkutils\n",
							"from pyspark.sql.types import StructType, StructField, StringType, IntegerType, DoubleType, ArrayType, TimestampType, BooleanType, ShortType, DateType\n",
							"from pyspark.sql import functions as F\n",
							"from pyspark.sql import SparkSession\n",
							"from pyspark.sql.utils import AnalysisException\n",
							"from opencensus.ext.azure.log_exporter import AzureLogHandler, logging\n",
							"import pandas as pd\n",
							"import sys\n",
							"import re\n",
							"import json\n",
							"import datetime\n",
							"import pytz\n",
							"import random\n",
							"import io\n",
							"\n",
							"logger = logging.getLogger('OEA')\n",
							"\n",
							"class OEA:\n",
							"    def __init__(self, storage_account='', instrumentation_key=None, salt='', logging_level=logging.DEBUG):\n",
							"        if storage_account:\n",
							"            self.storage_account = storage_account\n",
							"        else:\n",
							"            oea_id = mssparkutils.env.getWorkspaceName()[8:] # extracts the OEA id for this OEA instance from the synapse workspace name (based on OEA naming convention)\n",
							"            self.storage_account = 'stoea' + oea_id # sets the name of the storage account based on OEA naming convention\n",
							"            self.keyvault = 'kv-oea-' + oea_id\n",
							"        self.keyvault_linked_service = 'LS_KeyVault_OEA'\n",
							"        self.serverless_sql_endpoint = mssparkutils.env.getWorkspaceName() + '-ondemand.sql.azuresynapse.net'\n",
							"        self._initialize_logger(instrumentation_key, logging_level)\n",
							"        self.salt = salt\n",
							"        self.timezone = 'EST'\n",
							"        self.stage1np = 'abfss://stage1np@' + self.storage_account + '.dfs.core.windows.net'\n",
							"        self.stage2np = 'abfss://stage2np@' + self.storage_account + '.dfs.core.windows.net'\n",
							"        self.stage2p = 'abfss://stage2p@' + self.storage_account + '.dfs.core.windows.net'\n",
							"        self.stage3np = 'abfss://stage3np@' + self.storage_account + '.dfs.core.windows.net'\n",
							"        self.stage3p = 'abfss://stage3p@' + self.storage_account + '.dfs.core.windows.net'\n",
							"        self.framework_path = 'abfss://oea-framework@' + self.storage_account + '.dfs.core.windows.net'\n",
							"\n",
							"        # Initialize framework db\n",
							"        spark.sql(f\"CREATE DATABASE IF NOT EXISTS oea\")\n",
							"        spark.sql(f\"CREATE TABLE IF NOT EXISTS oea.env (name string not null, value string not null, description string) USING DELTA LOCATION '{self.framework_path}/db/env'\")\n",
							"        df = spark.sql(\"select value from oea.env where name='storage_account'\")\n",
							"        if df.first(): spark.sql(f\"UPDATE oea.env set value='{self.storage_account}' where name='storage_account'\")\n",
							"        else: spark.sql(f\"INSERT INTO oea.env VALUES ('storage_account', '{self.storage_account}', 'The name of the data lake storage account for this OEA instance.')\")\n",
							"        spark.sql(f\"CREATE TABLE IF NOT EXISTS OEA.watermark (source string not null, entity string not null, watermark timestamp not null) USING DELTA LOCATION '{self.framework_path}/db/watermark'\")\n",
							"\n",
							"        logger.debug(\"OEA initialized.\")\n",
							"    \n",
							"    def path(self, container_name, directory_path=None):\n",
							"        if directory_path:\n",
							"            return f'abfss://{container_name}@{self.storage_account}.dfs.core.windows.net/{directory_path}'\n",
							"        else:\n",
							"            return f'abfss://{container_name}@{self.storage_account}.dfs.core.windows.net'\n",
							"\n",
							"    def convert_path(self, path):\n",
							"        \"\"\" Converts the given path into a valid url.\n",
							"            eg, convert_path('stage1np/contoso_sis/student/*') # returns abfss://stage1np@storageaccount.dfs.core.windows.net/contoso_sis/student/*\n",
							"        \"\"\"\n",
							"        path_args = path.split('/')\n",
							"        stage = path_args.pop(0)\n",
							"        return self.path(stage, '/'.join(path_args))            \n",
							"\n",
							"    def _initialize_logger(self, instrumentation_key, logging_level):\n",
							"        logging.lastResort = None\n",
							"        # the logger will print an error like \"ValueError: I/O operation on closed file\" because we're trying to have log messages also print to stdout\n",
							"        # and apparently this causes issues on some of the spark executor nodes. The bottom line is that we don't want these logging errors to get printed in the notebook output.\n",
							"        logging.raiseExceptions = False\n",
							"        logger.setLevel(logging_level)\n",
							"\n",
							"        handler = logging.StreamHandler(sys.stdout)\n",
							"        handler.setLevel(logging_level)\n",
							"        formatter = logging.Formatter('%(asctime)s - %(name)s - %(levelname)s - %(message)s')\n",
							"        handler.setFormatter(formatter)\n",
							"        logger.addHandler(handler)\n",
							"\n",
							"        if instrumentation_key:\n",
							"            # Setup logging to go to app insights (more info here: https://github.com/balakreshnan/Samples2021/blob/main/Synapseworkspace/opencensuslog.md#azure-synapse-spark-logs-runtime-errors-to-application-insights)\n",
							"            logger.addHandler(AzureLogHandler(connection_string='InstrumentationKey=' + instrumentation_key))\n",
							"\n",
							"    def get_value_from_db(self, query):\n",
							"        df = spark.sql(query)\n",
							"        if df.first(): return df.first()[0]\n",
							"        else: return None\n",
							"\n",
							"    def get_last_watermark(self, source, entity):\n",
							"        return self.get_value_from_db(f\"select w.watermark from oea.watermark w where w.source='{source}' and w.entity='{entity}' order by w.watermark desc\")\n",
							"\n",
							"    def insert_watermark(self, source, entity, watermark_datetime):\n",
							"        spark.sql(f\"insert into oea.watermark values ('{source}', '{entity}', '{watermark_datetime}')\")\n",
							"\n",
							"    def get_secret(self, secret_name):\n",
							"        \"\"\" Retrieves the specified secret from the keyvault.\n",
							"            This method assumes that the keyvault linked service has been setup and is accessible.\n",
							"        \"\"\"\n",
							"        sc = SparkSession.builder.getOrCreate()\n",
							"        token_library = sc._jvm.com.microsoft.azure.synapse.tokenlibrary.TokenLibrary\n",
							"        value = token_library.getSecret(self.keyvault, secret_name, self.keyvault_linked_service)        \n",
							"        return value\n",
							"\n",
							"    def delete(self, path):\n",
							"        oea.rm_if_exists(self.convert_path(path))\n",
							"\n",
							"    def land(self, data_source, entity, df, partition_label='', format_str='csv', header=True, mode='overwrite'):\n",
							"        \"\"\" Lands data in stage1np. If partition label is not provided, the current datetime is used with the label of 'batchdate'.\n",
							"            eg, land('contoso_isd', 'student', data, 'school_year=2021')\n",
							"        \"\"\"\n",
							"        tz = pytz.timezone(self.timezone)\n",
							"        datetime_str = datetime.datetime.now(tz).replace(microsecond=0).isoformat()\n",
							"        datetime_str = datetime_str.replace(':', '') # Path names can't have a colon - https://github.com/apache/hadoop/blob/trunk/hadoop-common-project/hadoop-common/src/site/markdown/filesystem/introduction.md#path-names\n",
							"        df.write.format(format_str).save(self.path('stage1np', f'{data_source}/{entity}/{partition_label}/batchdate={datetime_str}'), header=header, mode=mode)\n",
							"\n",
							"    def load(self, folder, table, stage=None, data_format='delta'):\n",
							"        \"\"\" Loads a dataframe based on the path specified in the given args \"\"\"\n",
							"        if stage is None: stage = self.stage2p\n",
							"        path = f\"{stage}/{folder}/{table}\"\n",
							"        try:\n",
							"            df = spark.read.load(f\"{stage}/{folder}/{table}\", format=data_format)\n",
							"            return df        \n",
							"        except AnalysisException as e:\n",
							"            raise ValueError(\"Failed to load. Are you sure you have the right path?\\nMore info below:\\n\" + str(e)) \n",
							"\n",
							"    def load_csv(self, path, header=True):\n",
							"        \"\"\" Loads a dataframe based on the path specified \n",
							"            eg, df = load_csv('stage1np/example/student/*')\n",
							"        \"\"\"\n",
							"        url_path = self.convert_path(path)\n",
							"        try:\n",
							"            df = spark.read.load(url_path, format='csv', header=header)\n",
							"            return df        \n",
							"        except AnalysisException as e:\n",
							"            raise ValueError(f\"Failed to load from: {url_path}. Are you sure you have the right path?\\nMore info below:\\n\" + str(e))\n",
							"\n",
							"    def load_delta(self, path):\n",
							"        \"\"\" Loads a dataframe based on the path specified \n",
							"            eg, df = load_delta('stage2np/example/student/*')\n",
							"        \"\"\"\n",
							"        url_path = self.convert_path(path)\n",
							"        try:\n",
							"            df = spark.read.load(url_path, format='delta')\n",
							"            return df        \n",
							"        except AnalysisException as e:\n",
							"            raise ValueError(f\"Failed to load from: {url_path}. Are you sure you have the right path?\\nMore info below:\\n\" + str(e))\n",
							"\n",
							"    def load_from_stage1(self, path_and_filename, data_format='csv', header=True):\n",
							"        \"\"\" Loads a dataframe with data from stage1, based on the path specified in the given args \"\"\"\n",
							"        path = f\"{self.stage1np}/{path_and_filename}\"\n",
							"        df = spark.read.load(path, format=data_format, header=header)\n",
							"        return df        \n",
							"\n",
							"    def load_sample_from_csv_file(self, path_and_filename, header=True, stage=None):\n",
							"        \"\"\" Loads a sample from the specified csv file and returns a pandas dataframe.\n",
							"            Ex: print(load_sample_from_csv_file('/student_data/students.csv'))\n",
							"        \"\"\"\n",
							"        if stage is None: stage = self.stage1np\n",
							"        csv_str = mssparkutils.fs.head(f\"{stage}/{path_and_filename}\") # https://docs.microsoft.com/en-us/azure/synapse-analytics/spark/microsoft-spark-utilities?pivots=programming-language-python#preview-file-content\n",
							"        complete_lines = re.match(r\".*\\n\", csv_str, re.DOTALL).group(0)\n",
							"        if header: header = 0 # for info on why this is needed: https://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.read_csv.html\n",
							"        else: header = None\n",
							"        pdf = pd.read_csv(io.StringIO(complete_lines), sep=',', header=header)\n",
							"        return pdf\n",
							"\n",
							"    def print_stage(self, path):\n",
							"        \"\"\" Prints out the highlevel contents of the specified stage.\"\"\"\n",
							"        msg = path + \"\\n\"\n",
							"        folders = self.get_folders(path)\n",
							"        for folder_name in folders:\n",
							"            entities = self.get_folders(path + '/' + folder_name)\n",
							"            msg += f\"{folder_name}: {entities}\\n\"\n",
							"        print(msg)            \n",
							"\n",
							"    def fix_column_names(self, df):\n",
							"        \"\"\" Fix column names to satisfy the Parquet naming requirements by substituting invalid characters with an underscore. \"\"\"\n",
							"        df_with_valid_column_names = df.select([F.col(col).alias(re.sub(\"[ ,;{}()\\n\\t=]+\", \"_\", col)) for col in df.columns])\n",
							"        return df_with_valid_column_names\n",
							"\n",
							"    def to_spark_schema(self, schema):#: list[list[str]]):\n",
							"        \"\"\" Creates a spark schema from a schema specified in the OEA schema format. \n",
							"            Example:\n",
							"            schemas['Person'] = [['Id','string','hash'],\n",
							"                                    ['CreateDate','timestamp','no-op'],\n",
							"                                    ['LastModifiedDate','timestamp','no-op']]\n",
							"            to_spark_schema(schemas['Person'])\n",
							"        \"\"\"\n",
							"        fields = []\n",
							"        for col_name, dtype, op in schema:\n",
							"            fields.append(StructField(col_name, globals()[dtype.lower().capitalize() + \"Type\"](), True))\n",
							"        spark_schema = StructType(fields)\n",
							"        return spark_schema\n",
							"\n",
							"    def ingest_incremental_data(self, source_system, tablename, schema, partition_by, primary_key='id', data_format='csv', has_header=True):\n",
							"        \"\"\" Processes incremental batch data from stage1 into stage2 \"\"\"\n",
							"        source_path = f'{self.stage1np}/{source_system}/{tablename}'\n",
							"        p_destination_path = f'{self.stage2p}/{source_system}/{tablename}_pseudo'\n",
							"        np_destination_path = f'{self.stage2np}/{source_system}/{tablename}_lookup'\n",
							"        logger.info(f'Processing incremental data from: {source_path} and writing out to: {p_destination_path}')\n",
							"\n",
							"        if has_header: header_flag = 'true'\n",
							"        else: header_flag = 'false'\n",
							"        spark_schema = self.to_spark_schema(schema)\n",
							"        df = spark.readStream.load(source_path + '/*', format=data_format, header=header_flag, schema=spark_schema)\n",
							"        #df = spark.read.load(source_path + '/*', format=data_format, header=header_flag, schema=spark_schema)\n",
							"        #display(df)\n",
							"        #df = df.withColumn('batchdate', F.to_timestamp(df.batchdate, \"yyyy-MM-dd'T'HHmmssZ\"))\n",
							"        df = df.dropDuplicates([primary_key]) # drop duplicates across batches. More info: https://spark.apache.org/docs/latest/structured-streaming-programming-guide.html#streaming-deduplication\n",
							"        \n",
							"        df_pseudo, df_lookup = self.pseudonymize(df, schema)\n",
							"\n",
							"        if len(df_pseudo.columns) == 0:\n",
							"            logger.info('No data to be written to stage2p')\n",
							"        else:        \n",
							"            query = df_pseudo.writeStream.format(\"delta\").outputMode(\"append\").trigger(once=True).option(\"checkpointLocation\", source_path + '/_checkpoints/incremental_p').partitionBy(partition_by)\n",
							"            query = query.start(p_destination_path)\n",
							"            query.awaitTermination()   # block until query is terminated, with stop() or with error; A StreamingQueryException will be thrown if an exception occurs.\n",
							"            logger.info(query.lastProgress)\n",
							"\n",
							"        if len(df_lookup.columns) == 0:\n",
							"            logger.info('No data to be written to stage2np')\n",
							"        else:\n",
							"            query2 = df_lookup.writeStream.format(\"delta\").outputMode(\"append\").trigger(once=True).option(\"checkpointLocation\", source_path + '/_checkpoints/incremental_np').partitionBy(partition_by)\n",
							"            query2 = query2.start(np_destination_path)\n",
							"            query2.awaitTermination()   # block until query is terminated, with stop() or with error; A StreamingQueryException will be thrown if an exception occurs.\n",
							"            logger.info(query2.lastProgress)        \n",
							"\n",
							"    def _merge_into_table(self, df, destination_path, checkpoints_path, condition):\n",
							"        \"\"\" Merges data from the given dataframe into the delta table at the specified destination_path, based on the given condition.\n",
							"            If not delta table exists at the specified destination_path, a new delta table is created and the data from the given dataframe is inserted.\n",
							"            eg, merge_into_table(df_lookup, np_destination_path, source_path + '/_checkpoints/delta_np', \"current.id_pseudonym = updates.id_pseudonym\")\n",
							"        \"\"\"\n",
							"        if DeltaTable.isDeltaTable(spark, destination_path):      \n",
							"            dt = DeltaTable.forPath(spark, destination_path)\n",
							"            def upsert(batch_df, batchId):\n",
							"                dt.alias(\"current\").merge(batch_df.alias(\"updates\"), condition).whenMatchedUpdateAll().whenNotMatchedInsertAll().execute()                \n",
							"            query = df.writeStream.format(\"delta\").foreachBatch(upsert).outputMode(\"update\").trigger(once=True).option(\"checkpointLocation\", checkpoints_path)\n",
							"        else:\n",
							"            logger.info(f'Delta table does not yet exist at {destination_path} - creating one now and inserting initial data.')\n",
							"            query = df.writeStream.format(\"delta\").outputMode(\"append\").trigger(once=True).option(\"checkpointLocation\", checkpoints_path)\n",
							"        query = query.start(destination_path)\n",
							"        query.awaitTermination()   # block until query is terminated, with stop() or with error; A StreamingQueryException will be thrown if an exception occurs.\n",
							"        logger.info(query.lastProgress)    \n",
							"\n",
							"    def ingest_delta_data(self, source_system, tablename, schema, partition_by, primary_key='id', data_format='csv', has_header=True):\n",
							"        \"\"\" Processes delta batch data from stage1 into stage2 \"\"\"\n",
							"        source_path = f'{self.stage1np}/{source_system}/{tablename}'\n",
							"        p_destination_path = f'{self.stage2p}/{source_system}/{tablename}_pseudo'\n",
							"        np_destination_path = f'{self.stage2np}/{source_system}/{tablename}_lookup'\n",
							"        logger.info(f'Processing delta data from: {source_path} and writing out to: {p_destination_path}')\n",
							"\n",
							"        if has_header: header_flag = 'true'\n",
							"        else: header_flag = 'false'\n",
							"        spark_schema = self.to_spark_schema(schema)\n",
							"        df = spark.readStream.load(source_path + '/*', format=data_format, header=header_flag, schema=spark_schema)\n",
							"        \n",
							"        df_pseudo, df_lookup = self.pseudonymize(df, schema)\n",
							"\n",
							"        if len(df_pseudo.columns) == 0:\n",
							"            logger.info('No data to be written to stage2p')\n",
							"        else:\n",
							"            self._merge_into_table(df_pseudo, p_destination_path, source_path + '/_checkpoints/delta_p', \"current.id_pseudonym = updates.id_pseudonym\")\n",
							"\n",
							"        if len(df_lookup.columns) == 0:\n",
							"            logger.info('No data to be written to stage2np')\n",
							"        else:\n",
							"            self._merge_into_table(df_lookup, np_destination_path, source_path + '/_checkpoints/delta_np', \"current.id_pseudonym = updates.id_pseudonym\")\n",
							"\n",
							"    def ingest_snapshot_data(self, source_system, tablename, schema, partition_by, primary_key='id', data_format='csv', has_header=True):\n",
							"        \"\"\" Processes snapshot batch data from stage1 into stage2 \"\"\"\n",
							"        source_path = f'{self.stage1np}/{source_system}/{tablename}'\n",
							"        latest_batch = self.get_latest_folder(source_path)\n",
							"        source_path = source_path + '/' + latest_batch\n",
							"        p_destination_path = f'{self.stage2p}/{source_system}/{tablename}_pseudo'\n",
							"        np_destination_path = f'{self.stage2np}/{source_system}/{tablename}_lookup'\n",
							"        logger.info(f'Processing snapshot data from: {source_path} and writing out to: {p_destination_path}')\n",
							"\n",
							"        if has_header: header_flag = 'true'\n",
							"        else: header_flag = 'false'\n",
							"        spark_schema = self.to_spark_schema(schema)\n",
							"        df = spark.read.load(source_path, format=data_format, header=header_flag, schema=spark_schema)\n",
							"        df = df.dropDuplicates([primary_key]) # More info: https://spark.apache.org/docs/latest/structured-streaming-programming-guide.html#streaming-deduplication\n",
							"        \n",
							"        df_pseudo, df_lookup = self.pseudonymize(df, schema)\n",
							"\n",
							"        if len(df_pseudo.columns) == 0:\n",
							"            logger.info('No data to be written to stage2p')\n",
							"        else:\n",
							"            df_pseudo.write.save(p_destination_path, format='delta', mode='overwrite', partitionBy=partition_by) \n",
							"\n",
							"        if len(df_lookup.columns) == 0:\n",
							"            logger.info('No data to be written to stage2np')\n",
							"        else:\n",
							"            df_lookup.write.save(np_destination_path, format='delta', mode='overwrite', partitionBy=partition_by) \n",
							"\n",
							"    def pseudonymize(self, df, schema): #: list[list[str]]):\n",
							"        \"\"\" Performs pseudonymization of the given dataframe based on the provided schema.\n",
							"            For example, if the given df is for an entity called person, \n",
							"            2 dataframes will be returned, one called person that has hashed ids and masked fields, \n",
							"            and one called person_lookup that contains the original person_id, person_id_pseudo,\n",
							"            and the non-masked values for columns marked to be masked.\"\"\"\n",
							"        \n",
							"        df_pseudo = df_lookup = df\n",
							"\n",
							"        for col_name, dtype, op in schema:\n",
							"            if op == \"hash-no-lookup\" or op == \"hnl\":\n",
							"                # This means that the lookup can be performed against a different table so no lookup is needed.\n",
							"                df_pseudo = df_pseudo.withColumn(col_name, F.sha2(F.concat(F.col(col_name), F.lit(self.salt)), 256)).withColumnRenamed(col_name, col_name + \"_pseudonym\")\n",
							"                df_lookup = df_lookup.drop(col_name)           \n",
							"            elif op == \"hash\" or op == 'h':\n",
							"                df_pseudo = df_pseudo.withColumn(col_name, F.sha2(F.concat(F.col(col_name), F.lit(self.salt)), 256)).withColumnRenamed(col_name, col_name + \"_pseudonym\")\n",
							"                df_lookup = df_lookup.withColumn(col_name + \"_pseudonym\", F.sha2(F.concat(F.col(col_name), F.lit(self.salt)), 256))\n",
							"            elif op == \"mask\" or op == 'm':\n",
							"                df_pseudo = df_pseudo.withColumn(col_name, F.lit('*'))\n",
							"            elif op == \"partition-by\":\n",
							"                pass # make no changes for this column so that it will be in both dataframes and can be used for partitioning\n",
							"            elif op == \"no-op\" or op == 'x':\n",
							"                df_lookup = df_lookup.drop(col_name)\n",
							"\n",
							"        df_pseudo = self.fix_column_names(df_pseudo)\n",
							"        df_lookup = self.fix_column_names(df_lookup)\n",
							"\n",
							"        return (df_pseudo, df_lookup)\n",
							"\n",
							"    # Returns true if the path exists\n",
							"    def path_exists(self, path):\n",
							"        tableExists = False\n",
							"        try:\n",
							"            items = mssparkutils.fs.ls(path)\n",
							"            tableExists = True\n",
							"        except Exception as e:\n",
							"            # This Exception comes as a generic Py4JJavaError that occurs when the path specified is not found.\n",
							"            pass\n",
							"        return tableExists\n",
							"\n",
							"    def ls(self, path):\n",
							"        if not path.startswith(\"abfss:\"):\n",
							"            path = self.convert_path(path)\n",
							"        folders = []\n",
							"        files = []\n",
							"        try:\n",
							"            items = mssparkutils.fs.ls(path)\n",
							"            for item in items:\n",
							"                if item.isFile:\n",
							"                    files.append(item.name)\n",
							"                elif item.isDir:\n",
							"                    folders.append(item.name)\n",
							"        except Exception as e:\n",
							"            logger.warning(\"[OEA] Could not peform ls on specified path: \" + path + \"\\nThis may be because the path does not exist.\")\n",
							"        return (folders, files)\n",
							"\n",
							"    def print_stage(self, path):\n",
							"        print(path)\n",
							"        folders = self.get_folders(path)\n",
							"        for folder_name in folders:\n",
							"            entities = self.get_folders(path + '/' + folder_name)\n",
							"            print(f\"{folder_name}: {entities}\")\n",
							"\n",
							"    # Return the list of folders found in the given path.\n",
							"    def get_folders(self, path):\n",
							"        dirs = []\n",
							"        try:\n",
							"            items = mssparkutils.fs.ls(path)\n",
							"            for item in items:\n",
							"                #print(item.name, item.isDir, item.isFile, item.path, item.size)\n",
							"                if item.isDir:\n",
							"                    dirs.append(item.name)\n",
							"        except Exception as e:\n",
							"            logger.warning(\"[OEA] Could not get list of folders in specified path: \" + path + \"\\nThis may be because the path does not exist.\")\n",
							"        return dirs\n",
							"\n",
							"    def get_latest_folder(self, path):\n",
							"        folders = self.get_folders(path)\n",
							"        if len(folders) > 0: return folders[-1]\n",
							"        else: return None\n",
							"\n",
							"    # Remove a folder if it exists (defaults to use of recursive removal).\n",
							"    def rm_if_exists(self, path, recursive_remove=True):\n",
							"        try:\n",
							"            mssparkutils.fs.rm(path, recursive_remove)\n",
							"        except Exception as e:\n",
							"            pass\n",
							"\n",
							"    def pop_from_path(self, path):\n",
							"        \"\"\" Pops the last arg in a path and returns the path and the last arg as a tuple.\n",
							"            pop_from_path('abfss://stage2@xyz.dfs.core.windows.net/ms_insights/test.csv') # returns ('abfss://stage2@xyz.dfs.core.windows.net/ms_insights', 'test.csv')\n",
							"        \"\"\"\n",
							"        m = re.match(r\"(.*)\\/([^/]+)\", path)\n",
							"        return (m.group(1), m.group(2))\n",
							"\n",
							"    def parse_source_path(self, path):\n",
							"        \"\"\" Parses a path that looks like this: abfss://stage2p@stoeacisd3ggimpl3.dfs.core.windows.net/ms_insights\n",
							"            and returns a dictionary like this: {'stage_num': '2', 'ss': 'ms_insights'}\n",
							"            Note that it will also return a 'stage_num' of 2 if the path is stage2p or stage2np - this is by design because the spark db with the s2 prefix will be used for data in stage2 and stage2p.\n",
							"        \"\"\"\n",
							"        m = re.match(r\".*:\\/\\/stage(?P<stage_num>\\d+)[n]?[p]?@[^/]+\\/(?P<ss>[^/]+)\", path)\n",
							"        return m.groupdict()\n",
							"    \n",
							"    def create_lake_db(self, stage_num, source_dir, source_format='DELTA'):\n",
							"        \"\"\" Creates a spark db that points to data in the given stage under the specified source directory (assumes that every folder in the source_dir is a table).\n",
							"            Example: create_lake_db(2, 'contoso_sis')\n",
							"            Note that a spark db that points to source data in the delta format can't be queried via SQL serverless pool. More info here: https://docs.microsoft.com/en-us/azure/synapse-analytics/sql/resources-self-help-sql-on-demand#delta-lake\n",
							"        \"\"\"\n",
							"        db_name = f's{stage_num}_{source_dir}'\n",
							"        spark.sql(f'CREATE DATABASE IF NOT EXISTS {db_name}')\n",
							"        self.create_lake_views(db_name, self.path(f'stage{stage_num}p', source_dir), source_format)\n",
							"        self.create_lake_views(db_name, self.path(f'stage{stage_num}np', source_dir), source_format)\n",
							"        result = \"Database created: \" + db_name\n",
							"        logger.info(result)\n",
							"        return result        \n",
							"\n",
							"    def create_lake_views(self, db_name, source_path, source_format):\n",
							"        dirs = self.get_folders(source_path)\n",
							"        for table_name in dirs:\n",
							"            spark.sql(f\"create table if not exists {db_name}.{table_name} using {source_format} location '{source_path}/{table_name}'\")\n",
							"\n",
							"    def drop_lake_db(self, db_name):\n",
							"        spark.sql(f'DROP DATABASE IF EXISTS {db_name} CASCADE')\n",
							"        result = \"Database dropped: \" + db_name\n",
							"        logger.info(result)\n",
							"        return result       \n",
							"\n",
							"    def create_sql_db(self, stage_num, source_dir, source_format='DELTA'):\n",
							"        \"\"\" Prints out the sql script needed for creating a sql serverless db and set of views. \"\"\"\n",
							"        db_name = f'sqls{stage_num}_{source_dir}'\n",
							"        cmd += '-- Create a new sql script then execute the following in it:'\n",
							"        cmd += f\"IF NOT EXISTS (SELECT * FROM sys.databases WHERE name = '{db_name}')\\nBEGIN\\n  CREATE DATABASE {db_name};\\nEND;\\nGO\\n\"\n",
							"        cmd += f\"USE {db_name};\\nGO\\n\\n\"\n",
							"        cmd += self.create_sql_views(self.path(f'stage{stage_num}p', source_dir), source_format)\n",
							"        cmd += self.create_sql_views(self.path(f'stage{stage_num}np', source_dir), source_format)\n",
							"        print(cmd)\n",
							"\n",
							"    def create_sql_views(self, source_path, source_format):\n",
							"        cmd = ''      \n",
							"        dirs = self.get_folders(source_path)\n",
							"        for table_name in dirs:\n",
							"            cmd += f\"CREATE OR ALTER VIEW {table_name} AS\\n  SELECT * FROM OPENROWSET(BULK '{source_path}/{table_name}', FORMAT='{source_format}') AS [r];\\nGO\\n\"\n",
							"        return cmd\n",
							"\n",
							"    def drop_sql_db(self, db_name):\n",
							"        print('Click on the menu next to the SQL db and select \"Delete\"')\n",
							"\n",
							"    # List installed packages\n",
							"    def list_packages(self):\n",
							"        import pkg_resources\n",
							"        for d in pkg_resources.working_set:\n",
							"            print(d)\n",
							"\n",
							"    def print_schema_starter(self, entity_name, df):\n",
							"        \"\"\" Prints a starter schema that can be modified as needed when developing the oea schema for a new module. \"\"\"\n",
							"        st = f\"self.schemas['{entity_name}'] = [\"\n",
							"        for col in df.schema:\n",
							"            st += f\"['{col.name}', '{str(col.dataType)[:-4].lower()}', 'no-op'],\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\"\n",
							"        return st[:-11] + ']'\n",
							"\n",
							"    def write_rows_as_csv(data, folder, filename, container=None):\n",
							"        \"\"\" Writes a dictionary as a csv to the specified location. This is helpful when creating test data sets and landing them in stage1np.\n",
							"            data = [{'id':'1','fname':'John'}, {'id':'1','fname':'Jane'}]\n",
							"        \"\"\"\n",
							"        if container == None: container = self.stage1np\n",
							"        pdf = pd.DataFrame(data)\n",
							"        mssparkutils.fs.put(f\"{container}/{folder}/{filename}\", pdf.to_csv(index=False), True) # True indicates overwrite mode  \n",
							"\n",
							"    def write_rowset_as_csv(data, folder, container=None):\n",
							"        \"\"\" Writes out as csv rows the passed in data. The inbound data should be in a format like this:\n",
							"            data = { 'students':[{'id':'1','fname':'John'}], 'courses':[{'id':'31', 'name':'Math'}] }\n",
							"        \"\"\"\n",
							"        if container == None: container = self.stage1np\n",
							"        for entity_name, value in data.items():\n",
							"            pdf = pd.DataFrame(value)\n",
							"            mssparkutils.fs.put(f\"{container}/{folder}/{entity_name}.csv\", pdf.to_csv(index=False), True) # True indicates overwrite mode         \n",
							"\n",
							"    def create_empty_dataframe(self, schema):\n",
							"        \"\"\" Creates an empty dataframe based on the given schema which is specified as an array of column names and sql types.\n",
							"            eg, schema = [['data_source','string'], ['entity','string'], ['watermark','timestamp']]\n",
							"        \"\"\"\n",
							"        fields = []\n",
							"        for col_name, col_type in schema:\n",
							"            fields.append(StructField(col_name, globals()[col_type.lower().capitalize() + \"Type\"](), True))\n",
							"        spark_schema = StructType(fields)\n",
							"        df = spark.createDataFrame(spark.sparkContext.emptyRDD(), spark_schema)\n",
							"        return df\n",
							"\n",
							"    def delete_data_source(self, data_source):\n",
							"        self.rm_if_exists(self.convert_path(f'stage1np/{data_source}'))\n",
							"        self.rm_if_exists(self.convert_path(f'stage2np/{data_source}'))\n",
							"        self.rm_if_exists(self.convert_path(f'stage2p/{data_source}'))\n",
							"\n",
							"class BaseOEAModule:\n",
							"    \"\"\" Provides data processing methods for Contoso SIS data (the student information system for the fictional Contoso school district).  \"\"\"\n",
							"    def __init__(self, source_folder, pseudonymize = True):\n",
							"        self.source_folder = source_folder\n",
							"        self.pseudonymize = pseudonymize\n",
							"        self.stage1np = f\"{oea.stage1np}/{source_folder}\"\n",
							"        self.stage2np = f\"{oea.stage2np}/{source_folder}\"\n",
							"        self.stage2p = f\"{oea.stage2p}/{source_folder}\"\n",
							"        self.stage3np = f\"{oea.stage3np}/{source_folder}\"\n",
							"        self.stage3p = f\"{oea.stage3p}/{source_folder}\"\n",
							"        self.module_path = f\"{oea.framework_path}/modules/{source_folder}\"\n",
							"        self.schemas = {}\n",
							"\n",
							"    def _process_entity_from_stage1(self, path, entity_name, format='csv', write_mode='overwrite', header='true'):\n",
							"        spark_schema = oea.to_spark_schema(self.schemas[entity_name])\n",
							"        df = spark.read.format(format).load(f\"{self.stage1np}/{path}/{entity_name}\", header=header, schema=spark_schema)\n",
							"\n",
							"        if self.pseudonymize:\n",
							"            df_pseudo, df_lookup = oea.pseudonymize(df, self.schemas[entity_name])\n",
							"            df_pseudo.write.format('delta').mode(write_mode).save(f\"{self.stage2p}/{entity_name}\")\n",
							"            if len(df_lookup.columns) > 0:\n",
							"                df_lookup.write.format('delta').mode(write_mode).save(f\"{self.stage2np}/{entity_name}_lookup\")\n",
							"        else:\n",
							"            df = oea.fix_column_names(df)   \n",
							"            df.write.format('delta').mode(write_mode).save(f\"{self.stage2np}/{entity_name}\")\n",
							"\n",
							"    def delete_stage1(self):\n",
							"        oea.rm_if_exists(self.stage1np)\n",
							"\n",
							"    def delete_stage2(self):\n",
							"        oea.rm_if_exists(self.stage2np)\n",
							"        oea.rm_if_exists(self.stage2p)\n",
							"\n",
							"    def delete_stage3(self):\n",
							"        oea.rm_if_exists(self.stage3np)\n",
							"        oea.rm_if_exists(self.stage3p)                \n",
							"\n",
							"    def delete_all_stages(self):\n",
							"        self.delete_stage1()\n",
							"        self.delete_stage2()\n",
							"        self.delete_stage3()\n",
							"\n",
							"    def create_stage2_lake_db(self, format='DELTA'):\n",
							"        oea.create_lake_db(self.stage2p, format)\n",
							"        oea.create_lake_db(self.stage2np, format)\n",
							"\n",
							"    def create_stage3_lake_db(self, format='DELTA'):\n",
							"        oea.create_lake_db(self.stage3p, format)\n",
							"        oea.create_lake_db(self.stage3np, format)\n",
							"\n",
							"    def copy_test_data_to_stage1(self):\n",
							"        mssparkutils.fs.cp(self.module_path + '/test_data', self.stage1np, True)   \n",
							"\n",
							"class DataLakeWriter:\n",
							"    def __init__(self, root_destination):\n",
							"        self.root_destination = root_destination\n",
							"\n",
							"    def write(self, path_and_filename, data_str, format='csv'):\n",
							"        mssparkutils.fs.append(f\"{self.root_destination}/{path_and_filename}\", data_str, True) # Set the last parameter as True to create the file if it does not exist\n",
							"\n",
							"oea = OEA()"
						],
						"outputs": [],
						"execution_count": null
					}
				]
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/_data_lake_info')]",
			"type": "Microsoft.Synapse/workspaces/notebooks",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"nbformat": 4,
				"nbformat_minor": 2,
				"bigDataPool": {
					"referenceName": "spark3p1sm",
					"type": "BigDataPoolReference"
				},
				"sessionProperties": {
					"driverMemory": "28g",
					"driverCores": 4,
					"executorMemory": "28g",
					"executorCores": 4,
					"numExecutors": 2,
					"conf": {
						"spark.dynamicAllocation.enabled": "false",
						"spark.dynamicAllocation.minExecutors": "2",
						"spark.dynamicAllocation.maxExecutors": "2",
						"spark.autotune.trackingId": "c023020e-218f-4514-9e82-aa62cb0585f8"
					}
				},
				"metadata": {
					"saveOutput": true,
					"enableDebugMode": false,
					"kernelspec": {
						"name": "synapse_pyspark",
						"display_name": "python"
					},
					"language_info": {
						"name": "python"
					},
					"a365ComputeOptions": {
						"id": "/subscriptions/7b9a4896-4541-483f-bdc7-d8f4ec6be3ee/resourceGroups/rg-oea-CISDAG1/providers/Microsoft.Synapse/workspaces/syn-oea-cisdag1/bigDataPools/spark3p1sm",
						"name": "spark3p1sm",
						"type": "Spark",
						"endpoint": "https://syn-oea-cisdag1.dev.azuresynapse.net/livyApi/versions/2019-11-01-preview/sparkPools/spark3p1sm",
						"auth": {
							"type": "AAD",
							"authResource": "https://dev.azuresynapse.net"
						},
						"sparkVersion": "3.1",
						"nodeCount": 3,
						"cores": 4,
						"memory": 28
					},
					"sessionKeepAliveTimeout": 30
				},
				"cells": [
					{
						"cell_type": "markdown",
						"metadata": {
							"nteract": {
								"transient": {
									"deleting": false
								}
							}
						},
						"source": [
							"<img align=\"right\" height=\"50\" src=\"https://microsoft.github.io/OpenEduAnalytics/assets/images/oea-logo-nobg.png\">\r\n",
							"&nbsp\r\n",
							"&nbsp\r\n",
							"\r\n",
							"---\r\n",
							"\r\n",
							"# OEA Map\r\n",
							"This notebook provides documentation on the structure of the data lake and details on what data is brought in and how it's processed.\r\n",
							"\r\n",
							""
						]
					},
					{
						"cell_type": "markdown",
						"metadata": {
							"nteract": {
								"transient": {
									"deleting": false
								}
							}
						},
						"source": [
							"# M365\r\n",
							"\r\n",
							"M365 data is ingested through the Insights Premium product, and setup via the SDS admin pages.\r\n",
							"\r\n",
							"## Roster data\r\n",
							"This is info about how roster data is received and processed.\r\n",
							"\r\n",
							"## Activity data\r\n",
							"This is info about how roster data is received and processed."
						]
					}
				]
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/generate_data')]",
			"type": "Microsoft.Synapse/workspaces/notebooks",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"nbformat": 4,
				"nbformat_minor": 2,
				"bigDataPool": {
					"referenceName": "spark3p1sm",
					"type": "BigDataPoolReference"
				},
				"sessionProperties": {
					"driverMemory": "28g",
					"driverCores": 4,
					"executorMemory": "28g",
					"executorCores": 4,
					"numExecutors": 2,
					"conf": {
						"spark.dynamicAllocation.enabled": "false",
						"spark.dynamicAllocation.minExecutors": "2",
						"spark.dynamicAllocation.maxExecutors": "2",
						"spark.autotune.trackingId": "01363c4c-56fb-484c-ac26-0fbd6c753d56"
					}
				},
				"metadata": {
					"saveOutput": true,
					"enableDebugMode": false,
					"kernelspec": {
						"name": "synapse_pyspark",
						"display_name": "Synapse PySpark"
					},
					"language_info": {
						"name": "python"
					},
					"a365ComputeOptions": {
						"id": "/subscriptions/7b9a4896-4541-483f-bdc7-d8f4ec6be3ee/resourceGroups/rg-oea-CISDAG1/providers/Microsoft.Synapse/workspaces/syn-oea-cisdag1/bigDataPools/spark3p1sm",
						"name": "spark3p1sm",
						"type": "Spark",
						"endpoint": "https://syn-oea-cisdag1.dev.azuresynapse.net/livyApi/versions/2019-11-01-preview/sparkPools/spark3p1sm",
						"auth": {
							"type": "AAD",
							"authResource": "https://dev.azuresynapse.net"
						},
						"sparkVersion": "3.1",
						"nodeCount": 3,
						"cores": 4,
						"memory": 28
					},
					"sessionKeepAliveTimeout": 30
				},
				"cells": [
					{
						"cell_type": "code",
						"metadata": {
							"jupyter": {
								"source_hidden": false,
								"outputs_hidden": false
							},
							"nteract": {
								"transient": {
									"deleting": false
								}
							},
							"collapsed": true
						},
						"source": [
							"%run OEA_py"
						],
						"outputs": [],
						"execution_count": null
					},
					{
						"cell_type": "code",
						"source": [
							"%run M365DataGenerator_py"
						],
						"outputs": [],
						"execution_count": null
					},
					{
						"cell_type": "code",
						"metadata": {
							"jupyter": {
								"source_hidden": false,
								"outputs_hidden": false
							},
							"nteract": {
								"transient": {
									"deleting": false
								}
							},
							"collapsed": true
						},
						"source": [
							"oea = OEA()\r\n",
							"oea.rm_if_exists(oea.stage1np + '/generated/m365_test')\r\n",
							"oea.rm_if_exists(oea.stage1np + '/generated/contoso_sis_test')\r\n",
							"data_generator = M365DataGenerator(activity_max_per_person=15)\r\n",
							"data_lake_writer = DataLakeWriter(oea.stage1np)\r\n",
							"data_generator.generate_data(num_of_schools=2, writer=data_lake_writer)\r\n",
							""
						],
						"outputs": [],
						"execution_count": null
					},
					{
						"cell_type": "code",
						"metadata": {
							"jupyter": {
								"source_hidden": false,
								"outputs_hidden": false
							},
							"nteract": {
								"transient": {
									"deleting": false
								}
							},
							"collapsed": true
						},
						"source": [
							"pdf = oea.load_sample_from_csv_file('generated/m365/Activity0p2.csv', header=False)\r\n",
							"print(pdf)\r\n",
							""
						],
						"outputs": [],
						"execution_count": null
					}
				]
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/spark3p1sm')]",
			"type": "Microsoft.Synapse/workspaces/bigDataPools",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"autoPause": {
					"enabled": true,
					"delayInMinutes": 15
				},
				"autoScale": {
					"enabled": true,
					"maxNodeCount": 10,
					"minNodeCount": 3
				},
				"nodeCount": 3,
				"nodeSize": "Small",
				"nodeSizeFamily": "MemoryOptimized",
				"sparkVersion": "3.1",
				"libraryRequirements": {
					"content": "opencensus-ext-azure >= 1.0.8\r\nFaker >= 8.0",
					"filename": "/usr/csuser/clouddrive/OpenEduAnalytics/framework/requirements.txt",
					"time": "2021-09-08T13:31:48.5575063Z"
				},
				"isComputeIsolationEnabled": false,
				"sessionLevelPackagesEnabled": false,
				"annotations": []
			},
			"dependsOn": [],
			"location": "centralindia"
		},
		{
			"name": "[concat(parameters('workspaceName'), '/DS_JSON_File1')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "LS_ADLS_OEA",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"stage": {
						"type": "string",
						"defaultValue": "1"
					},
					"path": {
						"type": "string"
					},
					"fileName": {
						"type": "string",
						"defaultValue": "data.json"
					}
				},
				"annotations": [],
				"type": "Json",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": {
							"value": "@dataset().fileName",
							"type": "Expression"
						},
						"folderPath": {
							"value": "@dataset().path",
							"type": "Expression"
						},
						"fileSystem": {
							"value": "stage@{dataset().stage}",
							"type": "Expression"
						}
					}
				},
				"schema": {}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/DS_REST1')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "LS_REST",
					"type": "LinkedServiceReference",
					"parameters": {
						"ClientId": {
							"value": "@dataset().ClientId",
							"type": "Expression"
						},
						"SecretName": {
							"value": "@dataset().SecretName",
							"type": "Expression"
						},
						"BaseURL": {
							"value": "@dataset().BaseURL",
							"type": "Expression"
						}
					}
				},
				"parameters": {
					"RelativeURL": {
						"type": "string"
					},
					"ClientId": {
						"type": "string"
					},
					"SecretName": {
						"type": "string"
					},
					"BaseURL": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "RestResource",
				"typeProperties": {
					"relativeUrl": {
						"value": "@dataset().RelativeURL",
						"type": "Expression"
					}
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_REST')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/DS_JSON1')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "LS_ADLS_OEA",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"stage": {
						"type": "string",
						"defaultValue": "1"
					},
					"path": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "Json",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"folderPath": {
							"value": "@dataset().path",
							"type": "Expression"
						},
						"fileSystem": {
							"value": "stage@{dataset().stage}",
							"type": "Expression"
						}
					}
				},
				"schema": {}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/edfi_upsert')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Ingest"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJson"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDelta"
						}
					],
					"transformations": [
						{
							"name": "AlterRow"
						},
						{
							"name": "DerivedColumn"
						},
						{
							"name": "SelectColumns"
						}
					],
					"scriptLines": [
						"parameters{",
						"     districtId as string ('255901'),",
						"     schoolYear as string ('2017'),",
						"     entity as string ('schools'),",
						"     directory as string ('EdFi'),",
						"     apiversion as string ('5.3')",
						"}",
						"source(useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     limit: 10000,",
						"     ignoreNoFilesFound: true,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Incremental/Upserts\"),",
						"     documentForm: 'documentPerLine',",
						"     preferredIntegralType: 'integer',",
						"     preferredFractionalType: 'float') ~> SourceJson",
						"SelectColumns alterRow(upsertIf(true())) ~> AlterRow",
						"SourceJson derive(SchoolYear = $schoolYear,",
						"          DistrictId = $districtId,",
						"          LastModifiedDate = currentTimestamp()) ~> DerivedColumn",
						"DerivedColumn select(mapColumn(",
						"          each(match(name!='rundate'))",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"AlterRow sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'stage2',",
						"     folderPath: (\"Ingested/{$directory}/v{$apiversion}/{$entity}\"),",
						"     mergeSchema: (true()),",
						"     autoCompact: false,",
						"     optimizedWrite: false,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     partitionBy('key',",
						"          0,",
						"          DistrictId,",
						"          SchoolYear",
						"     )) ~> SinkDelta"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/edfi_delete')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi/Ingest"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SourceJson"
						}
					],
					"sinks": [
						{
							"linkedService": {
								"referenceName": "LS_ADLS_OEA",
								"type": "LinkedServiceReference"
							},
							"name": "SinkDelta"
						}
					],
					"transformations": [
						{
							"name": "AlterRow"
						},
						{
							"name": "DerivedColumn"
						},
						{
							"name": "SelectColumns"
						}
					],
					"scriptLines": [
						"parameters{",
						"     districtId as string ('255901'),",
						"     schoolYear as string ('2017'),",
						"     entity as string ('schools'),",
						"     directory as string ('EdFi'),",
						"     apiversion as string ('5.3')",
						"}",
						"source(useSchema: false,",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     limit: 10000,",
						"     ignoreNoFilesFound: true,",
						"     enableCdc: true,",
						"     mode: 'read',",
						"     skipInitialLoad: false,",
						"     format: 'json',",
						"     fileSystem: 'stage1',",
						"     folderPath: (\"Transactional/{$directory}/v5.3/DistrictId={$districtId}/SchoolYear={$schoolYear}/{$entity}/Incremental/Deletes\"),",
						"     documentForm: 'documentPerLine') ~> SourceJson",
						"SelectColumns alterRow(deleteIf(true())) ~> AlterRow",
						"SourceJson derive(SchoolYear = $schoolYear,",
						"          DistrictId = $districtId) ~> DerivedColumn",
						"DerivedColumn select(mapColumn(",
						"          each(match(name!='rundate'))",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectColumns",
						"AlterRow sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'delta',",
						"     fileSystem: 'workspace',",
						"     folderPath: (\"Ingested/{$directory}/v{$apiversion}/{$entity}\"),",
						"     mergeSchema: (true()),",
						"     autoCompact: false,",
						"     optimizedWrite: false,",
						"     vacuum: 0,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:true,",
						"     upsertable:false,",
						"     keys:['id'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     partitionBy('key',",
						"          0,",
						"          DistrictId,",
						"          SchoolYear",
						"     )) ~> SinkDelta"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/LS_ADLS_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Master_Pipeline')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "Get-Runner-Config",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "JsonSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "JsonReadSettings"
								}
							},
							"dataset": {
								"referenceName": "DS_JSON_File1",
								"type": "DatasetReference",
								"parameters": {
									"stage": "1",
									"path": {
										"value": "Transactional/@{pipeline().parameters.Directory}",
										"type": "Expression"
									},
									"fileName": "Runner_Config.json"
								}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "Land Data to Stage1",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Get-Runner-Config",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Get-Runner-Config').output.value",
								"type": "Expression"
							},
							"isSequential": false,
							"batchCount": 5,
							"activities": [
								{
									"name": "Land_data_from_EdFi_Instance",
									"type": "ExecutePipeline",
									"dependsOn": [],
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "Land_All_Entities_to_Stage1",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"ClientID": {
												"value": "@item().ClientId",
												"type": "Expression"
											},
											"BaseURL": {
												"value": "@item().BaseURL",
												"type": "Expression"
											},
											"Directory": {
												"value": "@pipeline().parameters.Directory",
												"type": "Expression"
											},
											"SecretName": {
												"value": "@item().ClientSecretName",
												"type": "Expression"
											},
											"SchoolYear": {
												"value": "@item().SchoolYear",
												"type": "Expression"
											},
											"InstanceId": {
												"value": "@item().InstanceId",
												"type": "Expression"
											},
											"ApiVersion": {
												"value": "@pipeline().parameters.ApiVersion",
												"type": "Expression"
											},
											"isInitialLoad": {
												"value": "@pipeline().parameters.isInitialLoad",
												"type": "Expression"
											},
											"DistrictId": {
												"value": "@item().DistrictId",
												"type": "Expression"
											}
										}
									}
								}
							]
						}
					},
					{
						"name": "Ingest to Stage2",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Land Data to Stage1",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Get-Runner-Config').output.value",
								"type": "Expression"
							},
							"isSequential": false,
							"activities": [
								{
									"name": "Ingest data from EdFi instance",
									"type": "ExecutePipeline",
									"dependsOn": [],
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "Ingest_To_Stage2",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"districtId": {
												"value": "@item().DistrictId",
												"type": "Expression"
											},
											"schoolYear": {
												"value": "@item().SchoolYear",
												"type": "Expression"
											},
											"apiversion": {
												"value": "@pipeline().parameters.ApiVersion",
												"type": "Expression"
											},
											"directory": {
												"value": "@pipeline().parameters.Directory",
												"type": "Expression"
											}
										}
									}
								}
							]
						}
					},
					{
						"name": "Refine Data in Stage2",
						"type": "SynapseNotebook",
						"dependsOn": [
							{
								"activity": "Ingest to Stage2",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"notebook": {
								"referenceName": "Refine_EdFi",
								"type": "NotebookReference"
							},
							"parameters": {
								"api_version": {
									"value": {
										"value": "@pipeline().parameters.ApiVersion",
										"type": "Expression"
									},
									"type": "string"
								},
								"directory": {
									"value": {
										"value": "@pipeline().parameters.Directory",
										"type": "Expression"
									},
									"type": "string"
								}
							},
							"snapshot": true,
							"executorSize": null,
							"conf": {
								"spark.dynamicAllocation.enabled": null,
								"spark.dynamicAllocation.minExecutors": null,
								"spark.dynamicAllocation.maxExecutors": null
							},
							"driverSize": null,
							"numExecutors": null
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"Directory": {
						"type": "string",
						"defaultValue": "EdFi"
					},
					"isInitialLoad": {
						"type": "bool",
						"defaultValue": true
					},
					"ApiVersion": {
						"type": "string",
						"defaultValue": "5.3"
					}
				},
				"variables": {
					"AccessToken": {
						"type": "String"
					},
					"MinChangeVersion": {
						"type": "String"
					},
					"MaxChangeVersion": {
						"type": "String"
					},
					"FolderName": {
						"type": "String"
					},
					"DescriptorList": {
						"type": "Array"
					},
					"PipelineName": {
						"type": "String"
					}
				},
				"folder": {
					"name": "EdFi/Single District Per Instance"
				},
				"annotations": []
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/datasets/DS_JSON_File1')]",
				"[concat(variables('workspaceId'), '/notebooks/Refine_EdFi')]",
				"[concat(variables('workspaceId'), '/pipelines/Land_All_Entities_to_Stage1')]",
				"[concat(variables('workspaceId'), '/pipelines/Ingest_To_Stage2')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Land_All_Entities_to_Stage1')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "Get-AccessToken",
						"type": "WebActivity",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"url": {
								"value": "@{pipeline().parameters.BaseURL}/edfi/v@{pipeline().parameters.ApiVersion}/saas/core/@{pipeline().parameters.InstanceId}/oauth/token",
								"type": "Expression"
							},
							"method": "POST",
							"headers": {},
							"body": {
								"grant_type": "client_credentials"
							},
							"authentication": {
								"type": "Basic",
								"username": {
									"value": "@pipeline().parameters.ClientID",
									"type": "Expression"
								},
								"password": {
									"type": "AzureKeyVaultSecret",
									"store": {
										"referenceName": "LS_KeyVault_OEA",
										"type": "LinkedServiceReference"
									},
									"secretName": {
										"value": "@pipeline().parameters.SecretName",
										"type": "Expression"
									}
								}
							}
						}
					},
					{
						"name": "Set-AccessToken",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Get-AccessToken",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "AccessToken",
							"value": {
								"value": "Bearer @{activity('Get-AccessToken').output.access_token}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Get Current Change Version",
						"type": "WebActivity",
						"dependsOn": [
							{
								"activity": "Set-FolderName",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"url": {
								"value": "@{pipeline().parameters.BaseURL}/edfi/v@{pipeline().parameters.ApiVersion}/saas/core/changequeries/v1/@{pipeline().parameters.InstanceId}/@{pipeline().parameters.SchoolYear}/availableChangeVersions",
								"type": "Expression"
							},
							"method": "GET",
							"headers": {
								"Authorization": {
									"value": "@variables('AccessToken')",
									"type": "Expression"
								},
								"Accept": "application/json"
							}
						}
					},
					{
						"name": "Set Max Change Version",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Get Current Change Version",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "MaxChangeVersion",
							"value": {
								"value": "@string(activity('Get Current Change Version').output.NewestChangeVersion)",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Iterate over entities",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Set Max Change Version",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "Set-MinChangeVersion",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "Get All endpoints",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@json(activity('Get All endpoints').output.Response)",
								"type": "Expression"
							},
							"isSequential": false,
							"batchCount": 40,
							"activities": [
								{
									"name": "Cope Entity Data to stage1",
									"type": "ExecutePipeline",
									"dependsOn": [],
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "Copy Data from REST API to ADLS1",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"Limit": 500,
											"BaseURL": {
												"value": "@pipeline().parameters.BaseURL",
												"type": "Expression"
											},
											"TotalCountURL": {
												"value": "@{pipeline().parameters.BaseURL}/edfi/v5.3/saas/core/data/v3/@{pipeline().parameters.InstanceId}/@{pipeline().parameters.SchoolYear}/@{item().resource}?MinChangeVersion=@{variables('MinChangeVersion')}&MaxChangeVersion=@{variables('MaxChangeVersion')}&totalCount=true\n",
												"type": "Expression"
											},
											"RelativeURL": {
												"value": "/edfi/v5.3/saas/core/data/v3/@{pipeline().parameters.InstanceId}/@{pipeline().parameters.SchoolYear}@{item().resource}?MinChangeVersion=@{variables('MinChangeVersion')}&MaxChangeVersion=@{variables('MaxChangeVersion')}",
												"type": "Expression"
											},
											"ClientId": {
												"value": "@pipeline().parameters.ClientID",
												"type": "Expression"
											},
											"SecretName": {
												"value": "@pipeline().parameters.SecretName",
												"type": "Expression"
											},
											"SinkPath": {
												"value": "Transactional/@{pipeline().parameters.Directory}/v@{pipeline().parameters.ApiVersion}/DistrictId=@{pipeline().parameters.DistrictId}/SchoolYear=@{pipeline().parameters.SchoolYear}/@{split(item().resource, '/')[2]}/Incremental/Upserts/@{variables('FolderName')}",
												"type": "Expression"
											},
											"AuthURL": {
												"value": "@{pipeline().parameters.BaseURL}/edfi/v@{pipeline().parameters.ApiVersion}/saas/core/@{pipeline().parameters.InstanceId}/oauth/token",
												"type": "Expression"
											}
										}
									}
								},
								{
									"name": "Copy Deletes to stage 1",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "RestSource",
											"httpRequestTimeout": "00:01:40",
											"requestInterval": "00.00:00:00.010",
											"requestMethod": "GET",
											"additionalHeaders": {
												"Authorization": {
													"value": "@variables('AccessToken')",
													"type": "Expression"
												}
											},
											"paginationRules": {
												"QueryParameters.start": "RANGE:0:1000:500"
											}
										},
										"sink": {
											"type": "JsonSink",
											"storeSettings": {
												"type": "AzureBlobFSWriteSettings"
											},
											"formatSettings": {
												"type": "JsonWriteSettings",
												"filePattern": "setOfObjects"
											}
										},
										"enableStaging": false
									},
									"inputs": [
										{
											"referenceName": "DS_REST1",
											"type": "DatasetReference",
											"parameters": {
												"RelativeURL": {
													"value": "/edfi/v5.3/saas/core/data/v3/@{pipeline().parameters.InstanceId}/@{pipeline().parameters.SchoolYear}/@{item().resource}/deletes?MinChangeVersion=@{variables('MinChangeVersion')}&MaxChangeVersion=@{variables('MaxChangeVersion')}&limit=500&offset=start",
													"type": "Expression"
												},
												"ClientId": {
													"value": "@pipeline().parameters.ClientID",
													"type": "Expression"
												},
												"SecretName": {
													"value": "@pipeline().parameters.SecretName",
													"type": "Expression"
												},
												"BaseURL": {
													"value": "@pipeline().parameters.BaseURL",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DS_JSON1",
											"type": "DatasetReference",
											"parameters": {
												"stage": "1",
												"path": {
													"value": "Transactional/@{pipeline().parameters.Directory}/v@{pipeline().parameters.ApiVersion}/DistrictId=@{pipeline().parameters.DistrictId}/SchoolYear=@{pipeline().parameters.SchoolYear}/@{split(item().resource, '/')[2]}/Incremental/Deletes/@{variables('FolderName')}",
													"type": "Expression"
												}
											}
										}
									]
								}
							]
						}
					},
					{
						"name": "Update ChangeVersion",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Iterate over entities",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:01:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET",
								"additionalHeaders": {
									"Authorization": {
										"value": "Bearer @{activity('Get-AccessToken').output.access_token}",
										"type": "Expression"
									}
								}
							},
							"sink": {
								"type": "JsonSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "JsonWriteSettings"
								}
							},
							"enableStaging": false
						},
						"inputs": [
							{
								"referenceName": "DS_REST1",
								"type": "DatasetReference",
								"parameters": {
									"RelativeURL": {
										"value": "edfi/v@{pipeline().parameters.ApiVersion}/saas/core/changequeries/v1/@{pipeline().parameters.InstanceId}/@{pipeline().parameters.SchoolYear}/availableChangeVersions",
										"type": "Expression"
									},
									"ClientId": {
										"value": "@pipeline().parameters.ClientID",
										"type": "Expression"
									},
									"SecretName": {
										"value": "@pipeline().parameters.SecretName",
										"type": "Expression"
									},
									"BaseURL": {
										"value": "@pipeline().parameters.BaseURL",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_JSON_File1",
								"type": "DatasetReference",
								"parameters": {
									"stage": "1",
									"path": {
										"value": "Landing/Transactional/@{pipeline().parameters.Directory}/v@{pipeline().parameters.ApiVersion}/DistrictId=@{pipeline().parameters.DistrictId}/SchoolYear=@{pipeline().parameters.SchoolYear}",
										"type": "Expression"
									},
									"fileName": "ChangeVersion.json"
								}
							}
						]
					},
					{
						"name": "Set-FolderName",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Set-AccessToken",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "FolderName",
							"value": {
								"value": "rundate=@{formatDateTime(utcNow(), 'yyyy-MM-dd')}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Get All endpoints",
						"type": "WebActivity",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"url": {
								"value": "@{pipeline().parameters.BaseURL}/edfi/v@{pipeline().parameters.ApiVersion}/saas/core/metadata/data/v3/@{pipeline().parameters.InstanceId}/2022/dependencies",
								"type": "Expression"
							},
							"method": "GET",
							"headers": {}
						}
					},
					{
						"name": "Set-MinChangeVersion",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "Set-FolderName",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@pipeline().parameters.isInitialLoad",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "Get Previous Change Versions",
									"type": "Lookup",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "JsonSource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "JsonReadSettings"
											}
										},
										"dataset": {
											"referenceName": "DS_JSON_File1",
											"type": "DatasetReference",
											"parameters": {
												"stage": "1",
												"path": {
													"value": "Landing/Transactional/@{pipeline().parameters.Directory}/v@{pipeline().parameters.ApiVersion}/DistrictId=@{pipeline().parameters.DistrictId}/SchoolYear=@{pipeline().parameters.SchoolYear}",
													"type": "Expression"
												},
												"fileName": "ChangeVersion.json"
											}
										},
										"firstRowOnly": true
									}
								},
								{
									"name": "Set Min Change Version",
									"type": "SetVariable",
									"dependsOn": [
										{
											"activity": "Get Previous Change Versions",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"variableName": "MinChangeVersion",
										"value": {
											"value": "@string(activity('Get Previous Change Versions').output.firstRow.NewestChangeVersion)",
											"type": "Expression"
										}
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "Set Initial Min Change Version",
									"type": "SetVariable",
									"dependsOn": [],
									"userProperties": [],
									"typeProperties": {
										"variableName": "MinChangeVersion",
										"value": "0"
									}
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"ClientID": {
						"type": "string",
						"defaultValue": "vNaqQSu6q84STOXT"
					},
					"BaseURL": {
						"type": "string",
						"defaultValue": "https://api.edgraph.dev"
					},
					"Directory": {
						"type": "string",
						"defaultValue": "EdFi"
					},
					"SecretName": {
						"type": "string",
						"defaultValue": "EdFi-Client-Secret-2017"
					},
					"SchoolYear": {
						"type": "string",
						"defaultValue": "2017"
					},
					"InstanceId": {
						"type": "string",
						"defaultValue": "a01eaead-bc82-4e18-8b63-b1aa4af3bba1"
					},
					"ApiVersion": {
						"type": "string",
						"defaultValue": "5.3"
					},
					"isInitialLoad": {
						"type": "bool",
						"defaultValue": true
					},
					"DistrictId": {
						"type": "string"
					}
				},
				"variables": {
					"AccessToken": {
						"type": "String"
					},
					"MinChangeVersion": {
						"type": "String"
					},
					"MaxChangeVersion": {
						"type": "String"
					},
					"FolderName": {
						"type": "String"
					},
					"DescriptorList": {
						"type": "Array"
					},
					"PipelineName": {
						"type": "String"
					}
				},
				"folder": {
					"name": "EdFi/Single District Per Instance"
				},
				"annotations": []
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/datasets/DS_REST1')]",
				"[concat(variables('workspaceId'), '/datasets/DS_JSON_File1')]",
				"[concat(variables('workspaceId'), '/linkedServices/LS_KeyVault_OEA')]",
				"[concat(variables('workspaceId'), '/pipelines/Copy Data from REST API to ADLS1')]",
				"[concat(variables('workspaceId'), '/datasets/DS_JSON1')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Ingest_To_Stage2')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "Get-CheckPoints",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "JsonSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "JsonReadSettings"
								}
							},
							"dataset": {
								"referenceName": "DS_JSON_File1",
								"type": "DatasetReference",
								"parameters": {
									"stage": "2",
									"path": {
										"value": "Ingested/@{pipeline().parameters.directory}/v@{pipeline().parameters.apiversion}",
										"type": "Expression"
									},
									"fileName": "checkpoints.json"
								}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "Iterate Checkpoints",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Get-CheckPoints",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Get-CheckPoints').output.value",
								"type": "Expression"
							},
							"isSequential": false,
							"batchCount": 3,
							"activities": [
								{
									"name": "Process Upserts",
									"type": "ExecuteDataFlow",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"dataflow": {
											"referenceName": "edfi_upsert",
											"type": "DataFlowReference",
											"parameters": {
												"districtId": {
													"value": "'@{pipeline().parameters.districtId}'",
													"type": "Expression"
												},
												"schoolYear": {
													"value": "'@{pipeline().parameters.schoolYear}'",
													"type": "Expression"
												},
												"entity": {
													"value": "'@{item().entity}'",
													"type": "Expression"
												},
												"directory": {
													"value": "'@{pipeline().parameters.directory}'",
													"type": "Expression"
												},
												"apiversion": {
													"value": "'@{pipeline().parameters.apiversion}'",
													"type": "Expression"
												}
											},
											"datasetParameters": {
												"SourceJson": {},
												"SinkDelta": {}
											}
										},
										"staging": {},
										"compute": {
											"coreCount": 8,
											"computeType": "General"
										},
										"traceLevel": "Fine",
										"continuationSettings": {
											"customizedCheckpointKey": {
												"value": "@item().checkpoint",
												"type": "Expression"
											}
										}
									}
								},
								{
									"name": "Process Deletes",
									"type": "ExecuteDataFlow",
									"dependsOn": [
										{
											"activity": "Process Upserts",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"dataflow": {
											"referenceName": "edfi_delete",
											"type": "DataFlowReference",
											"parameters": {
												"districtId": {
													"value": "'@{pipeline().parameters.districtId}'",
													"type": "Expression"
												},
												"schoolYear": {
													"value": "'@{pipeline().parameters.schoolYear}'",
													"type": "Expression"
												},
												"entity": {
													"value": "'@{item().entity}'",
													"type": "Expression"
												},
												"directory": {
													"value": "'@{pipeline().parameters.directory}'",
													"type": "Expression"
												},
												"apiversion": {
													"value": "'@{pipeline().parameters.apiversion}'",
													"type": "Expression"
												}
											},
											"datasetParameters": {
												"SourceJson": {},
												"SinkDelta": {}
											}
										},
										"staging": {},
										"compute": {
											"coreCount": 8,
											"computeType": "General"
										},
										"traceLevel": "Fine",
										"continuationSettings": {
											"customizedCheckpointKey": {
												"value": "@item().checkpoint",
												"type": "Expression"
											}
										}
									}
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"districtId": {
						"type": "string",
						"defaultValue": "255901"
					},
					"schoolYear": {
						"type": "string",
						"defaultValue": "2017"
					},
					"apiversion": {
						"type": "string",
						"defaultValue": "5.3"
					},
					"directory": {
						"type": "string",
						"defaultValue": "EdFi"
					}
				},
				"folder": {
					"name": "EdFi/Single District Per Instance"
				},
				"annotations": []
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/datasets/DS_JSON_File1')]",
				"[concat(variables('workspaceId'), '/dataflows/edfi_upsert')]",
				"[concat(variables('workspaceId'), '/dataflows/edfi_delete')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Copy Data from REST API to ADLS1')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "Get Total count of Records",
						"type": "WebActivity",
						"dependsOn": [
							{
								"activity": "Set-AccessToken",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"url": {
								"value": "@pipeline().parameters.TotalCountURL",
								"type": "Expression"
							},
							"method": "GET",
							"headers": {
								"Authorization": {
									"value": "@variables('AccessToken')",
									"type": "Expression"
								},
								"Accept": "application/json"
							}
						}
					},
					{
						"name": "Store Total Count",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Get Total count of Records",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "TotalCount",
							"value": {
								"value": "@activity('Get Total count of Records').output.ADFWebActivityResponseHeaders['Total-Count']",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Copy Page to ADLS",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Store Total Count",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:01:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET",
								"additionalHeaders": {
									"Authorization": {
										"value": "@variables('AccessToken')",
										"type": "Expression"
									}
								},
								"paginationRules": {
									"QueryParameters.start": {
										"value": "Range:0:@{variables('TotalCount')}:500",
										"type": "Expression"
									}
								}
							},
							"sink": {
								"type": "JsonSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "JsonWriteSettings",
									"filePattern": "setOfObjects"
								}
							},
							"enableStaging": false
						},
						"inputs": [
							{
								"referenceName": "DS_REST1",
								"type": "DatasetReference",
								"parameters": {
									"RelativeURL": {
										"value": "@{pipeline().parameters.RelativeURL}&limit=@{pipeline().parameters.Limit}&offset=start",
										"type": "Expression"
									},
									"ClientId": {
										"value": "@pipeline().parameters.ClientId",
										"type": "Expression"
									},
									"SecretName": {
										"value": "@pipeline().parameters.SecretName",
										"type": "Expression"
									},
									"BaseURL": {
										"value": "@pipeline().parameters.BaseURL",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_JSON1",
								"type": "DatasetReference",
								"parameters": {
									"stage": "1",
									"path": {
										"value": "@pipeline().parameters.SinkPath",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Get-AccessToken",
						"type": "WebActivity",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"url": {
								"value": "@pipeline().parameters.AuthURL",
								"type": "Expression"
							},
							"method": "POST",
							"headers": {},
							"body": {
								"grant_type": "client_credentials"
							},
							"authentication": {
								"type": "Basic",
								"username": {
									"value": "@pipeline().parameters.ClientID",
									"type": "Expression"
								},
								"password": {
									"type": "AzureKeyVaultSecret",
									"store": {
										"referenceName": "LS_KeyVault_OEA",
										"type": "LinkedServiceReference"
									},
									"secretName": {
										"value": "@pipeline().parameters.SecretName",
										"type": "Expression"
									}
								}
							}
						}
					},
					{
						"name": "Set-AccessToken",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Get-AccessToken",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "AccessToken",
							"value": {
								"value": "Bearer @{activity('Get-AccessToken').output.access_token}",
								"type": "Expression"
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"Limit": {
						"type": "int",
						"defaultValue": 500
					},
					"BaseURL": {
						"type": "string",
						"defaultValue": "https://api.edgraph.dev"
					},
					"TotalCountURL": {
						"type": "String"
					},
					"RelativeURL": {
						"type": "String"
					},
					"ClientId": {
						"type": "String"
					},
					"SecretName": {
						"type": "String"
					},
					"SinkPath": {
						"type": "String"
					},
					"AuthURL": {
						"type": "String"
					}
				},
				"variables": {
					"TotalCount": {
						"type": "String"
					},
					"PageArray": {
						"type": "Array"
					},
					"test": {
						"type": "String"
					},
					"AccessToken": {
						"type": "String"
					}
				},
				"folder": {
					"name": "EdFi/Single District Per Instance/Common"
				},
				"annotations": []
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/datasets/DS_REST1')]",
				"[concat(variables('workspaceId'), '/datasets/DS_JSON1')]",
				"[concat(variables('workspaceId'), '/linkedServices/LS_KeyVault_OEA')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Refine_EdFi')]",
			"type": "Microsoft.Synapse/workspaces/notebooks",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "EdFi"
				},
				"nbformat": 4,
				"nbformat_minor": 2,
				"bigDataPool": {
					"referenceName": "spark3p1sm",
					"type": "BigDataPoolReference"
				},
				"sessionProperties": {
					"driverMemory": "28g",
					"driverCores": 4,
					"executorMemory": "28g",
					"executorCores": 4,
					"numExecutors": 2,
					"conf": {
						"spark.dynamicAllocation.enabled": "false",
						"spark.dynamicAllocation.minExecutors": "2",
						"spark.dynamicAllocation.maxExecutors": "2",
						"spark.autotune.trackingId": "daba51a2-1054-4db1-b3a8-5171b630bc85"
					}
				},
				"metadata": {
					"saveOutput": true,
					"enableDebugMode": false,
					"kernelspec": {
						"name": "synapse_pyspark",
						"display_name": "Synapse PySpark"
					},
					"language_info": {
						"name": "python"
					},
					"a365ComputeOptions": {
						"id": "/subscriptions/7b9a4896-4541-483f-bdc7-d8f4ec6be3ee/resourceGroups/rg-oea-CISDAG1/providers/Microsoft.Synapse/workspaces/syn-oea-cisdag1/bigDataPools/spark3p1sm",
						"name": "spark3p1sm",
						"type": "Spark",
						"endpoint": "https://syn-oea-cisdag1.dev.azuresynapse.net/livyApi/versions/2019-11-01-preview/sparkPools/spark3p1sm",
						"auth": {
							"type": "AAD",
							"authResource": "https://dev.azuresynapse.net"
						},
						"sparkVersion": "3.1",
						"nodeCount": 3,
						"cores": 4,
						"memory": 28,
						"automaticScaleJobs": false
					},
					"sessionKeepAliveTimeout": 30
				},
				"cells": [
					{
						"cell_type": "code",
						"metadata": {},
						"source": [
							"%run /OEAp7_py"
						],
						"outputs": [],
						"execution_count": 4
					},
					{
						"cell_type": "markdown",
						"metadata": {
							"nteract": {
								"transient": {
									"deleting": false
								}
							}
						},
						"source": [
							""
						]
					},
					{
						"cell_type": "code",
						"metadata": {
							"jupyter": {
								"source_hidden": false,
								"outputs_hidden": false
							},
							"nteract": {
								"transient": {
									"deleting": false
								}
							}
						},
						"source": [
							"# Pass the below parameters from pipeline. \r\n",
							"# directory = 'EdFi'\r\n",
							"# api_version = '5.3'\r\n",
							"\r\n",
							"oea = OEA(storage_account='stoeacisdedfi1')\r\n",
							"schema_generator = OpenAPISchemaGenerator('https://raw.githubusercontent.com/microsoft/OpenEduAnalytics/modules/module_catalog/Ed-Fi/docs//edfi_swagger.json')\r\n",
							"\r\n",
							"schemas = schema_generator.create_spark_schemas()\r\n",
							"metadatas = schema_generator.create_metadata()\r\n",
							"\r\n",
							"stage2_ingested = oea.path('stage2', f'Ingested/{directory}/v{api_version}')\r\n",
							"stage2_refined = oea.path('stage2', f'Refined/{directory}/v{api_version}')"
						],
						"outputs": [],
						"execution_count": 6
					},
					{
						"cell_type": "code",
						"metadata": {
							"jupyter": {
								"source_hidden": false,
								"outputs_hidden": false
							},
							"nteract": {
								"transient": {
									"deleting": false
								}
							}
						},
						"source": [
							"def get_descriptor_schema(descriptor):\r\n",
							"    fields = []\r\n",
							"    fields.append(StructField('_etag',LongType(), True))\r\n",
							"    fields.append(StructField(f\"{descriptor[:-1]}Id\", IntegerType(), True))\r\n",
							"    fields.append(StructField('codeValue',StringType(), True))\r\n",
							"    fields.append(StructField('description',StringType(), True))\r\n",
							"    fields.append(StructField('id',StringType(), True))\r\n",
							"    fields.append(StructField('namespace',StringType(), True))\r\n",
							"    fields.append(StructField('shortDescription',StringType(), True))\r\n",
							"    return StructType(fields)\r\n",
							"\r\n",
							"def get_descriptor_metadata(descriptor):\r\n",
							"    return [['_etag', 'long', 'no-op'],\r\n",
							"            [f\"{descriptor[:-1]}Id\", 'integer', 'hash'],\r\n",
							"            ['codeValue','string', 'no-op'],\r\n",
							"            ['description','string', 'no-op'],\r\n",
							"            ['id','string', 'no-op'],\r\n",
							"            ['namespace','string', 'no-op'],\r\n",
							"            ['shortDescription','string', 'no-op']]"
						],
						"outputs": [],
						"execution_count": 7
					},
					{
						"cell_type": "code",
						"metadata": {
							"jupyter": {
								"source_hidden": false,
								"outputs_hidden": false
							},
							"nteract": {
								"transient": {
									"deleting": false
								}
							}
						},
						"source": [
							"for table_name in [x.name for x in mssparkutils.fs.ls(stage2_ingested) if x.isDir]:\r\n",
							"# for table_name in [\"schools\"]:\r\n",
							"    # 1. Read Delta table from Ingested Folder.\r\n",
							"    df = spark.read.format('delta').load(f\"{stage2_ingested}/{table_name}\")\r\n",
							"    \r\n",
							"    # 2. Modify the schema of the dataframe according to the target schema.\r\n",
							"    if(re.search('Descriptors$', table_name) is None):\r\n",
							"        target_schema = schemas[table_name]\r\n",
							"        oea_metadata = metadatas[table_name]\r\n",
							"    else:\r\n",
							"        target_schema = get_descriptor_schema(table_name)\r\n",
							"        oea_metadata = get_descriptor_metadata(table_name)\r\n",
							"    target_schema = target_schema.add(StructField('DistrictId', StringType()))\\\r\n",
							"                                        .add(StructField('SchoolYear', StringType()))\\\r\n",
							"                                        .add(StructField('LastModifiedDate', TimestampType()))\r\n",
							"    oea_metadata += [['DistrictId', 'string', 'partition-by'],\r\n",
							"                     ['SchoolYear', 'string', 'partition-by'],\r\n",
							"                     ['LastModifiedDate', 'timestamp', 'no-op']]\r\n",
							"    for col_name in target_schema.fieldNames():\r\n",
							"        target_col = target_schema[col_name]\r\n",
							"        if col_name in df.columns and target_col.needConversion() is False:\r\n",
							"            df = df.withColumn(col_name, f.col(col_name).cast(target_col.dataType))\r\n",
							"        elif col_name not in df.columns:\r\n",
							"            df = df.withColumn(col_name, f.lit(None).cast(target_col.dataType))\r\n",
							"        if 'x-Ed-Fi-explode' in target_col.metadata and target_col.metadata['x-Ed-Fi-explode']:\r\n",
							"            cols = df.columns + [\"exploded.*\"]\r\n",
							"            df = df.withColumn(f\"{col_name}_json\", f.to_json(f.col(col_name)))\\\r\n",
							"                    .withColumn(col_name, f.from_json(f.col(f\"{col_name}_json\"), target_col.dataType))\\\r\n",
							"                    .drop(f\"{col_name}_json\")\r\n",
							"            df = df.withColumn(\"exploded\", f.explode(col_name)).select(cols).drop(col_name)\r\n",
							"        elif 'x-Ed-Fi-fields-to-pluck' in target_col.metadata and target_col.metadata['x-Ed-Fi-fields-to-pluck'] != [\"*\"]:\r\n",
							"            df = df.withColumn(f\"{col_name}_json\", f.to_json(f.col(col_name)))\\\r\n",
							"                    .withColumn(col_name, f.from_json(f.col(f\"{col_name}_json\"), target_col.dataType))\\\r\n",
							"                    .drop(f\"{col_name}_json\")\r\n",
							"            for sub_col in target_col.metadata['x-Ed-Fi-fields-to-pluck']:\r\n",
							"                df = df.withColumn(sub_col, f.col(f\"{col_name}.{sub_col}\"))\r\n",
							"            df = df.drop(col_name)\r\n",
							"    \r\n",
							"    # 3. Pseudonymize the data using metadata.\r\n",
							"    df_pseudo, df_lookup = oea.pseudonymize(df, oea_metadata)\r\n",
							"\r\n",
							"    # 4. Write to Refined folder.\r\n",
							"    if(len(df_pseudo.columns) > 2):\r\n",
							"        df_pseudo.write.format('delta').mode('overwrite').option('overwriteSchema', 'true').partitionBy('DistrictId', 'SchoolYear').save(f\"{stage2_refined}/Abhinav/General/{table_name}\")\r\n",
							"    if(len(df_lookup.columns) > 2):\r\n",
							"        df_lookup.write.format('delta').mode('overwrite').option('overwriteSchema', 'true').partitionBy('DistrictId', 'SchoolYear').save(f\"{stage2_refined}/Abhinav/Sensitive/{table_name}\")\r\n",
							""
						],
						"outputs": [],
						"execution_count": 6
					}
				]
			},
			"dependsOn": []
		}
	]
}